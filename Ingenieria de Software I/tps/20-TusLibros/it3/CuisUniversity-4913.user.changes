

----QUIT----(13 October 2021 15:20:10) CuisUniversity-4913.image priorSource: 14638157!

----STARTUP---- (13 October 2021 15:20:10) as /Users/hernan/Documents/Cuis/5.0-64Bits/Cuis-University-Installer/CuisUniversity-4913.image!


----QUIT----(13 October 2021 15:20:10) CuisUniversity-4913.image priorSource: 18661767!

----STARTUP---- (13 October 2021 15:21:02) as /Users/hernan/Documents/Cuis/5.0-64Bits/Cuis-University-Installer/CuisUniversity-4913.image!


----QUIT----(13 October 2021 15:21:02) CuisUniversity-4913.image priorSource: 18661997!

----QUIT----(13 October 2021 15:26:07) CuisUniversity-4913.image priorSource: 14638157!

----STARTUP---- (13 October 2021 15:26:08) as /Users/hernan/Documents/Cuis/5.0-64Bits/Cuis-University-Installer/CuisUniversity-4913.image!


----QUIT----(13 October 2021 15:26:08) CuisUniversity-4913.image priorSource: 18661767!

----STARTUP---- (28 October 2021 20:56:18) as C:\Users\DESKTOP-MIGUE\Desktop\windows64\CuisUniversity-4913.image!


TestCase subclass: #TusLibrosTests
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosTests category: 'TusLibros' stamp: 'MR 10/28/2021 21:00:33'!
TestCase subclass: #TusLibrosTests
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #RestService category: 'TusLibros' stamp: 'MR 10/28/2021 21:14:08'!
Object subclass: #RestService
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosTests methodsFor: 'nil' stamp: 'MR 10/28/2021 21:14:49'!
test01NewCartStartsEmpty

	| clientId clientPassword cart |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	
	cart _ RestService createCartFor: clientId withPassword: clientPassword.

	self assert: 0 equals: cart size.! !

!testRun: #TusLibrosTests #test01NewCartStartsEmpty stamp: 'MR 10/28/2021 21:14:51'!
ERROR!
!TusLibrosTests methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:15:29' prior: 50914862!
test01NewCartStartsEmpty

	| clientId clientPassword cart restAPI |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	restAPI _ RestService new.
	
	cart _ restAPI createCartFor: clientId withPassword: clientPassword.

	self assert: 0 equals: cart size.! !

!testRun: #TusLibrosTests #test01NewCartStartsEmpty stamp: 'MR 10/28/2021 21:15:33'!
ERROR!
!RestService methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:15:40'!
createCartFor: aString withPassword: aString2 
	self shouldBeImplemented.! !
!RestService methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:16:37' prior: 50914890!
createCartFor: aClientId withPassword: aClientPassword 
	^OrderedCollection new.! !

!testRun: #TusLibrosTests #test01NewCartStartsEmpty stamp: 'MR 10/28/2021 21:16:38'!
PASSED!

!testRun: #TusLibrosTests #test01NewCartStartsEmpty stamp: 'MR 10/28/2021 21:16:38'!
PASSED!
!TusLibrosTests methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:16:51' prior: 50914876!
test01NewCartStartsEmpty

	| clientId clientPassword cart restAPI |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	restAPI _ RestService new.
	
	cart _ restAPI createCartFor: clientId withPassword: clientPassword.

	self assert: 0 equals: cart size.! !

!classRenamed: #TusLibrosTests as: #RestServiceTests stamp: 'MR 10/28/2021 21:17:14'!
Smalltalk renameClassNamed: #TusLibrosTests as: #RestServiceTests!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:19:08'!
test02CartWithABookIsNotEmpty

	| clientId clientPassword cart restAPI |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	restAPI _ RestService new.
	
	cart _ restAPI createCartFor: clientId withPassword: clientPassword.

	self assert: 0 equals: cart size.! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:19:14' prior: 50914908!
test01NewCartStartsEmpty

	| clientId clientPassword cart restAPI |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	restAPI _ RestService new.
	
	cart _ restAPI createCartFor: clientId withPassword: clientPassword.

	self assert: true equals: cart isEmpty.! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:20:25' prior: 50914924!
test02CartWithABookIsNotEmpty

	| clientId clientPassword cart restAPI bookIsbn |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	restAPI _ RestService new.
	
	bookIsbn _ '10'.
	
	cart _ restAPI createCartFor: clientId withPassword: clientPassword.
	restAPI addToCart: cart bookIsbn: bookIsbn bookQuantity: 1. 
	
	self assert: 1 equals: cart size.! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:20:37' prior: 50914948!
test02CartWithABookIsNotEmpty

	| clientId clientPassword cart restAPI bookIsbn |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	restAPI _ RestService new.
	
	bookIsbn _ '10'.
	
	cart _ restAPI createCartFor: clientId withPassword: clientPassword.
	restAPI addToCart: cart bookIsbn: bookIsbn bookQuantity: 1. 
	
	self assert: 1 equals: cart size.! !

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'MR 10/28/2021 21:20:38'!
ERROR!
!RestService methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:20:48'!
addToCart: anOrderedCollection bookIsbn: aString bookQuantity: aSmallInteger 
	self shouldBeImplemented.! !
!RestService methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:21:29' prior: 50914980!
addToCart: aCart bookIsbn: aBookIsbn bookQuantity: aBookQuantity 
	aCart add: aBookIsbn.! !

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'MR 10/28/2021 21:21:30'!
PASSED!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'MR 10/28/2021 21:21:30'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'MR 10/28/2021 21:21:30'!
PASSED!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:21:34' prior: 50914963!
test02CartWithABookIsNotEmpty

	| clientId clientPassword cart restAPI bookIsbn |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	restAPI _ RestService new.
	
	bookIsbn _ '10'.
	
	cart _ restAPI createCartFor: clientId withPassword: clientPassword.
	restAPI addToCart: cart bookIsbn: bookIsbn bookQuantity: 1.
	
	self assert: 1 equals: cart size.! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:23:30'!
test03CartWithABookHasTheBookInItsList

	| clientId clientPassword cart restAPI bookIsbn |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	restAPI _ RestService new.
	
	bookIsbn _ '10'.
	
	cart _ restAPI createCartFor: clientId withPassword: clientPassword.
	restAPI addToCart: cart bookIsbn: bookIsbn bookQuantity: 1.
	
	self assert: cart first equals: bookIsbn.! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:24:25' prior: 50915017!
test03CartWithABookHasTheBookInItsList

	| clientId clientPassword cart restAPI bookIsbn cartList |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	restAPI _ RestService new.
	
	bookIsbn _ '10'.
	
	cart _ restAPI createCartFor: clientId withPassword: clientPassword.
	restAPI addToCart: cart bookIsbn: bookIsbn bookQuantity: 1.
	cartList _ restAPI listCart: cart.
	
	self assert: '0|10|1' equals: cartList.! !

----End fileIn of C:\Users\DESKTOP-MIGUE\Desktop\windows64\Packages\TerseGuide.pck.st----!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'MR 10/28/2021 21:31:07' prior: 50914936!
test01NewCartStartsEmpty

	| clientId clientPassword cart restAPI result |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	restAPI _ RestService new.
	
	result _ restAPI createCartFor: clientId withPassword: clientPassword.
	"0|ID_DEL_CARRITO"
	
	self assert: (OrderedCollection with: 0 with: 0) equals: result.
	self assert: true equals: (restAPI cart: result at: 2) isEmpty.! !

----STARTUP---- (1 November 2021 14:14:57) as /home/ryan/UBA/Ing1/cuis2/CuisUniversity-4913.image!


----End fileIn of /home/ryan/UBA/Ing1/cuis2/TusLibros.st----!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:15:55'!
FAILURE!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:15:55'!
PASSED!

!testRun: #RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:15:55'!
ERROR!

!classDefinition: #Cart category: 'TusLibros' stamp: 'RI 11/1/2021 14:18:39'!
Object subclass: #Cart
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:18:33' prior: 50915923!
test01NewCartStartsEmpty

	| cart |
	
	cart _ Cart new.
	
	self assert: (OrderedCollection new) equals: cart books.! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:18:58' prior: 50915938!
test02CartWithABookIsNotEmpty

	| clientId clientPassword cart restAPI bookIsbn |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	restAPI _ RestService new.
	
	bookIsbn _ '10'.
	
	cart _ restAPI createCartFor: clientId withPassword: clientPassword.
	restAPI addToCart: cart bookIsbn: bookIsbn bookQuantity: 1.
	
	"self assert: 1 equals: cart size."! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:19:02' prior: 50915952!
test03CartWithABookHasTheBookInItsList

	| clientId clientPassword cart restAPI bookIsbn cartList |
	
	clientId _ 'unCliente'.
	clientPassword _ 'unaPassword'.
	restAPI _ RestService new.
	
	bookIsbn _ '10'.
	
	cart _ restAPI createCartFor: clientId withPassword: clientPassword.
	restAPI addToCart: cart bookIsbn: bookIsbn bookQuantity: 1.
	cartList _ restAPI listCart: cart.
	
	"self assert: '0|10|1' equals: cartList."! !

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:19:09'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:19:19'!
books
	self shouldBeImplemented.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:19:41' prior: 50916050!
books
	^OrderedCollection new.! !

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:19:42'!
PASSED!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:19:42'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:19:42'!
PASSED!

!testRun: #RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:19:42'!
ERROR!

!testRun: #RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:19:42'!
ERROR!

!testRun: #RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:19:48'!
ERROR!

!testRun: #RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:19:50'!
ERROR!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:20:01' prior: 50916016!
test02CartWithABookIsNotEmpty! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:20:06' prior: 50916031!
test03CartWithABookHasTheBookInItsList! !

!testRun: #RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:20:08'!
PASSED!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:20:08'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:20:08'!
PASSED!

!testRun: #RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:20:08'!
PASSED!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:21:51' prior: 50916081!
test02CartWithABookIsNotEmpty

	| cart |
	
	cart _ Cart new.
	cart addBook: '1'.
	
	self assert: (OrderedCollection with: '1') equals: cart books.! !

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:21:53'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:22:01'!
addBook: aString 
	self shouldBeImplemented.! !

!classDefinition: #Cart category: 'TusLibros' stamp: 'RI 11/1/2021 14:22:36'!
Object subclass: #Cart
	instanceVariableNames: 'books'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:22:30' prior: 50916115!
addBook: anISBN 
	
	books add: anISBN.! !

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:22:40'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:23:10' overrides: 16896425!
initialize

	books _ OrderedCollection new.! !

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:23:13'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:23:13'!
FAILURE!

!testRun: #RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:23:13'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:23:13'!
FAILURE!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:23:34'!
PASSED!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:23:34'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:23:34'!
FAILURE!

!testRun: #RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:23:34'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:23:34'!
FAILURE!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:24:04' prior: 50916054!
books
	^books.! !

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:24:06'!
PASSED!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:24:10'!
PASSED!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:24:10'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:24:10'!
PASSED!

!testRun: #RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:24:10'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:24:21'!
PASSED!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:24:21'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:24:21'!
PASSED!

!testRun: #RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:24:21'!
PASSED!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:25:13' prior: 50916104!
test02CartWithABookIsNotEmpty

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	
	self assert: (OrderedCollection with: '1') equals: cart books.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:28:20'!
addBook: anISBN withAmount: anAmount
	
	books add: (anISBN, '|', anAmount).! !

!methodRemoval: Cart #addBook: stamp: 'RI 11/1/2021 14:28:25'!
addBook: anISBN 
	
	books add: anISBN.!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:28:37' prior: 50916199!
test02CartWithABookIsNotEmpty

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	
	self assert: (OrderedCollection with: '1|2') equals: cart books.! !

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:28:38'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:28:57' prior: 50916207!
addBook: anISBN withAmount: anAmount
	
	books add: (anISBN, '|', anAmount asString).! !

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:29:05'!
PASSED!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:29:05'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:29:05'!
PASSED!

!testRun: #RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:29:05'!
PASSED!

!methodRemoval: RestServiceTests #test03CartWithABookHasTheBookInItsList stamp: 'RI 11/1/2021 14:31:08'!
test03CartWithABookHasTheBookInItsList!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:31:54'!
test03! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:34:38' prior: 50916251!
test03! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:35:53' prior: 50916255!
test03

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	
	self assert: (OrderedCollection with: '1|4') equals: cart books.! !

!testRun: #RestServiceTests #test03 stamp: 'RI 11/1/2021 14:35:54'!
FAILURE!

----End fileIn of /home/ryan/UBA/Ing1/cuis2/Packages/TerseGuide.pck.st----!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:38:00' prior: 50916134 overrides: 16896425!
initialize

	books _ Dictionary new.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:41:13' prior: 50916228!
addBook: anISBN withAmount: anAmount
	
	| y |
	y _ books at: anISBN ifAbsent: [
		^books add: anISBN->anAmount. 
	].

	books at: anISBN put: y + anAmount.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:41:47' prior: 50919200!
addBook: anISBN withAmount: anAmount
	
	| originalAmount |
	originalAmount _ books at: anISBN ifAbsent: [
		^books add: anISBN->anAmount. 
	].

	books at: anISBN put: originalAmount + anAmount.! !

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:41:52'!
FAILURE!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:41:52'!
FAILURE!

!testRun: #RestServiceTests #test03 stamp: 'RI 11/1/2021 14:41:52'!
FAILURE!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:42:22'!
FAILURE!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:42:29' prior: 50916009!
test01NewCartStartsEmpty

	| cart |
	
	cart _ Cart new.
	
	self assert: true equals: cart books isEmpty .! !

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:42:32'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:42:32'!
FAILURE!

!testRun: #RestServiceTests #test03 stamp: 'RI 11/1/2021 14:42:32'!
FAILURE!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:44:05'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:44:05'!
FAILURE!

!testRun: #RestServiceTests #test03 stamp: 'RI 11/1/2021 14:44:05'!
FAILURE!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:44:08' prior: 50916216!
test02CartWithABookIsNotEmpty

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	
	self assert: 2 equals: (cart books at: '1').
	self assert: 1 equals: cart books size.! !

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:44:10'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:44:10'!
PASSED!

!testRun: #RestServiceTests #test03 stamp: 'RI 11/1/2021 14:44:10'!
FAILURE!

!testRun: #RestServiceTests #test03 stamp: 'RI 11/1/2021 14:44:10'!
FAILURE!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:44:44' prior: 50916259!
test03

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	
	self assert: 4 equals: (cart books at: '1').! !

!testRun: #RestServiceTests #test03 stamp: 'RI 11/1/2021 14:44:45'!
PASSED!

!testRun: #RestServiceTests #test03 stamp: 'RI 11/1/2021 14:44:53'!
PASSED!

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:44:53'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:44:53'!
PASSED!

!testRun: #RestServiceTests #test03 stamp: 'RI 11/1/2021 14:44:53'!
PASSED!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:45:13' prior: 50919273!
test03

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	
	self assert: 4 equals: (cart books at: '1').
	self assert: 1 equals: cart books size.! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:46:44'!
test03AddingExistingBookToACartModifesAmount

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	
	self assert: 4 equals: (cart books at: '1').
	self assert: 1 equals: cart books size.! !

!methodRemoval: RestServiceTests #test03 stamp: 'RI 11/1/2021 14:46:44'!
test03

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	
	self assert: 4 equals: (cart books at: '1').
	self assert: 1 equals: cart books size.!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:47:01'!
test03AddingExistingBookToACartModifiesAmount

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	
	self assert: 4 equals: (cart books at: '1').
	self assert: 1 equals: cart books size.! !

!methodRemoval: RestServiceTests #test03AddingExistingBookToACartModifesAmount stamp: 'RI 11/1/2021 14:47:01'!
test03AddingExistingBookToACartModifesAmount

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	
	self assert: 4 equals: (cart books at: '1').
	self assert: 1 equals: cart books size.!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:50:05' prior: 50919323!
test03AddingExistingBookToACartModifiesAmount

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	cart addBook: '2' withAmount: 3.		
	
	self assert: '1|4|2|3' equals: (cart listBooks).! !

!testRun: #RestServiceTests #test03AddingExistingBookToACartModifiesAmount stamp: 'RI 11/1/2021 14:50:07'!
ERROR!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:47:01' prior: 50919345!
test03AddingExistingBookToACartModifiesAmount

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	
	self assert: 4 equals: (cart books at: '1').
	self assert: 1 equals: cart books size.! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:50:46'!
test04AddingExistingBookToACartModifiesAmount

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	cart addBook: '2' withAmount: 3.		
	
	self assert: '1|4|2|3' equals: (cart listBooks).! !
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:50:58'!
test04

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	cart addBook: '2' withAmount: 3.		
	
	self assert: '1|4|2|3' equals: (cart listBooks).! !

!methodRemoval: RestServiceTests #test04AddingExistingBookToACartModifiesAmount stamp: 'RI 11/1/2021 14:51:00'!
test04AddingExistingBookToACartModifiesAmount

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	cart addBook: '2' withAmount: 3.		
	
	self assert: '1|4|2|3' equals: (cart listBooks).!

!testRun: #RestServiceTests #test04 stamp: 'RI 11/1/2021 14:51:03'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:51:09'!
listBooks
	self shouldBeImplemented.! !

'test' removeLast.!

'test' copyFrom: 0 to: ('test' size - 1)!

'test' copyFrom: 1 to: ('test' size - 1)!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:56:30' prior: 50919404!
listBooks
	| result |
	
	result _ ''.
	
	books keysAndValuesDo: [:aKey :aValue | result _ result , aKey ,  '|' , aValue, '|'].
	
	^result copyFrom: 1 to: (result size - 1).! !

!testRun: #RestServiceTests #test04 stamp: 'RI 11/1/2021 14:56:32'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 14:56:52' prior: 50919412!
listBooks
	| result |
	
	result _ ''.
	
	books keysAndValuesDo: [:aKey :aValue | result _ result , aKey ,  '|' , aValue asString , '|'].
	
	^result copyFrom: 1 to: (result size - 1).! !

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 14:56:52'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 14:56:52'!
PASSED!

!testRun: #RestServiceTests #test03AddingExistingBookToACartModifiesAmount stamp: 'RI 11/1/2021 14:56:52'!
PASSED!

!testRun: #RestServiceTests #test04 stamp: 'RI 11/1/2021 14:56:52'!
FAILURE!

!testRun: #RestServiceTests #test04 stamp: 'RI 11/1/2021 14:56:52'!
FAILURE!

a := Dictionary new.!

a at: '1' put: 2!

a!

a at: '2' put: 2.!

a!

a at: '2' put: 3.!

a!

cart _ Cart new.!

cart addBook: '1' withAmount: 2.!

cart addBook: '1' withAmount: 2.	!

cart addBook: '2' withAmount: 3.		!

cart!

cart books!

a _ ''.!

cart books  keysDo: [:aKey | a _ a, aKey].!

a!

cart addBook: '3' withAmount: 3.		!

a _ ''.!

cart books  keysDo: [:aKey | a _ a, aKey].!

a!

cart addBook: '0' withAmount: 3.		!

a _ ''.!

cart books  keysDo: [:aKey | a _ a, aKey].!

a!

cart keys !

cart books keys!

cart books asSortedCollection!

cart books sort!

cart books!

cart books asArray !

cart books keys !

cart books keys sort!

cart books keys sort do: [:aKey | a _ a , aKey , '|' , cart books at: aKey]!

cart books keys sort do: [:aKey | a _ a , aKey , '|' , cart books at: aKey asString]!

cart books keys sort do: [:aKey | a _ a , aKey , '|' , (cart books at: aKey asString)]!

cart books keys sort do: [:aKey | a _ a , aKey , '|' , ((cart books at: aKey) asString)]!

a!

a _ ''.!

cart books keys sort do: [:aKey | a _ a , aKey , '|' , ((cart books at: aKey) asString)]!

a!

cart _ Cart new.!

cart addBook: '1' withAmount: 2.
cart addBook: '1' withAmount: 2.	
cart addBook: '2' withAmount: 3.		
a _ ''.!

cart books keys sort do: [:aKey | a _ a , aKey , '|' , ((cart books at: aKey) asString)]!

a!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:14:46' prior: 50919423!
listBooks
	| result |
	
	result _ ''.
	
	books keys sort do: [:aKey | result _ result , aKey , '|' , (books at: aKey) asString , '|'].
	
	^result copyFrom: 1 to: (result size - 1).! !

!testRun: #RestServiceTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 15:14:47'!
PASSED!

!testRun: #RestServiceTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 15:14:47'!
PASSED!

!testRun: #RestServiceTests #test03AddingExistingBookToACartModifiesAmount stamp: 'RI 11/1/2021 15:14:47'!
PASSED!

!testRun: #RestServiceTests #test04 stamp: 'RI 11/1/2021 15:14:47'!
PASSED!
!RestServiceTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:16:15'!
test04CartWithMultipleBooksListsThemCorrectly

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	cart addBook: '2' withAmount: 3.		
	
	self assert: '1|4|2|3' equals: (cart listBooks).! !

!methodRemoval: RestServiceTests #test04 stamp: 'RI 11/1/2021 15:16:15'!
test04

	| cart |
	
	cart _ Cart new.
	cart addBook: '1' withAmount: 2.
	cart addBook: '1' withAmount: 2.	
	cart addBook: '2' withAmount: 3.		
	
	self assert: '1|4|2|3' equals: (cart listBooks).!

!classRenamed: #RestServiceTests as: #CartTests stamp: 'RI 11/1/2021 15:20:12'!
Smalltalk renameClassNamed: #RestServiceTests as: #CartTests!
!CartTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:24:26'!
test05

	| cart |
	
	cart _ Cart new.
	
	self should: [cart addBook: '1' withAmount: 0.]
		raise: Error
		withExceptionDo: [:anError | self assert: Cart cannotAddInvalidAmountOfBooks equals: anError messageText].! !

!testRun: #CartTests #test05 stamp: 'RI 11/1/2021 15:24:30'!
FAILURE!

!testRun: #CartTests #test05 stamp: 'RI 11/1/2021 15:24:42'!
FAILURE!

!testRun: #CartTests #test05 stamp: 'RI 11/1/2021 15:24:54'!
FAILURE!

!testRun: #CartTests #test05 stamp: 'RI 11/1/2021 15:24:58'!
FAILURE!

!testRun: #CartTests #test05 stamp: 'RI 11/1/2021 15:25:07'!
FAILURE!

!testRun: #CartTests #test05 stamp: 'RI 11/1/2021 15:25:40'!
FAILURE!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:27:52' prior: 50919208!
addBook: anISBN withAmount: anAmount
	
	| originalAmount |
	
	(anAmount < 1) ifTrue: [self error: Cart cannotAddInvalidAmountOfBooks].
	
	originalAmount _ books at: anISBN ifAbsent: [
		^books add: anISBN->anAmount. 
	].

	books at: anISBN put: originalAmount + anAmount.! !

!testRun: #CartTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 15:27:56'!
PASSED!

!testRun: #CartTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 15:27:56'!
PASSED!

!testRun: #CartTests #test03AddingExistingBookToACartModifiesAmount stamp: 'RI 11/1/2021 15:27:56'!
PASSED!

!testRun: #CartTests #test04CartWithMultipleBooksListsThemCorrectly stamp: 'RI 11/1/2021 15:27:56'!
PASSED!

!testRun: #CartTests #test05 stamp: 'RI 11/1/2021 15:27:56'!
ERROR!

!testRun: #CartTests #test05 stamp: 'RI 11/1/2021 15:27:56'!
ERROR!
!Cart class methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:28:04'!
cannotAddInvalidAmountOfBooks
	self shouldBeImplemented.! !

	^'Cannot add 0 or less books.'.!
!Cart class methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:28:40' prior: 50919583!
cannotAddInvalidAmountOfBooks
	
	^'Cannot add 0 or less books.'.! !

!testRun: #CartTests #test05 stamp: 'RI 11/1/2021 15:28:41'!
FAILURE!
!CartTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:29:22' prior: 50919532!
test05

	| cart |
	
	cart _ Cart new.
	
	self should: [cart addBook: '1' withAmount: 0.]
		raise: Error
		withExceptionDo: [:anError | self assert: Cart cannotAddInvalidAmountOfBooks equals: anError messageText].! !
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:29:46' prior: 50919555!
addBook: anISBN withAmount: anAmount
	
	| originalAmount |
	
	(anAmount < 1) ifTrue: [^self error: Cart cannotAddInvalidAmountOfBooks].
	
	originalAmount _ books at: anISBN ifAbsent: [
		^books add: anISBN->anAmount. 
	].

	books at: anISBN put: originalAmount + anAmount.! !

!testRun: #CartTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 15:29:47'!
PASSED!

!testRun: #CartTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 15:29:47'!
PASSED!

!testRun: #CartTests #test03AddingExistingBookToACartModifiesAmount stamp: 'RI 11/1/2021 15:29:47'!
PASSED!

!testRun: #CartTests #test04CartWithMultipleBooksListsThemCorrectly stamp: 'RI 11/1/2021 15:29:47'!
PASSED!

!testRun: #CartTests #test05 stamp: 'RI 11/1/2021 15:29:47'!
PASSED!
!CartTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:30:58'!
test05AddNegativeOrZeroAmountInCartThrowsError

	| cart |
	
	cart _ Cart new.
	
	self should: [cart addBook: '1' withAmount: 0.]
		raise: Error
		withExceptionDo: [:anError | self assert: Cart cannotAddInvalidAmountOfBooks equals: anError messageText].! !

!methodRemoval: CartTests #test05 stamp: 'RI 11/1/2021 15:30:58'!
test05

	| cart |
	
	cart _ Cart new.
	
	self should: [cart addBook: '1' withAmount: 0.]
		raise: Error
		withExceptionDo: [:anError | self assert: Cart cannotAddInvalidAmountOfBooks equals: anError messageText].!
!CartTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:31:07'!
test05AddingNegativeOrZeroAmountInCartThrowsError

	| cart |
	
	cart _ Cart new.
	
	self should: [cart addBook: '1' withAmount: 0.]
		raise: Error
		withExceptionDo: [:anError | self assert: Cart cannotAddInvalidAmountOfBooks equals: anError messageText].! !

!methodRemoval: CartTests #test05AddNegativeOrZeroAmountInCartThrowsError stamp: 'RI 11/1/2021 15:31:07'!
test05AddNegativeOrZeroAmountInCartThrowsError

	| cart |
	
	cart _ Cart new.
	
	self should: [cart addBook: '1' withAmount: 0.]
		raise: Error
		withExceptionDo: [:anError | self assert: Cart cannotAddInvalidAmountOfBooks equals: anError messageText].!
!CartTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:32:37'!
test06

	| cart |
	
	cart _ Cart new.
	
	self should: [cart addBook: '1' withAmount: 1.5.]
		raise: Error
		withExceptionDo: [:anError | self assert: Cart cannotAddInvalidAmountOfBooks equals: anError messageText].! !

!testRun: #CartTests #test06 stamp: 'RI 11/1/2021 15:32:39'!
FAILURE!

1.5 isInteger !

1 isInteger !

0 isInteger !

-1 isInteger !
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:34:21' prior: 50919607!
addBook: anISBN withAmount: anAmount
	
	| originalAmount |
	
	((anAmount < 1) or: [anAmount isInteger not ]) ifTrue: [^self error: Cart cannotAddInvalidAmountOfBooks].
	
	originalAmount _ books at: anISBN ifAbsent: [
		^books add: anISBN->anAmount. 
	].

	books at: anISBN put: originalAmount + anAmount.! !

!testRun: #CartTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 15:34:22'!
PASSED!

!testRun: #CartTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 15:34:22'!
PASSED!

!testRun: #CartTests #test03AddingExistingBookToACartModifiesAmount stamp: 'RI 11/1/2021 15:34:22'!
PASSED!

!testRun: #CartTests #test04CartWithMultipleBooksListsThemCorrectly stamp: 'RI 11/1/2021 15:34:22'!
PASSED!

!testRun: #CartTests #test05AddingNegativeOrZeroAmountInCartThrowsError stamp: 'RI 11/1/2021 15:34:22'!
PASSED!

!testRun: #CartTests #test06 stamp: 'RI 11/1/2021 15:34:22'!
PASSED!
!Cart methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:34:29' prior: 50919689!
addBook: anISBN withAmount: anAmount
	
	| originalAmount |
	
	((anAmount < 1) or: [anAmount isInteger not]) ifTrue: [^self error: Cart cannotAddInvalidAmountOfBooks].
	
	originalAmount _ books at: anISBN ifAbsent: [
		^books add: anISBN->anAmount. 
	].

	books at: anISBN put: originalAmount + anAmount.! !

!testRun: #CartTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 15:34:31'!
PASSED!

!testRun: #CartTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 15:34:31'!
PASSED!

!testRun: #CartTests #test03AddingExistingBookToACartModifiesAmount stamp: 'RI 11/1/2021 15:34:31'!
PASSED!

!testRun: #CartTests #test04CartWithMultipleBooksListsThemCorrectly stamp: 'RI 11/1/2021 15:34:31'!
PASSED!

!testRun: #CartTests #test05AddingNegativeOrZeroAmountInCartThrowsError stamp: 'RI 11/1/2021 15:34:31'!
PASSED!

!testRun: #CartTests #test06 stamp: 'RI 11/1/2021 15:34:31'!
PASSED!
!Cart class methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:34:49' prior: 50919589!
cannotAddInvalidAmountOfBooks
	
	^'Invalid amount of book to be added.'.! !

!testRun: #CartTests #test01NewCartStartsEmpty stamp: 'RI 11/1/2021 15:34:50'!
PASSED!

!testRun: #CartTests #test02CartWithABookIsNotEmpty stamp: 'RI 11/1/2021 15:34:50'!
PASSED!

!testRun: #CartTests #test03AddingExistingBookToACartModifiesAmount stamp: 'RI 11/1/2021 15:34:50'!
PASSED!

!testRun: #CartTests #test04CartWithMultipleBooksListsThemCorrectly stamp: 'RI 11/1/2021 15:34:50'!
PASSED!

!testRun: #CartTests #test05AddingNegativeOrZeroAmountInCartThrowsError stamp: 'RI 11/1/2021 15:34:50'!
PASSED!

!testRun: #CartTests #test06 stamp: 'RI 11/1/2021 15:34:50'!
PASSED!
!CartTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:35:31'!
test06AddingNotIntegerAmountOfBooksThrowsError

	| cart |
	
	cart _ Cart new.
	
	self should: [cart addBook: '1' withAmount: 1.5.]
		raise: Error
		withExceptionDo: [:anError | self assert: Cart cannotAddInvalidAmountOfBooks equals: anError messageText].! !

!methodRemoval: CartTests #test06 stamp: 'RI 11/1/2021 15:35:31'!
test06

	| cart |
	
	cart _ Cart new.
	
	self should: [cart addBook: '1' withAmount: 1.5.]
		raise: Error
		withExceptionDo: [:anError | self assert: Cart cannotAddInvalidAmountOfBooks equals: anError messageText].!
!CartTests methodsFor: 'as yet unclassified' stamp: 'RI 11/1/2021 15:35:50'!
test05AddingNegativeOrZeroAmountOfBooksThrowsError

	| cart |
	
	cart _ Cart new.
	
	self should: [cart addBook: '1' withAmount: 0.]
		raise: Error
		withExceptionDo: [:anError | self assert: Cart cannotAddInvalidAmountOfBooks equals: anError messageText].! !

!methodRemoval: CartTests #test05AddingNegativeOrZeroAmountInCartThrowsError stamp: 'RI 11/1/2021 15:35:50'!
test05AddingNegativeOrZeroAmountInCartThrowsError

	| cart |
	
	cart _ Cart new.
	
	self should: [cart addBook: '1' withAmount: 0.]
		raise: Error
		withExceptionDo: [:anError | self assert: Cart cannotAddInvalidAmountOfBooks equals: anError messageText].!

!classRemoval: #RestService stamp: 'RI 11/1/2021 15:46:44'!
Object subclass: #RestService
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----SNAPSHOT----(1 November 2021 15:47:05) CuisUniversity-4913.image priorSource: 18696138!

----STARTUP---- (1 November 2021 18:23:37) as C:\Users\migue\Desktop\CuisUniversity\CuisUniversity-4913.image!


----End fileIn of \Users\migue\Desktop\CuisUniversity\TusLibros.st----!

!classRemoval: #Cart stamp: 'MR 11/1/2021 19:16:40'!
Object subclass: #Cart
	instanceVariableNames: 'books'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTests stamp: 'MR 11/1/2021 19:16:41'!
TestCase subclass: #CartTests
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of \Users\migue\Desktop\CuisUniversity\TusLibros-18.st----!

TestCase subclass: #CheckoutTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CheckoutTest category: 'TusLibros' stamp: 'MR 11/1/2021 19:25:13'!
TestCase subclass: #CheckoutTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CheckoutTest methodsFor: 'nil' stamp: 'MR 11/1/2021 19:25:27'!
test01

	! !
!CheckoutTest methodsFor: 'nil' stamp: 'MR 11/1/2021 19:25:47'!
createCart
	
	^Cart acceptingItemsOf: self defaultCatalog! !
!CheckoutTest methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:25:49' prior: 50918243!
createCart
	
	^Cart acceptingItemsOf: self defaultCatalog.! !
!CheckoutTest methodsFor: 'nil' stamp: 'MR 11/1/2021 19:25:55'!
defaultCatalog
	
	^ Array with: self itemSellByTheStore! !
!CheckoutTest methodsFor: 'nil' stamp: 'MR 11/1/2021 19:26:02'!
itemSellByTheStore
	
	^ 'validBook'! !
!CheckoutTest methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:26:14' prior: 50918240!
test01

	| cart |
	cart _ self createCart.
	! !

!methodRemoval: CheckoutTest #test01 stamp: 'MR 11/1/2021 19:27:07'!
test01

	| cart |
	cart _ self createCart.
	!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:27:24'!
test09

	| cart |
	
	cart := self createCart.
	
	self ! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:28:03' prior: 50918269!
test09

	| cart |
	
	cart := self createCart.
	
	self 
		should: [cart checkout ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidCheckoutErrorMessage.
		]! !

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:28:05'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:28:18'!
checkout
	self shouldBeImplemented.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:28:38' prior: 50918286!
checkout
	^self error: Cart invalidCheckoutErrorMessage! !

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:28:38'!
ERROR!
!Cart class methodsFor: 'category-name' stamp: 'MR 11/1/2021 19:28:44'!
invalidCheckoutErrorMessage
	self shouldBeImplemented.! !
!Cart class methodsFor: 'category-name' stamp: 'MR 11/1/2021 19:28:58' prior: 50918297!
invalidCheckoutErrorMessage
	^'Cannot checkout this cart'.! !

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:28:59'!
ERROR!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:29:16' prior: 50918274!
test09

	| cart |
	
	cart := self createCart.
	
	self 
		should: [cart checkout ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cart invalidCheckoutErrorMessage.
		]! !

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:29:17'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 19:29:17'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 19:29:17'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 19:29:17'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 19:29:17'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 19:29:17'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 19:29:17'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 19:29:17'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 19:29:17'!
PASSED!

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:29:17'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:30:23'!
test10

	| cart |
	
	cart := self createCart.
	
	self assert: 10 equals: cart checkout.! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:30:35' prior: 50918348!
test10

	| cart |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	
	self assert: 10 equals: cart checkout.! !

!testRun: #CartTest #test10 stamp: 'MR 11/1/2021 19:30:43'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:32:15' prior: 50918290!
checkout
	self isEmpty ifTrue: [	^self error: Cart invalidCheckoutErrorMessage].
	
	^10.! !

!testRun: #CartTest #test10 stamp: 'MR 11/1/2021 19:32:21'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 19:32:21'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 19:32:21'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 19:32:21'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 19:32:21'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 19:32:21'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 19:32:21'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 19:32:21'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 19:32:21'!
PASSED!

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:32:21'!
PASSED!

!testRun: #CartTest #test10 stamp: 'MR 11/1/2021 19:32:21'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:32:31'!
test11

	| cart |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	
	self assert: 10 equals: cart checkout.! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:32:34' prior: 50918400!
test11

	| cart |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	
	self assert: 20 equals: cart checkout.! !

!testRun: #CartTest #test11 stamp: 'MR 11/1/2021 19:32:36'!
FAILURE!

----End fileIn of C:\Users\migue\Desktop\CuisUniversity\Packages\TerseGuide.pck.st----!
!CartTest methodsFor: 'support' stamp: 'MR 11/1/2021 19:35:28' prior: 50918218!
defaultCatalog
	
	| dict |
	dict _ Dictionary new.
	
	"dict at:" 
	
	^dict.! !
!CartTest methodsFor: 'support' stamp: 'MR 11/1/2021 19:35:50' prior: 50921344!
defaultCatalog
	
	| dict |
	dict _ Dictionary new.
	
	dict at: self itemSellByTheStore put: 10.
	
	^dict.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:37:01' prior: 50918363!
checkout
	|value|
	
	self isEmpty ifTrue: [	^self error: Cart invalidCheckoutErrorMessage].
	
	value _ 0.
	items do: [:anItem |
		value _ value + catalog at: anItem.
	].

	^value.
	! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 19:37:05'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 19:37:05'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 19:37:05'!
ERROR!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 19:37:05'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 19:37:05'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 19:37:05'!
ERROR!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 19:37:05'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 19:37:05'!
ERROR!

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:37:05'!
PASSED!

!testRun: #CartTest #test10 stamp: 'MR 11/1/2021 19:37:05'!
ERROR!

!testRun: #CartTest #test11 stamp: 'MR 11/1/2021 19:37:05'!
ERROR!
!Cart methodsFor: 'assertions' stamp: 'MR 11/1/2021 19:38:04' prior: 50918066!
assertIsValidItem: anItem

	(catalog includesKey: anItem) ifFalse: [ self error: self invalidItemErrorMessage ]! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 19:38:20'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 19:38:20'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 19:38:20'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 19:38:20'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 19:38:20'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 19:38:20'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 19:38:20'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 19:38:20'!
PASSED!

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:38:20'!
PASSED!

!testRun: #CartTest #test10 stamp: 'MR 11/1/2021 19:38:20'!
PASSED!

!testRun: #CartTest #test11 stamp: 'MR 11/1/2021 19:38:20'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:39:37'!
test12
	| cart |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	
	self assert: 20 equals: cart checkout.! !

!methodRemoval: CartTest #test12 stamp: 'MR 11/1/2021 19:40:17'!
test12
	| cart |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	
	self assert: 20 equals: cart checkout.!

Object subclass: #Cashier
	instanceVariableNames: 'catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'MR 11/1/2021 19:40:31'!
Object subclass: #Cashier
	instanceVariableNames: 'catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier methodsFor: 'nil' stamp: 'MR 11/1/2021 19:40:51'!
checkoutFor: aCart

	! !
!Cashier methodsFor: 'nil' stamp: 'MR 11/1/2021 19:41:10'!
initializeWith: aCatalog

	catalog _ aCatalog.! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:43:23' prior: 50918309!
test09

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier new.
	
	self 
		should: [cashier checkoutFor: cart ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cart invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:43:29' prior: 50921466!
test09

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier new.
	
	self 
		should: [cashier checkout: cart ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cart invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:43:50' prior: 50921478!
test09

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier with: self defaultCatalog.
	
	self 
		should: [cashier checkout: cart ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cart invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:44:13' prior: 50921489!
test09

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier with: self defaultCatalog.
	
	self 
		should: [cashier checkout: cart]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:44:21'!
ERROR!
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/1/2021 19:44:26'!
with: aDictionary 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWith: aDictionary ! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/1/2021 19:44:34' prior: 50921515!
with: aCatalog
	^self new initializeWith: aCatalog ! !

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:44:35'!
ERROR!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:44:41'!
checkout: aCart 
	self shouldBeImplemented.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:44:49' prior: 50921530!
checkout: aCart 
	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:45:20' prior: 50921535!
checkout: aCart 
	|value|
	
	aCart isEmpty ifTrue: [	^self error: Cashier invalidCheckoutErrorMessage].
	
	value _ 0.
	aCart items do: [:anItem |
		value _ value + catalog at: anItem.
	].

	^value.! !

!methodRemoval: Cashier #checkoutFor: stamp: 'MR 11/1/2021 19:45:26'!
checkoutFor: aCart

	!
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:46:47'!
items

	^items.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 19:47:16'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 19:47:16'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 19:47:16'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 19:47:16'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 19:47:16'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 19:47:16'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 19:47:16'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 19:47:16'!
PASSED!

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:47:16'!
ERROR!

!testRun: #CartTest #test10 stamp: 'MR 11/1/2021 19:47:16'!
PASSED!

!testRun: #CartTest #test11 stamp: 'MR 11/1/2021 19:47:16'!
PASSED!

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:47:16'!
ERROR!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:47:31'!
invalidCheckoutErrorMessage
	self shouldBeImplemented.! !
!Cashier class methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:47:38' prior: 50921589!
invalidCheckoutErrorMessage
	^'Carrito invalido'.! !

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:47:39'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 19:47:42'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 19:47:42'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 19:47:42'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 19:47:42'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 19:47:42'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 19:47:42'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 19:47:42'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 19:47:42'!
PASSED!

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:47:42'!
PASSED!

!testRun: #CartTest #test10 stamp: 'MR 11/1/2021 19:47:42'!
PASSED!

!testRun: #CartTest #test11 stamp: 'MR 11/1/2021 19:47:42'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:48:11' prior: 50918354!
test10

	| cart cashier |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier new: self defaultCatalog.
	
	self assert: 10 equals: cashier checkout: cart.! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:48:17' prior: 50921633!
test10

	| cart cashier |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier new: self defaultCatalog.
	
	self assert: 10 equals: (cashier checkout: cart).! !

!testRun: #CartTest #test10 stamp: 'MR 11/1/2021 19:48:18'!
ERROR!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:48:27' prior: 50921642!
test10

	| cart cashier |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier for: self defaultCatalog.
	
	self assert: 10 equals: (cashier checkout: cart).! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:48:47' prior: 50921653!
test10

	| cart cashier |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	self assert: 10 equals: (cashier checkout: cart).! !

!testRun: #CartTest #test10 stamp: 'MR 11/1/2021 19:48:54'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 19:48:54'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 19:48:54'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 19:48:54'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 19:48:54'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 19:48:54'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 19:48:54'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 19:48:54'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 19:48:54'!
PASSED!

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:48:54'!
PASSED!

!testRun: #CartTest #test10 stamp: 'MR 11/1/2021 19:48:54'!
PASSED!

!testRun: #CartTest #test11 stamp: 'MR 11/1/2021 19:48:54'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:49:16' prior: 50918408!
test11

	| cart cashier |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	self assert: 20 equals: (cashier checkout: cart).! !

!testRun: #CartTest #test11 stamp: 'MR 11/1/2021 19:49:18'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 19:49:18'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 19:49:18'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 19:49:18'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 19:49:18'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 19:49:18'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 19:49:18'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 19:49:18'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 19:49:18'!
PASSED!

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 19:49:18'!
PASSED!

!testRun: #CartTest #test10 stamp: 'MR 11/1/2021 19:49:18'!
PASSED!

!testRun: #CartTest #test11 stamp: 'MR 11/1/2021 19:49:18'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:50:49'!
test12

	| cart cashier |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	self assert: 20 equals: (cashier checkout: cart ).! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:52:37' prior: 50921749!
test12

	| cart cashier |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	
	
	"self assert: 10 equals: (cashier checkout: cart withCreditCardExpirationDate: )."! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:55:16' prior: 50921759!
test12

	| cart cashier actualDate futureDate |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	actualDate := GregorianMonthOfYear current.
	futureDate := actualDate next: 1.
	
	"self assert: 10 equals: (cashier checkout: cart withCreditCardExpirationDate: )."! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:56:21' prior: 50921769!
test12

	| cart cashier actualDate expirationDate |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	actualDate := GregorianMonthOfYear current.
	expirationDate := actualDate next: 1.
	
	self 
		should: [cashier checkout: cart withCreditCardExpirationDate: expirationDate]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]
	
	"self assert: 10 equals: (cashier checkout: cart withCreditCardExpirationDate: )."! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:56:50' prior: 50921782!
test12

	| cart cashier actualDate expirationDate |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	actualDate := GregorianMonthOfYear current.
	expirationDate := actualDate next: 1.
	
	self 
		should: [cashier checkout: cart withCreditCardExpirationDate: expirationDate]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]
	
	"self assert: 10 equals: (cashier checkout: cart withCreditCardExpirationDate: )."! !

!testRun: #CartTest #test12 stamp: 'MR 11/1/2021 19:56:50'!
ERROR!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:58:06' prior: 50921803!
test12

	| cart cashier actualDate expirationDate |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	actualDate := GregorianMonthOfYear current.
	expirationDate := actualDate previous: 1.
	
	self 
		should: [cashier checkout: cart withCreditCardExpirationDate: expirationDate]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]
	
	"self assert: 10 equals: (cashier checkout: cart withCreditCardExpirationDate: )."! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:58:09' prior: 50921826!
test12

	| cart cashier actualDate expirationDate |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	actualDate := GregorianMonthOfYear current.
	expirationDate := actualDate previous: 1.
	
	self 
		should: [cashier checkout: cart withCreditCardExpirationDate: expirationDate]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!testRun: #CartTest #test12 stamp: 'MR 11/1/2021 19:58:09'!
ERROR!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:58:43' prior: 50921847!
test12

	| cart cashier actualDate expirationDate |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	actualDate := GregorianMonthOfYear current.
	expirationDate := actualDate previous: 100000.
	
	self 
		should: [cashier checkout: cart withCreditCardExpirationDate: expirationDate]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!testRun: #CartTest #test12 stamp: 'MR 11/1/2021 19:58:44'!
ERROR!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 19:58:55' prior: 50921867!
test12

	| cart cashier actualDate expirationDate |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	actualDate := GregorianMonthOfYear current.
	expirationDate := actualDate previous: 1 * month.
	
	self 
		should: [cashier checkout: cart withCreditCardExpirationDate: expirationDate]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!testRun: #CartTest #test12 stamp: 'MR 11/1/2021 19:58:56'!
ERROR!

!testRun: #CartTest #test12 stamp: 'MR 11/1/2021 19:59:02'!
ERROR!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 19:59:10'!
checkout: aCart withCreditCardExpirationDate: aGregorianMonthOfYear 
	self shouldBeImplemented.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:00:14' prior: 50921911!
checkout: aCart withCreditCardExpirationDate: anExpirationMonthOfYear

	(GregorianMonthOfYear current > anExpirationMonthOfYear) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].

	^self checkout: aCart.
	! !

!testRun: #CartTest #test12 stamp: 'MR 11/1/2021 20:00:15'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 20:00:15'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 20:00:15'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 20:00:15'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 20:00:15'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 20:00:15'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 20:00:15'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 20:00:15'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 20:00:15'!
PASSED!

!testRun: #CartTest #test09 stamp: 'MR 11/1/2021 20:00:15'!
PASSED!

!testRun: #CartTest #test10 stamp: 'MR 11/1/2021 20:00:15'!
PASSED!

!testRun: #CartTest #test11 stamp: 'MR 11/1/2021 20:00:15'!
PASSED!

!testRun: #CartTest #test12 stamp: 'MR 11/1/2021 20:00:15'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:00:23' prior: 50921888!
test12

	| cart cashier actualDate expirationDate |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	actualDate := GregorianMonthOfYear current.
	expirationDate := actualDate previous: 1 * month.
	
	self 
		should: [cashier checkout: cart withCreditCardExpirationDate: expirationDate]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!classRemoval: #CheckoutTest stamp: 'MR 11/1/2021 20:02:31'!
TestCase subclass: #CheckoutTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:03:09'!
test09CannotCheckoutEmptyCart

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier with: self defaultCatalog.
	
	self 
		should: [cashier checkout: cart]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!methodRemoval: CartTest #test09 stamp: 'MR 11/1/2021 20:03:09'!
test09

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier with: self defaultCatalog.
	
	self 
		should: [cashier checkout: cart]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]!

!methodRemoval: CartTest #test10 stamp: 'MR 11/1/2021 20:03:26'!
test10

	| cart cashier |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	self assert: 10 equals: (cashier checkout: cart).!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:03:53'!
test10CartCheckoutWithMultipleItemsHasCorrectPrice

	| cart cashier |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	self assert: 20 equals: (cashier checkout: cart).! !

!methodRemoval: CartTest #test11 stamp: 'MR 11/1/2021 20:03:53'!
test11

	| cart cashier |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	self assert: 20 equals: (cashier checkout: cart).!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:04:55'!
test11CannotCheckoutCartWithExpiredCreditCard

	| cart cashier actualDate expirationDate |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	actualDate := GregorianMonthOfYear current.
	expirationDate := actualDate previous: 1 * month.
	
	self 
		should: [cashier checkout: cart withCreditCardExpirationDate: expirationDate]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!methodRemoval: CartTest #test12 stamp: 'MR 11/1/2021 20:04:55'!
test12

	| cart cashier actualDate expirationDate |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	actualDate := GregorianMonthOfYear current.
	expirationDate := actualDate previous: 1 * month.
	
	self 
		should: [cashier checkout: cart withCreditCardExpirationDate: expirationDate]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:06:14' prior: 50922039!
test11CannotCheckoutCartWithExpiredCreditCard

	| cart cashier actualDate expirationDate |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	actualDate := GregorianMonthOfYear current.
	expirationDate := actualDate previous: 1 * month.
	
	self 
		should: [cashier checkout: cart withCreditCardExpirationDate: expirationDate]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:07:29' prior: 50921987!
test09CannotCheckoutEmptyCart

	| cart cashier creditCard |
	
	cart := self createCart.
	cashier := Cashier with: self defaultCatalog.
	creditCard := self createValidCreditCard.
	
	self 
		should: [cashier checkout: cart withCreditCard: creditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:11:08' prior: 50922097!
test09CannotCheckoutEmptyCart

	| cart cashier creditCard |
	
	cart := self createCart.
	cashier := Cashier with: self defaultCatalog.
	creditCard := self createCreditCard.
	
	self 
		should: [cashier checkout: cart withCreditCard: creditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'support' stamp: 'MR 11/1/2021 20:12:06'!
createCreditCard

	| creditCard |
	creditCard _ Dictionary new.
	
	creditCard 
		add: #a->4;
		add: #b->3;
		add: #c->1;
		add: #d->2.
		
	^creditCard.! !
!CartTest methodsFor: 'support' stamp: 'MR 11/1/2021 20:13:19' prior: 50922127!
createCreditCard

	| creditCard |
	
	creditCard _ Dictionary new.
	
	creditCard 
		add: 'name' -> 'Mike Wazowsky';
		add: 'number' -> '4545565667677878';
		add: 'expirationMonth' -> 02;
		add: 'expirationYear' -> 2025.
		
	^creditCard.! !

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:13:35'!
ERROR!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:13:39'!
checkout: aCart withCreditCard: aDictionary 
	self shouldBeImplemented.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:14:17' prior: 50922148!
checkout: aCart withCreditCard: aCreditCard 
	"(GregorianMonthOfYear current > anExpirationMonthOfYear) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	]."

	self checkout: aCart.! !

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:14:27'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 20:14:27'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 20:14:27'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 20:14:27'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 20:14:27'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 20:14:27'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 20:14:27'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 20:14:27'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 20:14:27'!
PASSED!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:14:28'!
PASSED!

!testRun: #CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/1/2021 20:14:28'!
PASSED!

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 20:14:28'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:14:42' prior: 50922019!
test10CartCheckoutWithMultipleItemsHasCorrectPrice

	| cart cashier creditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	creditCard := self createCreditCard.
	
	self assert: 20 equals: (cashier checkout: cart withCreditCard: creditCard).! !

!testRun: #CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/1/2021 20:14:45'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:14:58' prior: 50922154!
checkout: aCart withCreditCard: aCreditCard 
	"(GregorianMonthOfYear current > anExpirationMonthOfYear) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	]."

	^self checkout: aCart.! !

!testRun: #CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/1/2021 20:15:02'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 20:15:02'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 20:15:02'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 20:15:02'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 20:15:02'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 20:15:02'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 20:15:02'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 20:15:02'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 20:15:02'!
PASSED!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:15:02'!
PASSED!

!testRun: #CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/1/2021 20:15:02'!
PASSED!

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 20:15:02'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:16:04' prior: 50922077!
test11CannotCheckoutCartWithExpiredCreditCard

	| cart cashier expiredCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	expiredCreditCard := self createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	self 
		should: [cashier checkout: cart withCreditCard: expiredCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 20:16:12'!
FAILURE!

!methodRemoval: Cashier #checkout:withCreditCardExpirationDate: stamp: 'MR 11/1/2021 20:16:19'!
checkout: aCart withCreditCardExpirationDate: anExpirationMonthOfYear

	(GregorianMonthOfYear current > anExpirationMonthOfYear) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].

	^self checkout: aCart.
	!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:17:27' prior: 50922219!
checkout: aCart withCreditCard: aCreditCard 
	
	| creditCardExpirationDate currentDate |
	currentDate := GregorianMonthOfYear current.
	creditCardExpirationDate := GregorianMonthOfYear year: (aCreditCard at: 'expirationYear') month: (aCreditCard at: 'expirationMonth').
	
	(currentDate > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].

	^self checkout: aCart.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:17:31' prior: 50922300!
checkout: aCart withCreditCard: aCreditCard 
	
	| creditCardExpirationDate currentDate |
	
	currentDate := GregorianMonthOfYear current.
	creditCardExpirationDate := GregorianMonthOfYear year: (aCreditCard at: 'expirationYear') month: (aCreditCard at: 'expirationMonth').
	
	(currentDate > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].

	^self checkout: aCart.! !

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 20:17:35'!
ERROR!

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 20:17:51'!
ERROR!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:19:19' prior: 50922316!
checkout: aCart withCreditCard: aCreditCard 
	
	| creditCardExpirationDate currentDate |
	
	currentDate := GregorianMonthOfYear current.
	creditCardExpirationDate := GregorianMonthOfYear year: (aCreditCard at: 'expirationYear') * year month: (aCreditCard at: 'expirationMonth') * month.
	
	(currentDate > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].

	^self checkout: aCart.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 20:19:26'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 20:19:26'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 20:19:26'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 20:19:26'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 20:19:26'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 20:19:26'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 20:19:26'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 20:19:26'!
PASSED!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:19:26'!
ERROR!

!testRun: #CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/1/2021 20:19:26'!
ERROR!

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 20:19:26'!
ERROR!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:19:32'!
ERROR!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:21:59' prior: 50922339!
checkout: aCart withCreditCard: aCreditCard 
	
	| creditCardExpirationDate currentDate creditCardExpirationMonth creditCardExpirationYear |
	
	currentDate := GregorianMonthOfYear current.
	creditCardExpirationYear := GregorianYear number: (aCreditCard at: 'expirationYear').
	creditCardExpirationMonth := GregorianMonth new.
	creditCardExpirationDate := GregorianMonthOfYear year: creditCardExpirationYear month: (aCreditCard at: 'expirationMonth') * month.
	
	(currentDate > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].

	^self checkout: aCart.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:23:08' prior: 50922393!
checkout: aCart withCreditCard: aCreditCard 
	
	| creditCardExpirationDate currentDate creditCardExpirationMonth creditCardExpirationYear |
	
	currentDate := GregorianMonthOfYear current.
	creditCardExpirationYear := GregorianYear number: (aCreditCard at: 'expirationYear').
	creditCardExpirationMonth := (GregorianMonth new) numbered: (aCreditCard at: 'expirationMonth').
	creditCardExpirationDate := GregorianMonthOfYear year: creditCardExpirationYear month: creditCardExpirationMonth.
	
	(currentDate > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].

	^self checkout: aCart.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 20:23:10'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 20:23:10'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 20:23:10'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 20:23:10'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 20:23:10'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 20:23:10'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 20:23:10'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 20:23:10'!
PASSED!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:23:10'!
ERROR!

!testRun: #CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/1/2021 20:23:10'!
ERROR!

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 20:23:10'!
ERROR!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:23:16'!
ERROR!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:23:39' prior: 50922415!
checkout: aCart withCreditCard: aCreditCard 
	
	| creditCardExpirationDate currentDate creditCardExpirationMonth creditCardExpirationYear |
	
	currentDate := GregorianMonthOfYear current.
	creditCardExpirationYear := GregorianYear number: (aCreditCard at: 'expirationYear').
	creditCardExpirationMonth := GregorianMonth numbered: (aCreditCard at: 'expirationMonth').
	creditCardExpirationDate := GregorianMonthOfYear year: creditCardExpirationYear month: creditCardExpirationMonth.
	
	(currentDate > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].

	^self checkout: aCart.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 20:23:40'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 20:23:40'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 20:23:40'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 20:23:40'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 20:23:40'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 20:23:40'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 20:23:40'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 20:23:40'!
PASSED!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:23:40'!
PASSED!

!testRun: #CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/1/2021 20:23:41'!
PASSED!

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 20:23:41'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:24:06' prior: 50922267!
test11CannotCheckoutCartWithExpiredCreditCard

	| cart cashier expiredCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	expiredCreditCard := self createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	self 
		should: [cashier checkout: cart withCreditCard: expiredCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:24:53'!
test12CannotCheckoutCartWithInvalidCreditCard

	| cart cashier expiredCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	expiredCreditCard := self createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	self 
		should: [cashier checkout: cart withCreditCard: expiredCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:25:03' prior: 50922552!
test12CannotCheckoutCartWithInvalidCreditCard

	| cart cashier expiredCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	expiredCreditCard := self createCreditCard.
	expiredCreditCard at: 'name' put: ''.
	
	self 
		should: [cashier checkout: cart withCreditCard: expiredCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:25:09' prior: 50922571!
test12CannotCheckoutCartWithInvalidCreditCard

	| cart cashier expiredCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	expiredCreditCard := self createCreditCard.
	expiredCreditCard at: 'name' put: ''.
	
	self 
		should: [cashier checkout: cart withCreditCard: expiredCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:25:19' prior: 50922590!
test12CannotCheckoutCartWithInvalidCreditCard

	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:26:00' prior: 50922476!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCreditCardExpirationDate.
	self assertCreditCardName.

	^self checkout: aCart.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:26:12' prior: 50922628!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCreditCardExpirationDate: aCreditCard.
	self assertCreditCardName: aCreditCard.

	^self checkout: aCart.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:26:23'!
assertCreditCardExpirationDate: aCreditCard

	| creditCardExpirationDate currentDate creditCardExpirationMonth creditCardExpirationYear |
	
	currentDate := GregorianMonthOfYear current.
	creditCardExpirationYear := GregorianYear number: (aCreditCard at: 'expirationYear').
	creditCardExpirationMonth := GregorianMonth numbered: (aCreditCard at: 'expirationMonth').
	creditCardExpirationDate := GregorianMonthOfYear year: creditCardExpirationYear month: creditCardExpirationMonth.
	
	(currentDate > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:27:14'!
assertCreditCardName: aCreditCard
	
	| creditCardName |
	creditCardName _ aCreditCard at: 'name'.
	
	(creditCardName = '') ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/1/2021 20:27:30' prior: 50921523!
with: aCatalog
	^self new initializeWith: aCatalog. ! !

!testRun: #CartTest #test12CannotCheckoutCartWithInvalidCreditCard stamp: 'MR 11/1/2021 20:27:35'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 20:27:35'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 20:27:35'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 20:27:35'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 20:27:35'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 20:27:35'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 20:27:35'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 20:27:35'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 20:27:35'!
PASSED!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:27:35'!
PASSED!

!testRun: #CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/1/2021 20:27:35'!
PASSED!

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 20:27:35'!
PASSED!

!testRun: #CartTest #test12CannotCheckoutCartWithInvalidCreditCard stamp: 'MR 11/1/2021 20:27:35'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:28:34'!
test13CannotCheckoutCartWithInvalidCreditCardNumber

	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:28:38'!
test12CannotCheckoutCartWithInvalidCreditCardName

	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!methodRemoval: CartTest #test12CannotCheckoutCartWithInvalidCreditCard stamp: 'MR 11/1/2021 20:28:38'!
test12CannotCheckoutCartWithInvalidCreditCard

	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:29:02' prior: 50922720!
test13CannotCheckoutCartWithInvalidCreditCardNumber

	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'number' put: ''.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 20:29:18' prior: 50922777!
test13CannotCheckoutCartWithInvalidCreditCardNumber

	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'number' put: 'noSoyUnNumeroooo'.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!testRun: #CartTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/1/2021 20:29:26'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:29:54' prior: 50922636!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCreditCardExpirationDate: aCreditCard.
	self assertCreditCardName: aCreditCard.
	self assertCreditCardNumber: aCreditCard.

	^self checkout: aCart.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:30:30'!
assertCreditCardNumber: aCreditCard

	(aCreditCard at: 'number') isNumber ifFalse: [
		
	]. ! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:31:11' prior: 50922829!
assertCreditCardNumber: aCreditCard

	| creditCardNumber |
	creditCardNumber _ (aCreditCard at: 'number').
	creditCardNumber isNumber and ifFalse: [
		
	]. ! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:31:28' prior: 50922835!
assertCreditCardNumber: aCreditCard

	| creditCardNumber |
	creditCardNumber _ (aCreditCard at: 'number').
	creditCardNumber isNumber and ifFalse: [
		^self error: Cashier invalidCheckoutErrorMessage.
	]. ! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 20:31:35'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 20:31:35'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 20:31:35'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 20:31:35'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 20:31:35'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 20:31:35'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 20:31:35'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 20:31:35'!
PASSED!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:31:35'!
ERROR!

!testRun: #CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/1/2021 20:31:35'!
ERROR!

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 20:31:35'!
PASSED!

!testRun: #CartTest #test12CannotCheckoutCartWithInvalidCreditCardName stamp: 'MR 11/1/2021 20:31:35'!
PASSED!

!testRun: #CartTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/1/2021 20:31:35'!
ERROR!
!CartTest methodsFor: 'support' stamp: 'MR 11/1/2021 20:31:49' prior: 50922135!
createCreditCard

	| creditCard |
	
	creditCard _ Dictionary new.
	
	creditCard 
		add: 'name' -> 'Mike Wazowsky';
		add: 'number' -> 4545565667677878;
		add: 'expirationMonth' -> 02;
		add: 'expirationYear' -> 2025.
		
	^creditCard.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 20:31:55'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 20:31:55'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 20:31:55'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 20:31:55'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 20:31:55'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 20:31:55'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 20:31:55'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 20:31:55'!
PASSED!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:31:55'!
ERROR!

!testRun: #CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/1/2021 20:31:55'!
ERROR!

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 20:31:55'!
PASSED!

!testRun: #CartTest #test12CannotCheckoutCartWithInvalidCreditCardName stamp: 'MR 11/1/2021 20:31:55'!
PASSED!

!testRun: #CartTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/1/2021 20:31:55'!
ERROR!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:31:59'!
ERROR!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/1/2021 20:32:12' prior: 50922843!
assertCreditCardNumber: aCreditCard

	| creditCardNumber |
	creditCardNumber _ (aCreditCard at: 'number').
	creditCardNumber isNumber ifFalse: [
		^self error: Cashier invalidCheckoutErrorMessage.
	]. ! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

!testRun: #CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

!testRun: #CartTest #test12CannotCheckoutCartWithInvalidCreditCardName stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

!testRun: #CartTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/1/2021 20:32:15'!
PASSED!

TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CashierTest category: 'TusLibros' stamp: 'MR 11/1/2021 21:27:08'!
TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

TestCase subclass: #TusLibrosTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosTest category: 'TusLibros' stamp: 'MR 11/1/2021 21:27:18'!
TestCase subclass: #TusLibrosTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #TusLibrosTest stamp: 'MR 11/1/2021 21:27:22'!
TestCase subclass: #TusLibrosTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

TestCase subclass: #TusLibrosTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosTest category: 'TusLibros' stamp: 'MR 11/1/2021 21:28:19'!
TestCase subclass: #TusLibrosTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

TusLibrosTest subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CashierTest category: 'TusLibros' stamp: 'MR 11/1/2021 21:28:25'!
TusLibrosTest subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

TusLibrosTest subclass: #CartTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartTest category: 'TusLibros' stamp: 'MR 11/1/2021 21:28:30'!
TusLibrosTest subclass: #CartTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

!testRun: #CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

!testRun: #CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

!testRun: #CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

!testRun: #CartTest #test12CannotCheckoutCartWithInvalidCreditCardName stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

!testRun: #CartTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/1/2021 21:28:43'!
PASSED!

Object subclass: #CartTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartTest category: 'TusLibros' stamp: 'MR 11/1/2021 21:29:02'!
Object subclass: #CartTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

Object subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CashierTest category: 'TusLibros' stamp: 'MR 11/1/2021 21:29:04'!
Object subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #TusLibrosTest stamp: 'MR 11/1/2021 21:29:07'!
TestCase subclass: #TusLibrosTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 21:29:31' prior: 50922112!
test09CannotCheckoutEmptyCart
	"PASAR A CLASE CashierTest"
	| cart cashier creditCard |
	
	cart := self createCart.
	cashier := Cashier with: self defaultCatalog.
	creditCard := self createCreditCard.
	
	self 
		should: [cashier checkout: cart withCreditCard: creditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 21:29:34' prior: 50922201!
test10CartCheckoutWithMultipleItemsHasCorrectPrice
"PASAR A CLASE CashierTest"
	| cart cashier creditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	creditCard := self createCreditCard.
	
	self assert: 20 equals: (cashier checkout: cart withCreditCard: creditCard).! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 21:29:37' prior: 50922533!
test11CannotCheckoutCartWithExpiredCreditCard
"PASAR A CLASE CashierTest"
	| cart cashier expiredCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	expiredCreditCard := self createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	self 
		should: [cashier checkout: cart withCreditCard: expiredCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 21:29:40' prior: 50922739!
test12CannotCheckoutCartWithInvalidCreditCardName
"PASAR A CLASE CashierTest"
	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 21:29:42' prior: 50922796!
test13CannotCheckoutCartWithInvalidCreditCardNumber
"PASAR A CLASE CashierTest"
	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'number' put: 'noSoyUnNumeroooo'.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 21:30:06' prior: 50923203!
test13CannotCheckoutCartWithInvalidCreditCardNumber
	"PASAR A CLASE CashierTest"
	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'number' put: 'noSoyUnNumeroooo'.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/1/2021 21:30:24'!
test14

	! !

----SNAPSHOT----(1 November 2021 21:35:29) CuisUniversity-4913.image priorSource: 18661997!

----STARTUP---- (2 November 2021 15:04:11) as C:\Users\migue\Desktop\CuisUniversity\CuisUniversity-4913.image!


Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #StoreTestObjectsFactory category: 'TusLibros' stamp: 'MR 11/2/2021 15:13:35'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!methodRemoval: CartTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:13:43'!
test09CannotCheckoutEmptyCart
	"PASAR A CLASE CashierTest"
	| cart cashier creditCard |
	
	cart := self createCart.
	cashier := Cashier with: self defaultCatalog.
	creditCard := self createCreditCard.
	
	self 
		should: [cashier checkout: cart withCreditCard: creditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]!
!CashierTest methodsFor: 'nil' stamp: 'MR 11/2/2021 15:14:29'!
test10CartCheckoutWithMultipleItemsHasCorrectPrice
"PASAR A CLASE CashierTest"
	| cart cashier creditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	creditCard := self createCreditCard.
	
	self assert: 20 equals: (cashier checkout: cart withCreditCard: creditCard).! !

!methodRemoval: CartTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:14:34'!
test10CartCheckoutWithMultipleItemsHasCorrectPrice
"PASAR A CLASE CashierTest"
	| cart cashier creditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	creditCard := self createCreditCard.
	
	self assert: 20 equals: (cashier checkout: cart withCreditCard: creditCard).!
!CashierTest methodsFor: 'nil' stamp: 'MR 11/2/2021 15:14:40'!
test11CannotCheckoutCartWithExpiredCreditCard
"PASAR A CLASE CashierTest"
	| cart cashier expiredCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	expiredCreditCard := self createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	self 
		should: [cashier checkout: cart withCreditCard: expiredCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!methodRemoval: CartTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 15:14:45'!
test11CannotCheckoutCartWithExpiredCreditCard
"PASAR A CLASE CashierTest"
	| cart cashier expiredCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	expiredCreditCard := self createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	self 
		should: [cashier checkout: cart withCreditCard: expiredCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]!
!CashierTest methodsFor: 'nil' stamp: 'MR 11/2/2021 15:14:50'!
test12CannotCheckoutCartWithInvalidCreditCardName
"PASAR A CLASE CashierTest"
	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'nil' stamp: 'MR 11/2/2021 15:14:59'!
test13CannotCheckoutCartWithInvalidCreditCardNumber
	"PASAR A CLASE CashierTest"
	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'number' put: 'noSoyUnNumeroooo'.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!methodRemoval: CartTest #test12CannotCheckoutCartWithInvalidCreditCardName stamp: 'MR 11/2/2021 15:15:03'!
test12CannotCheckoutCartWithInvalidCreditCardName
"PASAR A CLASE CashierTest"
	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]!

!methodRemoval: CartTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/2/2021 15:15:04'!
test13CannotCheckoutCartWithInvalidCreditCardNumber
	"PASAR A CLASE CashierTest"
	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'number' put: 'noSoyUnNumeroooo'.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]!

!methodRemoval: CartTest #test14 stamp: 'MR 11/2/2021 15:15:05'!
test14

	!
!CashierTest methodsFor: 'nil' stamp: 'MR 11/2/2021 15:15:14'!
test09CannotCheckoutEmptyCart
    "PASAR A CLASE CashierTest"
    | cart cashier creditCard |

    cart := self createCart.
    cashier := Cashier with: self defaultCatalog.
    creditCard := self createCreditCard.

    self 
        should: [cashier checkout: cart withCreditCard: creditCard]
        raise: Error - MessageNotUnderstood
        withExceptionDo: [ :anError |
            self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
        ]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:15:17' prior: 50923432!
test09CannotCheckoutEmptyCart
    | cart cashier creditCard |

    cart := self createCart.
    cashier := Cashier with: self defaultCatalog.
    creditCard := self createCreditCard.

    self 
        should: [cashier checkout: cart withCreditCard: creditCard]
        raise: Error - MessageNotUnderstood
        withExceptionDo: [ :anError |
            self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
        ]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:15:20' prior: 50923280!
test10CartCheckoutWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	creditCard := self createCreditCard.
	
	self assert: 20 equals: (cashier checkout: cart withCreditCard: creditCard).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:15:24' prior: 50923309!
test11CannotCheckoutCartWithExpiredCreditCard

	| cart cashier expiredCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	expiredCreditCard := self createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	self 
		should: [cashier checkout: cart withCreditCard: expiredCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:15:25' prior: 50923481!
test11CannotCheckoutCartWithExpiredCreditCard
	| cart cashier expiredCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	expiredCreditCard := self createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	self 
		should: [cashier checkout: cart withCreditCard: expiredCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:15:28' prior: 50923349!
test12CannotCheckoutCartWithInvalidCreditCardName
	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:15:32' prior: 50923368!
test13CannotCheckoutCartWithInvalidCreditCardNumber
	| cart cashier invalidCreditCard |
	
	cart := self createCart.
	cart add: self itemSellByTheStore.
	cashier := Cashier with: self defaultCatalog.
	
	invalidCreditCard := self createCreditCard.
	invalidCreditCard at: 'number' put: 'noSoyUnNumeroooo'.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!StoreTestObjectsFactory methodsFor: 'nil' stamp: 'MR 11/2/2021 15:15:59'!
itemSellByTheStore
	
	^ 'validBook'! !

Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #StoreTestObjectsFactory category: 'TusLibros' stamp: 'MR 11/2/2021 15:16:12'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreTestObjectsFactory methodsFor: 'nil' stamp: 'MR 11/2/2021 15:16:15'!
itemNotSellByTheStore
	
	^'invalidBook'! !
!CartTest methodsFor: 'support' stamp: 'MR 11/2/2021 15:16:22' prior: 50921349!
defaultCatalog
	
	| dict |
	dict _ Dictionary new.
	
	dict at: self itemSellByTheStore put: 10.
	
	^dict.! !
!StoreTestObjectsFactory methodsFor: 'nil' stamp: 'MR 11/2/2021 15:16:27'!
defaultCatalog
	
	| dict |
	dict _ Dictionary new.
	
	dict at: self itemSellByTheStore put: 10.
	
	^dict.! !
!StoreTestObjectsFactory methodsFor: 'nil' stamp: 'MR 11/2/2021 15:16:34'!
createCreditCard

	| creditCard |
	
	creditCard _ Dictionary new.
	
	creditCard 
		add: 'name' -> 'Mike Wazowsky';
		add: 'number' -> 4545565667677878;
		add: 'expirationMonth' -> 02;
		add: 'expirationYear' -> 2025.
		
	^creditCard.! !
!StoreTestObjectsFactory methodsFor: 'nil' stamp: 'MR 11/2/2021 15:16:42'!
createCart
	
	^Cart acceptingItemsOf: self defaultCatalog! !

!methodRemoval: CartTest #createCart stamp: 'MR 11/2/2021 15:16:48'!
createCart
	
	^Cart acceptingItemsOf: self defaultCatalog!

!methodRemoval: CartTest #createCreditCard stamp: 'MR 11/2/2021 15:16:48'!
createCreditCard

	| creditCard |
	
	creditCard _ Dictionary new.
	
	creditCard 
		add: 'name' -> 'Mike Wazowsky';
		add: 'number' -> 4545565667677878;
		add: 'expirationMonth' -> 02;
		add: 'expirationYear' -> 2025.
		
	^creditCard.!

!methodRemoval: CartTest #defaultCatalog stamp: 'MR 11/2/2021 15:16:48'!
defaultCatalog
	
	| dict |
	dict _ Dictionary new.
	
	dict at: self itemSellByTheStore put: 10.
	
	^dict.!

!methodRemoval: CartTest #itemNotSellByTheStore stamp: 'MR 11/2/2021 15:16:48'!
itemNotSellByTheStore
	
	^'invalidBook'!

!methodRemoval: CartTest #itemSellByTheStore stamp: 'MR 11/2/2021 15:16:48'!
itemSellByTheStore
	
	^ 'validBook'!

Object subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartTest category: 'TusLibros' stamp: 'MR 11/2/2021 15:17:18'!
Object subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

Object subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CashierTest category: 'TusLibros' stamp: 'MR 11/2/2021 15:17:21'!
Object subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartTest methodsFor: 'nil' stamp: 'MR 11/2/2021 15:17:41'!
setUp

	! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:18:00' prior: 50923655!
setUp

	testObjectsFactory := StoreTestObjectsFactory new.! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:18:19' prior: 50918168!
test01NewCartsAreCreatedEmpty

	self assert: testObjectsFactory createCart isEmpty! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:18:23' prior: 50918146!
test02CanNotAddItemsThatDoNotBelongToStore

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self 
		should: [ cart add: testObjectsFactory itemNotSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:18:27' prior: 50918173!
test03AfterAddingAnItemTheCartIsNotEmptyAnymore

	| cart |
	
	cart := testObjectsFactory createCart.
	
	cart add: testObjectsFactory itemSellByTheStore.
	self deny: cart isEmpty ! !

TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartTest category: 'TusLibros' stamp: 'MR 11/2/2021 15:18:41'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CashierTest category: 'TusLibros' stamp: 'MR 11/2/2021 15:18:45'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/2/2021 15:18:46'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/2/2021 15:18:46'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/2/2021 15:18:46'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/2/2021 15:18:46'!
ERROR!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/2/2021 15:18:46'!
ERROR!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/2/2021 15:18:46'!
ERROR!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/2/2021 15:18:46'!
ERROR!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/2/2021 15:18:46'!
ERROR!
!CartTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:18:53' prior: 50918133!
test04CanNotAddNonPositiveNumberOfItems

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self 
		should: [cart add: 0 of: testObjectsFactory itemSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:18:58' prior: 50918188!
test05CanNotAddMoreThanOneItemNotSellByTheStore

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self 
		should: [cart add: 2 of: testObjectsFactory itemNotSellByTheStore  ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:19:02' prior: 50918201!
test06CartRemembersAddedItems

	| cart |
	
	cart := testObjectsFactory createCart.
	
	cart add: testObjectsFactory itemSellByTheStore.
	self assert: (cart includes: testObjectsFactory itemSellByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:19:05' prior: 50918181!
test07CartDoesNotHoldNotAddedItems

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self deny: (cart includes: testObjectsFactory itemSellByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:19:10' prior: 50918159!
test08CartRemembersTheNumberOfAddedItems

	| cart |
	
	cart := testObjectsFactory createCart.
	
	cart add: 2 of: testObjectsFactory itemSellByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSellByTheStore) = 2! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/2/2021 15:19:11'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/2/2021 15:19:11'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/2/2021 15:19:11'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/2/2021 15:19:11'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/2/2021 15:19:11'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/2/2021 15:19:11'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/2/2021 15:19:11'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/2/2021 15:19:11'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/2/2021 15:19:11'!
PASSED!
!CashierTest methodsFor: 'nil' stamp: 'MR 11/2/2021 15:19:22' overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:19:37' prior: 50923450!
test09CannotCheckoutEmptyCart
    | cart cashier creditCard |

    cart := testObjectsFactory createCart.
    cashier := Cashier with: testObjectsFactory defaultCatalog.
    creditCard := testObjectsFactory createCreditCard.

    self 
        should: [cashier checkout: cart withCreditCard: creditCard]
        raise: Error - MessageNotUnderstood
        withExceptionDo: [ :anError |
            self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
        ]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:19:41' prior: 50923467!
test10CartCheckoutWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard |
	
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	cashier := Cashier with: testObjectsFactory defaultCatalog.
	creditCard := testObjectsFactory createCreditCard.
	
	self assert: 20 equals: (cashier checkout: cart withCreditCard: creditCard).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:19:46' prior: 50923501!
test11CannotCheckoutCartWithExpiredCreditCard
	| cart cashier expiredCreditCard |
	
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cashier := Cashier with: testObjectsFactory defaultCatalog.
	
	expiredCreditCard := testObjectsFactory createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	self 
		should: [cashier checkout: cart withCreditCard: expiredCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:19:53' prior: 50923521!
test12CannotCheckoutCartWithInvalidCreditCardName
	| cart cashier invalidCreditCard |
	
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cashier := Cashier with: testObjectsFactory defaultCatalog.
	
	invalidCreditCard := testObjectsFactory createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:19:57' prior: 50923540!
test13CannotCheckoutCartWithInvalidCreditCardNumber
	| cart cashier invalidCreditCard |
	
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cashier := Cashier with: testObjectsFactory defaultCatalog.
	
	invalidCreditCard := testObjectsFactory createCreditCard.
	invalidCreditCard at: 'number' put: 'noSoyUnNumeroooo'.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!testRun: #CashierTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/2/2021 15:19:59'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/2/2021 15:19:59'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/2/2021 15:19:59'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/2/2021 15:19:59'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/2/2021 15:19:59'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/2/2021 15:20:00'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/2/2021 15:20:00'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/2/2021 15:20:00'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/2/2021 15:20:00'!
PASSED!

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:20:00'!
PASSED!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:20:00'!
PASSED!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 15:20:00'!
PASSED!

!testRun: #CashierTest #test12CannotCheckoutCartWithInvalidCreditCardName stamp: 'MR 11/2/2021 15:20:00'!
PASSED!

!testRun: #CashierTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/2/2021 15:20:00'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:22:38' prior: 50923830!
test09CannotCheckoutEmptyCart
	| cart cashier creditCard salesBook |

	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createCreditCard.

	cashier := Cashier 
		toCheckout: cart 
		withCreditCard: creditCard
		onDate: testObjectsFactory today
		registerAt: salesBook.

	self 
		should: [cashier checkout: cart withCreditCard: creditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:24:02' prior: 50923976!
test09CannotCheckoutEmptyCart
	| cart cashier creditCard salesBook |

	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createCreditCard.

	self 
		should: [Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:24:08'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:24:13'!
today
	self shouldBeImplemented.! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:24:35' prior: 50924017!
today
	GregorianMonthOfYear current.! !

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:24:36'!
ERROR!
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:24:43'!
toCheckout: aCart withCreditCard: aDictionary onDate: aStoreTestObjectsFactory registerAt: anOrderedCollection 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeToCheckout: aCart withCreditCard: aDictionary onDate: aStoreTestObjectsFactory registerAt: anOrderedCollection ! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:25:17' prior: 50924029!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook 
	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook.! !

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:25:18'!
ERROR!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'MR 11/2/2021 15:25:22'!
Object subclass: #Cashier
	instanceVariableNames: 'catalog cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'MR 11/2/2021 15:25:22'!
Object subclass: #Cashier
	instanceVariableNames: 'catalog cart creditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'MR 11/2/2021 15:25:22'!
Object subclass: #Cashier
	instanceVariableNames: 'catalog cart creditCard date'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'MR 11/2/2021 15:25:22'!
Object subclass: #Cashier
	instanceVariableNames: 'catalog cart creditCard date salesBook'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier methodsFor: 'initialization' stamp: 'MR 11/2/2021 15:25:22'!
initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook 
	self shouldBeImplemented.
	cart := aCart.
	creditCard := aCreditCard.
	date := aDate.
	salesBook := aSalesBook.! !
!Cashier methodsFor: 'initialization' stamp: 'MR 11/2/2021 15:25:43' prior: 50924083!
initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook 
	cart := aCart.
	creditCard := aCreditCard.
	date := aDate.
	salesBook := aSalesBook.! !

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:25:43'!
FAILURE!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:25:55' prior: 50923996!
test09CannotCheckoutEmptyCart
	| cart creditCard salesBook |

	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createCreditCard.

	self
		should: [Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:26:56' prior: 50924043!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook 
	aCart isEmpty ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage.
	].

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook.! !

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:27:05'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:28:29' prior: 50923849!
test10CartCheckoutWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard salesBook |
	
	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	
	self assert: 20 equals: (cashier checkout).! !

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:28:30'!
ERROR!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:28:36'!
checkout
	self shouldBeImplemented.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:28:43' prior: 50924160!
checkout
	^20.! !

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:28:44'!
PASSED!

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:28:44'!
PASSED!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:28:44'!
PASSED!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 15:28:44'!
PASSED!

!testRun: #CashierTest #test12CannotCheckoutCartWithInvalidCreditCardName stamp: 'MR 11/2/2021 15:28:44'!
PASSED!

!testRun: #CashierTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/2/2021 15:28:44'!
PASSED!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:29:19' prior: 50924165!
checkout
	|value|
	
	cart isEmpty ifTrue: [	^self error: Cashier invalidCheckoutErrorMessage].
	
	value _ 0.
	cart items do: [:anItem |
		value _ value + catalog at: anItem.
	].

	^value.! !

!methodRemoval: Cashier #checkout: stamp: 'MR 11/2/2021 15:29:25'!
checkout: aCart 
	|value|
	
	aCart isEmpty ifTrue: [	^self error: Cashier invalidCheckoutErrorMessage].
	
	value _ 0.
	aCart items do: [:anItem |
		value _ value + catalog at: anItem.
	].

	^value.!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:29:42' prior: 50924190!
checkout
	^cart total.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:30:18'!
total
	|value|

	value _ 0.
	items do: [:anItem |
		value _ value + catalog at: anItem.
	].

	^value.
	! !

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:30:26'!
PASSED!

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:30:26'!
PASSED!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:30:26'!
PASSED!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 15:30:26'!
PASSED!

!testRun: #CashierTest #test12CannotCheckoutCartWithInvalidCreditCardName stamp: 'MR 11/2/2021 15:30:26'!
PASSED!

!testRun: #CashierTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/2/2021 15:30:26'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:31:09' prior: 50923866!
test11CannotCheckoutCartWithExpiredCreditCard
	| cart cashier expiredCreditCard salesBook |
	
	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	expiredCreditCard := testObjectsFactory createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	cashier := Cashier toCheckout: cart withCreditCard: expiredCreditCard onDate: testObjectsFactory today registerAt: salesBook.
	
	self 
		should: [cashier checkout: cart withCreditCard: expiredCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:31:19' prior: 50924239!
test11CannotCheckoutCartWithExpiredCreditCard
	| cart cashier expiredCreditCard salesBook |
	
	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	expiredCreditCard := testObjectsFactory createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	cashier := Cashier toCheckout: cart withCreditCard: expiredCreditCard onDate: testObjectsFactory today registerAt: salesBook.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 15:31:20'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:31:46' prior: 50922820!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCreditCardExpirationDate: aCreditCard.
	self assertCreditCardName: aCreditCard.
	self assertCreditCardNumber: aCreditCard.

	^self checkout: aCart.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:31:58' prior: 50924208!
checkout
	self assertCreditCardExpirationDate.

	^cart total.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:33:11' prior: 50922644!
assertCreditCardExpirationDate: aDate

	| creditCardExpirationDate creditCardExpirationMonth creditCardExpirationYear |
	
	creditCardExpirationYear := GregorianYear number: (creditCard at: 'expirationYear').
	creditCardExpirationMonth := GregorianMonth numbered: (creditCard at: 'expirationMonth').
	creditCardExpirationDate := GregorianMonthOfYear year: creditCardExpirationYear month: creditCardExpirationMonth.
	
	(aDate > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:33:23'!
assertCreditCardName
	
	| creditCardName |
	creditCardName _ creditCard at: 'name'.
	
	(creditCardName = '') ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].! !

!methodRemoval: Cashier #assertCreditCardName: stamp: 'MR 11/2/2021 15:33:26'!
assertCreditCardName: aCreditCard
	
	| creditCardName |
	creditCardName _ aCreditCard at: 'name'.
	
	(creditCardName = '') ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:33:31'!
assertCreditCardNumber

	| creditCardNumber |
	creditCardNumber _ (creditCard at: 'number').
	creditCardNumber isNumber ifFalse: [
		^self error: Cashier invalidCheckoutErrorMessage.
	]. ! !

!methodRemoval: Cashier #assertCreditCardNumber: stamp: 'MR 11/2/2021 15:33:33'!
assertCreditCardNumber: aCreditCard

	| creditCardNumber |
	creditCardNumber _ (aCreditCard at: 'number').
	creditCardNumber isNumber ifFalse: [
		^self error: Cashier invalidCheckoutErrorMessage.
	]. !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:33:46' prior: 50924301!
checkout
	self assertCreditCardExpirationDate.

	^cart total.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:33:54'!
assertCreditCardExpirationDate

	| creditCardExpirationDate creditCardExpirationMonth creditCardExpirationYear |
	
	creditCardExpirationYear := GregorianYear number: (creditCard at: 'expirationYear').
	creditCardExpirationMonth := GregorianMonth numbered: (creditCard at: 'expirationMonth').
	creditCardExpirationDate := GregorianMonthOfYear year: creditCardExpirationYear month: creditCardExpirationMonth.
	
	(date > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].! !

!methodRemoval: Cashier #assertCreditCardExpirationDate: stamp: 'MR 11/2/2021 15:34:16'!
assertCreditCardExpirationDate: aDate

	| creditCardExpirationDate creditCardExpirationMonth creditCardExpirationYear |
	
	creditCardExpirationYear := GregorianYear number: (creditCard at: 'expirationYear').
	creditCardExpirationMonth := GregorianMonth numbered: (creditCard at: 'expirationMonth').
	creditCardExpirationDate := GregorianMonthOfYear year: creditCardExpirationYear month: creditCardExpirationMonth.
	
	(aDate > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:34:45'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:35:03' prior: 50924022!
today
	^GregorianMonthOfYear current.! !

!testRun: #CashierTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/2/2021 15:35:07'!
ERROR!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 15:35:22'!
PASSED!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:36:11' prior: 50924360!
checkout
	^cart total.! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:36:50' prior: 50924123!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook 

	self assertIsNotExpired: aCreditCard on: aDate.

	aCart isEmpty ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage.
	].

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook.! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:37:01' prior: 50924423!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook 

	self assertIsNotExpired: aCreditCard on: aDate.

	aCart isEmpty ifTrue: [
		self error: Cashier invalidCheckoutErrorMessage.
	].

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook.! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:37:12'!
assertIsNotEmpty: aCart

	^ aCart isEmpty ifTrue: [
		self error: Cashier invalidCheckoutErrorMessage.
	]! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:37:12' prior: 50924437!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook 

	self assertIsNotExpired: aCreditCard on: aDate.

	self assertIsNotEmpty: aCart.

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook.! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:37:17' prior: 50924457!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook 

	self assertIsNotExpired: aCreditCard on: aDate.
	self assertIsNotEmpty: aCart.

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook.! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:37:21' prior: 50924450!
assertIsNotEmpty: aCart

	^ aCart isEmpty ifTrue: [
		self error: Cashier invalidCheckoutErrorMessage.
	].! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:37:22' prior: 50924481!
assertIsNotEmpty: aCart

	^ aCart isEmpty ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage.
	].! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:37:28' prior: 50924488!
assertIsNotEmpty: aCart

	aCart isEmpty ifTrue: [
		self error: Cashier invalidCheckoutErrorMessage.
	].! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:37:29' prior: 50924495!
assertIsNotEmpty: aCart

	aCart isEmpty ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage.
	].! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:37:38'!
assertIsNotExpired: aCreditCard on: aDate.
	! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:37:45' prior: 50924365!
assertCreditCardExpirationDate

	| creditCardExpirationDate creditCardExpirationMonth creditCardExpirationYear |
	
	creditCardExpirationYear := GregorianYear number: (creditCard at: 'expirationYear').
	creditCardExpirationMonth := GregorianMonth numbered: (creditCard at: 'expirationMonth').
	creditCardExpirationDate := GregorianMonthOfYear year: creditCardExpirationYear month: creditCardExpirationMonth.
	
	(date > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 15:38:04' prior: 50924508!
assertIsNotExpired: aCreditCard on: aDate

	| creditCardExpirationDate creditCardExpirationMonth creditCardExpirationYear |
	
	creditCardExpirationYear := GregorianYear number: (aCreditCard at: 'expirationYear').
	creditCardExpirationMonth := GregorianMonth numbered: (aCreditCard at: 'expirationMonth').
	creditCardExpirationDate := GregorianMonthOfYear year: creditCardExpirationYear month: creditCardExpirationMonth.
	
	(aDate > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].! !

!methodRemoval: Cashier class #with: stamp: 'MR 11/2/2021 15:38:20'!
with: aCatalog
	^self new initializeWith: aCatalog. !

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:38:26'!
PASSED!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:38:26'!
PASSED!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 15:38:26'!
ERROR!

!testRun: #CashierTest #test12CannotCheckoutCartWithInvalidCreditCardName stamp: 'MR 11/2/2021 15:38:26'!
ERROR!

!testRun: #CashierTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/2/2021 15:38:26'!
ERROR!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:38:39' prior: 50924264!
test11CannotCheckoutCartWithExpiredCreditCard
	| cart expiredCreditCard salesBook |
	
	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	expiredCreditCard := testObjectsFactory createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	self 
		should: [Cashier toCheckout: cart withCreditCard: expiredCreditCard onDate: testObjectsFactory today registerAt: salesBook]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 15:38:41'!
PASSED!

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:38:41'!
PASSED!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:38:41'!
PASSED!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 15:38:41'!
PASSED!

!testRun: #CashierTest #test12CannotCheckoutCartWithInvalidCreditCardName stamp: 'MR 11/2/2021 15:38:41'!
ERROR!

!testRun: #CashierTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/2/2021 15:38:41'!
ERROR!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:38:56' prior: 50923887!
test12CannotCheckoutCartWithInvalidCreditCardName
	| cart cashier invalidCreditCard |
	
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	invalidCreditCard := testObjectsFactory createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	cashier := Cashier with: testObjectsFactory defaultCatalog.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:39:30' prior: 50924616!
test12CannotCheckoutCartWithInvalidCreditCardName
	| cart cashier invalidCreditCard salesBook |
	
	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	invalidCreditCard := testObjectsFactory createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	cashier := Cashier toCheckout: cart withCreditCard: invalidCreditCard onDate: testObjectsFactory today registerAt: salesBook.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:39:44' prior: 50924637!
test12CannotCheckoutCartWithInvalidCreditCardName
	| cart invalidCreditCard salesBook |
	
	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	invalidCreditCard := testObjectsFactory createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	self 
		should: [Cashier toCheckout: cart withCreditCard: invalidCreditCard onDate: testObjectsFactory today registerAt: salesBook]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!methodRemoval: CashierTest #test12CannotCheckoutCartWithInvalidCreditCardName stamp: 'MR 11/2/2021 15:41:24'!
test12CannotCheckoutCartWithInvalidCreditCardName
	| cart invalidCreditCard salesBook |
	
	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	invalidCreditCard := testObjectsFactory createCreditCard.
	invalidCreditCard at: 'name' put: ''.
	
	self 
		should: [Cashier toCheckout: cart withCreditCard: invalidCreditCard onDate: testObjectsFactory today registerAt: salesBook]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]!

!methodRemoval: CashierTest #test13CannotCheckoutCartWithInvalidCreditCardNumber stamp: 'MR 11/2/2021 15:41:31'!
test13CannotCheckoutCartWithInvalidCreditCardNumber
	| cart cashier invalidCreditCard |
	
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cashier := Cashier with: testObjectsFactory defaultCatalog.
	
	invalidCreditCard := testObjectsFactory createCreditCard.
	invalidCreditCard at: 'number' put: 'noSoyUnNumeroooo'.
	
	self 
		should: [cashier checkout: cart withCreditCard: invalidCreditCard]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:41:54'!
test12
	| cart expiredCreditCard salesBook |
	
	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	expiredCreditCard := testObjectsFactory createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:42:45' prior: 50924727!
test12
	| cart cashier creditCard salesBook |
	
	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	
	self assert: {} equals: salesBook.
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:42:54' prior: 50924739!
test12
	| cart cashier creditCard salesBook |
	
	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	cashier checkout.
	
	self assert: {} equals: salesBook.
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:50:12' prior: 50924756!
test12
	| cart cashier creditCard salesBook |
	
	salesBook := OrderedCollection new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	cashier checkout.
	
	self assert: 2 equals: (salesBook at: testObjectsFactory itemSellByTheStore).
	
! !

!testRun: #CashierTest #test12 stamp: 'MR 11/2/2021 15:50:15'!
ERROR!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:50:27' prior: 50924773!
test12
	| cart cashier creditCard salesBook |
	
	salesBook := Dictionary new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	cashier checkout.
	
	self assert: 2 equals: (salesBook at: testObjectsFactory itemSellByTheStore).
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:50:36' prior: 50924573!
test11CannotCheckoutCartWithExpiredCreditCard
	| cart expiredCreditCard salesBook |
	
	salesBook := Dictionary new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	expiredCreditCard := testObjectsFactory createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	self 
		should: [Cashier toCheckout: cart withCreditCard: expiredCreditCard onDate: testObjectsFactory today registerAt: salesBook]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:50:38' prior: 50924138!
test10CartCheckoutWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard salesBook |
	
	salesBook := Dictionary new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	
	self assert: 20 equals: (cashier checkout).! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:50:40' prior: 50924105!
test09CannotCheckoutEmptyCart
	| cart creditCard salesBook |

	salesBook := Dictionary new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createCreditCard.

	self
		should: [Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!testRun: #CashierTest #test12 stamp: 'MR 11/2/2021 15:50:42'!
ERROR!

!testRun: #CashierTest #test12 stamp: 'MR 11/2/2021 15:50:56'!
ERROR!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:51:40' prior: 50924419!
checkout
	^cart total.! !

!testRun: #CashierTest #test12 stamp: 'MR 11/2/2021 15:51:41'!
ERROR!

!methodRemoval: Cashier #checkout:withCreditCard: stamp: 'MR 11/2/2021 15:52:11'!
checkout: aCart withCreditCard: aCreditCard 
	
	self assertCreditCardExpirationDate: aCreditCard.
	self assertCreditCardName: aCreditCard.
	self assertCreditCardNumber: aCreditCard.

	^self checkout: aCart.!

!methodRemoval: Cashier #initializeWith: stamp: 'MR 11/2/2021 15:52:15'!
initializeWith: aCatalog

	catalog _ aCatalog.!

!methodRemoval: Cashier #assertCreditCardNumber stamp: 'MR 11/2/2021 15:52:17'!
assertCreditCardNumber

	| creditCardNumber |
	creditCardNumber _ (creditCard at: 'number').
	creditCardNumber isNumber ifFalse: [
		^self error: Cashier invalidCheckoutErrorMessage.
	]. !

!methodRemoval: Cashier #assertCreditCardName stamp: 'MR 11/2/2021 15:52:18'!
assertCreditCardName
	
	| creditCardName |
	creditCardName _ creditCard at: 'name'.
	
	(creditCardName = '') ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].!

!methodRemoval: Cashier #assertCreditCardExpirationDate stamp: 'MR 11/2/2021 15:52:18'!
assertCreditCardExpirationDate

	| creditCardExpirationDate creditCardExpirationMonth creditCardExpirationYear |
	
	creditCardExpirationYear := GregorianYear number: (creditCard at: 'expirationYear').
	creditCardExpirationMonth := GregorianMonth numbered: (creditCard at: 'expirationMonth').
	creditCardExpirationDate := GregorianMonthOfYear year: creditCardExpirationYear month: creditCardExpirationMonth.
	
	(date > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].!

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:52:23'!
PASSED!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:52:23'!
PASSED!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 15:52:23'!
PASSED!

!testRun: #CashierTest #test12 stamp: 'MR 11/2/2021 15:52:23'!
ERROR!

!testRun: #CashierTest #test12 stamp: 'MR 11/2/2021 15:52:23'!
ERROR!

!testRun: #CashierTest #test12 stamp: 'MR 11/2/2021 15:52:26'!
FAILURE!

!testRun: #CashierTest #test12 stamp: 'MR 11/2/2021 15:52:27'!
PASSED!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:52:44' prior: 50924875!
checkout
	^cart registerTotal: salesBook.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:52:53'!
registerTotal
	|value|

	value _ 0.
	items do: [:anItem |
		value _ value + catalog at: anItem.
	].

	^value.
	! !

!methodRemoval: Cart #total stamp: 'MR 11/2/2021 15:52:53'!
total
	|value|

	value _ 0.
	items do: [:anItem |
		value _ value + catalog at: anItem.
	].

	^value.
	!
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:53:05'!
registerTotal: aSalesBook
	|value|

	value _ 0.
	items do: [:anItem |
		value _ value + catalog at: anItem.
	].

	^value.
	! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:53:37' prior: 50924794!
test12
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	cashier checkout.
	
	self assert: 2 equals: (salesBook at: testObjectsFactory itemSellByTheStore).
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:53:41' prior: 50924813!
test11CannotCheckoutCartWithExpiredCreditCard
	| cart expiredCreditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	expiredCreditCard := testObjectsFactory createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	
	self 
		should: [Cashier toCheckout: cart withCreditCard: expiredCreditCard onDate: testObjectsFactory today registerAt: salesBook]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:53:43' prior: 50924835!
test10CartCheckoutWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	
	self assert: 20 equals: (cashier checkout).! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:53:45' prior: 50924853!
test09CannotCheckoutEmptyCart
	| cart creditCard salesBook |

	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createCreditCard.

	self
		should: [Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!methodRemoval: Cart #registerTotal stamp: 'MR 11/2/2021 15:53:52'!
registerTotal
	|value|

	value _ 0.
	items do: [:anItem |
		value _ value + catalog at: anItem.
	].

	^value.
	!
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 15:54:04' prior: 50924964!
registerTotal: aSalesBook
	|value|

	value _ 0.
	items do: [:anItem |
		value _ value + catalog at: anItem.
		aSalesBook add: anItem.
	].

	^value.
	! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/2/2021 15:54:07'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/2/2021 15:54:07'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/2/2021 15:54:07'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/2/2021 15:54:07'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/2/2021 15:54:07'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/2/2021 15:54:07'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/2/2021 15:54:07'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/2/2021 15:54:07'!
PASSED!

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:54:09'!
PASSED!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:54:09'!
PASSED!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 15:54:09'!
PASSED!

!testRun: #CashierTest #test12 stamp: 'MR 11/2/2021 15:54:09'!
ERROR!

!testRun: #CashierTest #test12 stamp: 'MR 11/2/2021 15:54:09'!
ERROR!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:55:03' prior: 50924971!
test12
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	cashier checkout.
	
	self assert: 2 equals: (salesBook occurrencesOf: testObjectsFactory itemSellByTheStore).
	
! !

!testRun: #CashierTest #test12 stamp: 'MR 11/2/2021 15:55:06'!
PASSED!

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 15:55:06'!
PASSED!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 15:55:06'!
PASSED!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 15:55:06'!
PASSED!

!testRun: #CashierTest #test12 stamp: 'MR 11/2/2021 15:55:06'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:55:27'!
test12CashierCheckoutAddsBooksToSalesBook
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	cashier checkout.
	
	self assert: 2 equals: (salesBook occurrencesOf: testObjectsFactory itemSellByTheStore).
	
! !

!methodRemoval: CashierTest #test12 stamp: 'MR 11/2/2021 15:55:27'!
test12
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	cashier checkout.
	
	self assert: 2 equals: (salesBook occurrencesOf: testObjectsFactory itemSellByTheStore).
	
!
!CartTest methodsFor: 'tests' stamp: 'MR 11/2/2021 15:57:09' prior: 50923670!
test02CanNotAddItemsThatDoNotBelongToStore

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self 
		should: [ cart add: testObjectsFactory itemNotSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty 
		]! !

----SNAPSHOT----(2 November 2021 15:57:20) CuisUniversity-4913.image priorSource: 18931052!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:05:08'!
test13
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	cashier checkout.
	
	self assert: 2 equals: (salesBook occurrencesOf: testObjectsFactory itemSellByTheStore).
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:05:39' prior: 50925186!
test13
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:06:35' prior: 50923591!
createCreditCard

	| creditCard |
	
	creditCard _ Dictionary new.
	
	creditCard 
		add: 'name' -> 'Mike Wazowsky';
		add: 'number' -> 4545565667677878;
		add: 'expirationMonth' -> 02;
		add: 'expirationYear' -> 2025.
		
	^creditCard.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:08:40' prior: 50924948!
checkout
	| total |
	total _ cart registerTotal: salesBook.
	
	
	
	^total.! !

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:08:55'!
FAILURE!

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:08:55'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:10:27' prior: 50925234!
checkout
	| total |
	total _ cart registerTotal: salesBook.
	
	self hablarConMerchantProcessor: total.
	
	^total.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:11:28'!
hablarConMerchantProcessor: aTransactionAmount.
	
	
	
	"API call a merchant processor .. ... . ."
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:11:44' prior: 50925250!
hablarConMerchantProcessor: aTransactionAmount.
	
	
	
	"API call a merchant processor .. ... . ."
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:12:28' prior: 50925257!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards |
	creditCards _ Dictionary new.
	
	creditCards add: 'name' -> 15.
	
		
	
	
	"API call a merchant processor .. ... . ."
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:13:05' prior: 50925264!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards |
	creditCards _ Dictionary new.
	
	creditCards add: 4545565667677878 -> 10.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	
		
	
	
	"API call a merchant processor .. ... . ."
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:13:10' prior: 50925273!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 10.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	
	
		
	
	
	"API call a merchant processor .. ... . ."
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:14:36' prior: 50925285!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 10.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	
	(creditCards at: (creditCard at: 'number') < aTransactionAmount ) ifTrue: [
		^'1|Credit card has no funds'.
	].		
	
	" todo ok "
	
	"API call a merchant processor .. ... . ."
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:14:46' prior: 50925297!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 10.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	
	(creditCards at: (creditCard at: 'number') < aTransactionAmount ) ifTrue: [
		^'1|Credit card has no funds'.
	].		
	
	^'0|OK'.
	
	"API call a merchant processor .. ... . ."
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:14:48' prior: 50925313!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 10.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	
	(creditCards at: (creditCard at: 'number') < aTransactionAmount ) ifTrue: [
		^'1|Credit card has no funds'.
	].		
	
	^'0|OK'.
	
	"API call a merchant processor .. ... . ."
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:16:06' prior: 50925244!
checkout
	| total result |
	
	result = ''.
	total _ cart registerTotal: salesBook.

	result = self hablarConMerchantProcessor: total.
	
	(result = '0|OK') ifTrue: [^total].
	
	^self error: Cashier invalidCheckoutErrorMessage.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:16:16' prior: 50925345!
checkout
	| total result |
	
	result _ ''.
	total _ cart registerTotal: salesBook.

	result = self hablarConMerchantProcessor: total.
	
	(result = '0|OK') ifTrue: [^total].
	
	^self error: Cashier invalidCheckoutErrorMessage.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:16:23' prior: 50925355!
checkout
	| total result |
	
	result _ ''.
	total _ cart registerTotal: salesBook.

	result _ self hablarConMerchantProcessor: total.
	
	(result = '0|OK') ifTrue: [^total].
	
	^self error: Cashier invalidCheckoutErrorMessage.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:16:34' prior: 50925329!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 10.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	
	(creditCards at: (creditCard at: 'number') < aTransactionAmount ) ifTrue: [
		^'1|Credit card has no funds'.
	].		
	
	^'0|OK'.
	
	
	
	
! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:16:54' prior: 50925223!
createCreditCard

	| creditCard |
	
	creditCard _ Dictionary new.
	
	creditCard 
		add: 'name' -> 'Mike Wazowsky';
		add: 'number' -> 4545565667677877;
		add: 'expirationMonth' -> 02;
		add: 'expirationYear' -> 2025.
		
	^creditCard.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:17:11' prior: 50925375!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 5.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	
	(creditCards at: (creditCard at: 'number') < aTransactionAmount ) ifTrue: [
		^'1|Credit card has no funds'.
	].		
	
	^'0|OK'.
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:17:19' prior: 50925401!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 10.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	
	(creditCards at: (creditCard at: 'number') < aTransactionAmount ) ifTrue: [
		^'1|Credit card has no funds'.
	].		
	
	^'0|OK'.
	
	
	
	
! !

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:17:32'!
FAILURE!

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:17:32'!
FAILURE!

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:17:48'!
FAILURE!

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:18:17'!
FAILURE!

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:19:07'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:20:07' prior: 50925416!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 10.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	
	(creditCards at: (creditCard at: 'number') < aTransactionAmount ) ifTrue: [
		^'1|Credit card has no funds'.
	].		
	
	^'0|OK'.
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:21:18' prior: 50925442!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 10.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	
	((creditCards at: (creditCard at: 'number')) < aTransactionAmount ) ifTrue: [
		^'1|Credit card has no funds'.
	].		
	
	^'0|OK'.
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:21:36' prior: 50925457!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 10.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	
	((creditCards at: (creditCard at: 'number')) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].		
	
	^'0|OK'.
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:22:08' prior: 50925472!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 10.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard at: 'number'.
	
	((creditCards at: creditCardNumber) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].		
	
	^'0|OK'.
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:22:15' prior: 50925487!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 10.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard at: 'number'.
	
	((creditCards at: creditCardNumber) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].		
	
	^'0|OK'.
	
	
	
	
! !

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 16:22:19'!
PASSED!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 16:22:19'!
ERROR!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 16:22:20'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/2/2021 16:22:20'!
ERROR!

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:22:20'!
PASSED!
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:22:41' prior: 50925390!
createCreditCard

	| creditCard |
	
	creditCard _ Dictionary new.
	
	creditCard 
		add: 'name' -> 'Mike Wazowsky';
		add: 'number' -> 4545565667677878;
		add: 'expirationMonth' -> 02;
		add: 'expirationYear' -> 2025.
		
	^creditCard.! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:23:09' prior: 50925203!
test13
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:23:12'!
PASSED!

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 16:23:12'!
PASSED!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 16:23:12'!
ERROR!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 16:23:12'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/2/2021 16:23:12'!
ERROR!

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:23:12'!
PASSED!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:23:39' prior: 50925503!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard at: 'number'.
	
	((creditCards at: creditCardNumber) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].		
	
	^'0|OK'.
	
	
	
	
! !

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 16:23:41'!
PASSED!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 16:23:41'!
PASSED!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 16:23:41'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/2/2021 16:23:41'!
PASSED!

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:23:41'!
PASSED!
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 16:29:05'!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook aClientName: aClientName  

	self assertIsNotExpired: aCreditCard on: aDate.
	self assertIsNotEmpty: aCart.

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook.! !

!methodRemoval: Cashier class #toCheckout:withCreditCard:onDate:registerAt: stamp: 'MR 11/2/2021 16:29:05'!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook 

	self assertIsNotExpired: aCreditCard on: aDate.
	self assertIsNotEmpty: aCart.

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook.!
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/2/2021 16:29:40'!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName  

	self assertIsNotExpired: aCreditCard on: aDate.
	self assertIsNotEmpty: aCart.

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName.! !

!methodRemoval: Cashier class #toCheckout:withCreditCard:onDate:registerAt:aClientName: stamp: 'MR 11/2/2021 16:29:42'!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook aClientName: aClientName  

	self assertIsNotExpired: aCreditCard on: aDate.
	self assertIsNotEmpty: aCart.

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook.!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'MR 11/2/2021 16:29:54'!
Object subclass: #Cashier
	instanceVariableNames: 'catalog cart creditCard date salesBook clientName'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier methodsFor: 'initialization' stamp: 'MR 11/2/2021 16:29:52'!
initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName 
	cart := aCart.
	creditCard := aCreditCard.
	date := aDate.
	salesBook := aSalesBook.
	clientName := aClientName.! !

!methodRemoval: Cashier #initializeToCheckout:withCreditCard:onDate:registerAt: stamp: 'MR 11/2/2021 16:29:56'!
initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook 
	cart := aCart.
	creditCard := aCreditCard.
	date := aDate.
	salesBook := aSalesBook.!
!Cashier methodsFor: 'initialization' stamp: 'MR 11/2/2021 16:30:09' prior: 50925673!
initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName 
	cart := aCart.
	creditCard := aCreditCard.
	date := aDate.
	salesBook := aSalesBook.
	clientName := aClientName.! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:30:41' prior: 50925029!
test09CannotCheckoutEmptyCart
	| cart creditCard salesBook clientName |

	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.

	self
		should: [Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook.]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:30:51' prior: 50925703!
test09CannotCheckoutEmptyCart
	| cart creditCard salesBook clientName |

	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.

	self
		should: [Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:31:08' prior: 50925011!
test10CartCheckoutWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self assert: 20 equals: (cashier checkout).! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:31:18' prior: 50924989!
test11CannotCheckoutCartWithExpiredCreditCard
	| cart expiredCreditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	expiredCreditCard := testObjectsFactory createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	clientName := expiredCreditCard at: 'name'.
	
	self 
		should: [Cashier toCheckout: cart withCreditCard: expiredCreditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:31:41' prior: 50925133!
test12CashierCheckoutAddsBooksToSalesBook
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	cashier checkout.
	
	self assert: 2 equals: (salesBook occurrencesOf: testObjectsFactory itemSellByTheStore).
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:31:50' prior: 50925545!
test13
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:31:52'!
PASSED!

!testRun: #CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 16:31:52'!
PASSED!

!testRun: #CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 16:31:52'!
PASSED!

!testRun: #CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 16:31:52'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/2/2021 16:31:52'!
PASSED!

!testRun: #CashierTest #test13 stamp: 'MR 11/2/2021 16:31:52'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:32:24'!
test14aSDASD
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:32:55'!
test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:33:03'!
test11CashierCannotCheckoutCartWithExpiredCreditCard
	| cart expiredCreditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	expiredCreditCard := testObjectsFactory createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	clientName := expiredCreditCard at: 'name'.
	
	self 
		should: [Cashier toCheckout: cart withCreditCard: expiredCreditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!methodRemoval: CashierTest #test11CannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 16:33:03'!
test11CannotCheckoutCartWithExpiredCreditCard
	| cart expiredCreditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	expiredCreditCard := testObjectsFactory createCreditCard.
	expiredCreditCard at: 'expirationYear' put: 2020.
	clientName := expiredCreditCard at: 'name'.
	
	self 
		should: [Cashier toCheckout: cart withCreditCard: expiredCreditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]!

!methodRemoval: CashierTest #test13 stamp: 'MR 11/2/2021 16:33:09'!
test13
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:33:17'!
test09CashierCannotCheckoutEmptyCart
	| cart creditCard salesBook clientName |

	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.

	self
		should: [Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !

!methodRemoval: CashierTest #test09CannotCheckoutEmptyCart stamp: 'MR 11/2/2021 16:33:17'!
test09CannotCheckoutEmptyCart
	| cart creditCard salesBook clientName |

	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.

	self
		should: [Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:33:29'!
test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self assert: 20 equals: (cashier checkout).! !

!methodRemoval: CashierTest #test10CartCheckoutWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 16:33:29'!
test10CartCheckoutWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self assert: 20 equals: (cashier checkout).!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:33:43'!
test14CashierNoSabemos
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !

!methodRemoval: CashierTest #test14aSDASD stamp: 'MR 11/2/2021 16:33:43'!
test14aSDASD
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:34:05' prior: 50926041!
test14CashierNoSabemos
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := 'Pepe'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/2/2021 16:36:11' prior: 50925583!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard at: 'number'.
	
	((creditCards at: creditCardNumber) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	((creditCard at: 'name') = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	
	^'0|OK'.
	
	
	
	
! !

!testRun: #CashierTest #test14CashierNoSabemos stamp: 'MR 11/2/2021 16:36:16'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/2/2021 16:36:16'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 16:36:16'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 16:36:16'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/2/2021 16:36:16'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/2/2021 16:36:16'!
PASSED!

!testRun: #CashierTest #test14CashierNoSabemos stamp: 'MR 11/2/2021 16:36:16'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:37:20'!
test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := 'Pepe'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !

!methodRemoval: CashierTest #test14CashierNoSabemos stamp: 'MR 11/2/2021 16:37:20'!
test14CashierNoSabemos
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := 'Pepe'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:38:00' prior: 50925869!
test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:38:06' prior: 50926151!
test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := 'Pepe'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/2/2021 16:38:25'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/2/2021 16:38:25'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 16:38:25'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 16:38:25'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/2/2021 16:38:25'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/2/2021 16:38:25'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/2/2021 16:38:25'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:38:41'!
test15Cashier
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:38:51' prior: 50926268!
test15Cashier
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !

!testRun: #CashierTest #test15Cashier stamp: 'MR 11/2/2021 16:38:55'!
FAILURE!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:39:45' prior: 50926289!
test15Cashier
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self assert: '' equals: cashier checkout.
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:40:00' prior: 50926313!
test15Cashier
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self assert: 10 equals: cashier checkout.
	
! !

!testRun: #CashierTest #test15Cashier stamp: 'MR 11/2/2021 16:40:01'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/2/2021 16:40:01'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/2/2021 16:40:01'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/2/2021 16:40:01'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/2/2021 16:40:01'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/2/2021 16:40:01'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/2/2021 16:40:01'!
PASSED!

!testRun: #CashierTest #test15Cashier stamp: 'MR 11/2/2021 16:40:01'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/2/2021 16:41:33'!
test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self assert: 10 equals: cashier checkout.
	
! !

!methodRemoval: CashierTest #test15Cashier stamp: 'MR 11/2/2021 16:41:33'!
test15Cashier
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self assert: 10 equals: cashier checkout.
	
!

----SNAPSHOT----(2 November 2021 16:46:08) CuisUniversity-4913.image priorSource: 18993048!

----STARTUP---- (4 November 2021 09:41:16) as C:\Users\migue\Desktop\CuisUniversity\CuisUniversity-4913.image!


Object subclass: #CreditCard
	instanceVariableNames: 'name number expirationMonth expirationYear'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'MR 11/4/2021 09:43:59'!
Object subclass: #CreditCard
	instanceVariableNames: 'name number expirationMonth expirationYear'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCard class methodsFor: 'nil' stamp: 'MR 11/4/2021 09:44:56'!
withName: aName number: aNumber expirationMonth: anExpirationMonth expirationYear: anExpirationYear
	^self new initializeWithName: aName number: aNumber expirationMonth: anExpirationMonth expirationYear: anExpirationYear.! !
!CreditCard methodsFor: 'nil' stamp: 'MR 11/4/2021 09:45:35'!
initializeWithName: aName number: aNumber expirationMonth: anExpirationMonth expirationYear: anExpirationYear
	name _ aName.
	number _ aNumber.
	expirationMonth _ anExpirationMonth.
	expirationYear _ anExpirationYear.! !
!CreditCard methodsFor: 'nil' stamp: 'MR 11/4/2021 09:45:47' overrides: 16882612!
name
	^name.! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:45:50'!
number
	^number.! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:45:58'!
expirationMonth
	^expirationMonth.! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:46:02'!
expirationYear
	^expirationYear.! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:46:40' prior: 50925535!
createCreditCard

	
	
	^CreditCard 
		withName: 'Mike Wazowsky'
		number:  4545565667677878
		expirationMonth: 02 
		expirationYear: 2025.! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:46:47' prior: 50926465!
createCreditCard

	^CreditCard 
		withName: 'Mike Wazowsky'
		number: 4545565667677878
		expirationMonth: 02
		expirationYear: 2025.! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:47:13' prior: 50925962!
test09CashierCannotCheckoutEmptyCart
	| cart creditCard salesBook clientName |

	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard name.

	self
		should: [Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:47:25' prior: 50926000!
test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createCreditCard.
	clientName := creditCard name.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self assert: 20 equals: (cashier checkout).! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:47:53' prior: 50925892!
test11CashierCannotCheckoutCartWithExpiredCreditCard
	| cart expiredCreditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	expiredCreditCard := testObjectsFactory createExpiredCreditCard.
	
	self 
		should: [Cashier toCheckout: cart withCreditCard: expiredCreditCard onDate: testObjectsFactory today registerAt: salesBook forClient: expiredCreditCard name]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:48:09'!
createExpiredCreditCard

	^CreditCard 
		withName: 'Mike Wazowsky'
		number: 4545565667677878
		expirationMonth: 02
		expirationYear: 2020.! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:48:17'!
createValidCreditCard

	^CreditCard 
		withName: 'Mike Wazowsky'
		number: 4545565667677878
		expirationMonth: 02
		expirationYear: 2025.! !

!methodRemoval: StoreTestObjectsFactory #createValidCreditCard stamp: 'MR 11/4/2021 09:48:22'!
createValidCreditCard

	^CreditCard 
		withName: 'Mike Wazowsky'
		number: 4545565667677878
		expirationMonth: 02
		expirationYear: 2025.!
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:48:32'!
createValidCreditCard

	^CreditCard 
		withName: 'Mike Wazowsky'
		number: 4545565667677878
		expirationMonth: 02
		expirationYear: 2025.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:48:32' prior: 50926375!
test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self assert: 10 equals: cashier checkout.
	
! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:48:32' prior: 50926196!
test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createValidCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:48:32' prior: 50926220!
test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.
	clientName := 'Pepe'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:48:32' prior: 50926499!
test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.
	clientName := creditCard name.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self assert: 20 equals: (cashier checkout).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:48:32' prior: 50926480!
test09CashierCannotCheckoutEmptyCart
	| cart creditCard salesBook clientName |

	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createValidCreditCard.
	clientName := creditCard name.

	self
		should: [Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:48:32' prior: 50925785!
test12CashierCheckoutAddsBooksToSalesBook
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.
	clientName := creditCard at: 'name'.
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	cashier checkout.
	
	self assert: 2 equals: (salesBook occurrencesOf: testObjectsFactory itemSellByTheStore).
	
! !

!methodRemoval: StoreTestObjectsFactory #createCreditCard stamp: 'MR 11/4/2021 09:48:32'!
createCreditCard

	^CreditCard 
		withName: 'Mike Wazowsky'
		number: 4545565667677878
		expirationMonth: 02
		expirationYear: 2025.!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:48:46' prior: 50926640!
test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.
	
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: creditCard name.
	
	self assert: 20 equals: (cashier checkout).! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:48:58' prior: 50926681!
test12CashierCheckoutAddsBooksToSalesBook
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.

	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: creditCard name.
	cashier checkout.
	
	self assert: 2 equals: (salesBook occurrencesOf: testObjectsFactory itemSellByTheStore).
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:49:06' prior: 50926592!
test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createValidCreditCard.

	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: creditCard name.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:49:28' prior: 50926617!
test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.
	clientName := 'Pepe'.
	
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:49:35' prior: 50926572!
test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.

	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: creditCard name.
	
	self assert: 10 equals: cashier checkout.
	
! !

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 09:49:39'!
ERROR!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:50:29' prior: 50926109!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard at: 'number'.
	
	((creditCards at: creditCardNumber) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(creditCard name = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	
	^'0|OK'.
	
	
	
	
! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:50:35' prior: 50926818!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard number.
	
	((creditCards at: creditCardNumber) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(creditCard name = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	
	^'0|OK'.
	
	
	
	
! !

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 09:50:39'!
ERROR!
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/4/2021 09:51:10' prior: 50924532!
assertIsNotExpired: aCreditCard on: aDate

	| creditCardExpirationDate creditCardExpirationMonth creditCardExpirationYear |
	
	creditCardExpirationYear := GregorianYear number: (aCreditCard expirationYear).
	creditCardExpirationMonth := GregorianMonth numbered: (aCreditCard expirationMonth).
	creditCardExpirationDate := GregorianMonthOfYear year: creditCardExpirationYear month: creditCardExpirationMonth.
	
	(aDate > creditCardExpirationDate) ifTrue: [
		^self error: Cashier invalidCheckoutErrorMessage 
	].! !

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 09:51:17'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 09:51:17'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 09:51:17'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 09:51:17'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 09:51:17'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 09:51:17'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 09:51:17'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 09:51:19'!
PASSED!

!classDefinition: #CashierTest category: 'TusLibros' stamp: 'MR 11/4/2021 09:53:51'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CashierTest methodsFor: 'setup' stamp: 'MR 11/4/2021 09:54:17' prior: 50923825 overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new.
	merchantProcessor := MerchantProcessorSimulator new.! !

TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CashierTest category: 'TusLibros' stamp: 'MR 11/4/2021 09:54:32'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

TestCase subclass: #MerchantProcessorSimulator
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #MerchantProcessorSimulator category: 'TusLibros' stamp: 'MR 11/4/2021 09:54:44'!
TestCase subclass: #MerchantProcessorSimulator
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/4/2021 09:56:10'!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName andMerchantProcessor: andMerchantProcessor   

	self assertIsNotExpired: aCreditCard on: aDate.
	self assertIsNotEmpty: aCart.

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:56:10' prior: 50926519!
test11CashierCannotCheckoutCartWithExpiredCreditCard
	| cart expiredCreditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	expiredCreditCard := testObjectsFactory createExpiredCreditCard.
	
	self 
		should: [Cashier toCheckout: cart withCreditCard: expiredCreditCard onDate: testObjectsFactory today registerAt: salesBook forClient: expiredCreditCard name andMerchantProcessor: aMerchantProcessor]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:56:10' prior: 50926710!
test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.
	
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: creditCard name andMerchantProcessor: aMerchantProcessor.
	
	self assert: 20 equals: (cashier checkout).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:56:10' prior: 50926729!
test12CashierCheckoutAddsBooksToSalesBook
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.

	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: creditCard name andMerchantProcessor: aMerchantProcessor.
	cashier checkout.
	
	self assert: 2 equals: (salesBook occurrencesOf: testObjectsFactory itemSellByTheStore).
	
! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:56:10' prior: 50926661!
test09CashierCannotCheckoutEmptyCart
	| cart creditCard salesBook clientName |

	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createValidCreditCard.
	clientName := creditCard name.

	self
		should: [Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName andMerchantProcessor: aMerchantProcessor]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:56:10' prior: 50926796!
test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.

	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: creditCard name andMerchantProcessor: aMerchantProcessor.
	
	self assert: 10 equals: cashier checkout.
	
! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:56:10' prior: 50926773!
test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.
	clientName := 'Pepe'.
	
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName andMerchantProcessor: aMerchantProcessor.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 09:56:10' prior: 50926750!
test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createValidCreditCard.

	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: creditCard name andMerchantProcessor: aMerchantProcessor.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !

!methodRemoval: Cashier class #toCheckout:withCreditCard:onDate:registerAt:forClient: stamp: 'MR 11/4/2021 09:56:10'!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName  

	self assertIsNotExpired: aCreditCard on: aDate.
	self assertIsNotEmpty: aCart.

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName.!
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/4/2021 09:56:19' prior: 50926996!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName andMerchantProcessor: aMerchantProcessor   

	self assertIsNotExpired: aCreditCard on: aDate.
	self assertIsNotEmpty: aCart.

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName.! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/4/2021 09:56:39' prior: 50927181!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName andMerchantProcessor: aMerchantProcessor   

	self assertIsNotExpired: aCreditCard on: aDate.
	self assertIsNotEmpty: aCart.

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName andMerchantProcessor: aMerchantProcessor.! !
!Cashier methodsFor: 'initialization' stamp: 'MR 11/4/2021 09:57:56'!
initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName aMerchantProcessor: andMerchantProcessor  
	cart := aCart.
	creditCard := aCreditCard.
	date := aDate.
	salesBook := aSalesBook.
	clientName := aClientName.! !

!methodRemoval: Cashier #initializeToCheckout:withCreditCard:onDate:registerAt:forClient: stamp: 'MR 11/4/2021 09:57:56'!
initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName 
	cart := aCart.
	creditCard := aCreditCard.
	date := aDate.
	salesBook := aSalesBook.
	clientName := aClientName.!
!Cashier methodsFor: 'initialization' stamp: 'MR 11/4/2021 09:58:06'!
initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName andMerchantProcessor: aMerchantProcessor  
	cart := aCart.
	creditCard := aCreditCard.
	date := aDate.
	salesBook := aSalesBook.
	clientName := aClientName.! !

!methodRemoval: Cashier #initializeToCheckout:withCreditCard:onDate:registerAt:forClient:aMerchantProcessor: stamp: 'MR 11/4/2021 09:58:08'!
initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName aMerchantProcessor: andMerchantProcessor  
	cart := aCart.
	creditCard := aCreditCard.
	date := aDate.
	salesBook := aSalesBook.
	clientName := aClientName.!
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:58:20' prior: 50927078!
test09CashierCannotCheckoutEmptyCart
	| cart creditCard salesBook clientName |

	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	creditCard := testObjectsFactory createValidCreditCard.
	clientName := creditCard name.

	self
		should: [Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName andMerchantProcessor: merchantProcessor]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:58:28' prior: 50927034!
test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.
	
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: creditCard name andMerchantProcessor: merchantProcessor.
	
	self assert: 20 equals: (cashier checkout).! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:58:48' prior: 50927011!
test11CashierCannotCheckoutCartWithExpiredCreditCard
	| cart expiredCreditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	expiredCreditCard := testObjectsFactory createExpiredCreditCard.
	
	self 
		should: [Cashier toCheckout: cart withCreditCard: expiredCreditCard onDate: testObjectsFactory today registerAt: salesBook forClient: expiredCreditCard name andMerchantProcessor: merchantProcessor]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		]! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:58:51' prior: 50927055!
test12CashierCheckoutAddsBooksToSalesBook
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.

	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: creditCard name andMerchantProcessor: merchantProcessor.
	cashier checkout.
	
	self assert: 2 equals: (salesBook occurrencesOf: testObjectsFactory itemSellByTheStore).
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:58:54' prior: 50927143!
test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	10 timesRepeat: [cart add: testObjectsFactory itemSellByTheStore.].
	
	creditCard := testObjectsFactory createValidCreditCard.

	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: creditCard name andMerchantProcessor: merchantProcessor.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:58:59' prior: 50927118!
test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner
	| cart cashier creditCard salesBook clientName |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.
	clientName := 'Pepe'.
	
	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: clientName andMerchantProcessor: merchantProcessor.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 09:59:03' prior: 50927099!
test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient
	| cart cashier creditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	creditCard := testObjectsFactory createValidCreditCard.

	cashier := Cashier toCheckout: cart withCreditCard: creditCard onDate: testObjectsFactory today registerAt: salesBook forClient: creditCard name andMerchantProcessor: merchantProcessor.
	
	self assert: 10 equals: cashier checkout.
	
! !

Object subclass: #Cashier
	instanceVariableNames: 'catalog cart creditCard date salesBook clientName merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'MR 11/4/2021 09:59:15'!
Object subclass: #Cashier
	instanceVariableNames: 'catalog cart creditCard date salesBook clientName merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier methodsFor: 'initialization' stamp: 'MR 11/4/2021 09:59:24' prior: 50927233!
initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName andMerchantProcessor: aMerchantProcessor  
	cart := aCart.
	creditCard := aCreditCard.
	date := aDate.
	salesBook := aSalesBook.
	clientName := aClientName.
	merchantProcessor := aMerchantProcessor.! !

!classDefinition: #MerchantProcessorSimulator category: 'TusLibros' stamp: 'MR 11/4/2021 10:00:23'!
TestCase subclass: #MerchantProcessorSimulator
	instanceVariableNames: 'creditCards'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!MerchantProcessorSimulator methodsFor: 'nil' stamp: 'MR 11/4/2021 10:00:21' overrides: 16896425!
initialize

	creditCards := Dictionary new.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:03:01' prior: 50925365!
checkout
	| total result |
	
	result _ ''.
	total _ cart registerTotal: salesBook.
	
	" if production ? "
	result _ merchantProcessor debit: total onCreditCard: creditCard.
	
	(result = '0|OK') ifTrue: [^total].
	
	^self error: Cashier invalidCheckoutErrorMessage.! !

!methodRemoval: Cashier #hablarConMerchantProcessor: stamp: 'MR 11/4/2021 10:03:10'!
hablarConMerchantProcessor: aTransactionAmount
	
	| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard number.
	
	((creditCards at: creditCardNumber) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(creditCard name = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	
	^'0|OK'.
	
	
	
	
!
!MerchantProcessorSimulator methodsFor: 'nil' stamp: 'MR 11/4/2021 10:03:59'!
debit: anAmount on: aCreditCard
	"| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard number.
	
	
	((creditCards at: aCreditCard number) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(creditCards name = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	"
	^'0|OK'.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:04:06' prior: 50927453!
checkout
	| total result |
	
	result _ ''.
	total _ cart registerTotal: salesBook.
	
	" if production ? "
	result _ merchantProcessor debit: total on: creditCard.
	
	(result = '0|OK') ifTrue: [^total].
	
	^self error: Cashier invalidCheckoutErrorMessage.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:04:11' prior: 50927500!
checkout
	| total result |
	
	result _ ''.
	total _ cart registerTotal: salesBook.
	
	result _ merchantProcessor debit: total on: creditCard. " if production ? "
	
	(result = '0|OK') ifTrue: [^total].
	
	^self error: Cashier invalidCheckoutErrorMessage.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:07:19' prior: 50927482!
debit: aTransactionAmount on: aCreditCard
	"| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard number.
	
	self assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	self assertIsNotStolen: aCreditCard.
	
	((creditCards at: aCreditCard number) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(creditCards name = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	"
	^'0|OK'.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:07:47' prior: 50927511!
checkout
	| total result |
	
	result _ ''.
	total _ cart registerTotal: salesBook.
	
	result _ merchantProcessor debit: total on: creditCard. " if production ? "
	
	(result = '0|OK') ifTrue: [^total].
	
	^self error: Cashier invalidCheckoutErrorMessage.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:08:43'!
debit: aTransactionAmount on: aCreditCard aClientName: andClientName 
	"| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard number.
	
	self assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	self assertIsNotStolen: aCreditCard.
	
	((creditCards at: aCreditCard number) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(creditCards name = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	"
	^'0|OK'.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:08:43' prior: 50927545!
checkout
	| total result |
	
	result _ ''.
	total _ cart registerTotal: salesBook.
	
	result _ merchantProcessor debit: total on: creditCard aClientName: clientName. " if production ? "
	
	(result = '0|OK') ifTrue: [^total].
	
	^self error: Cashier invalidCheckoutErrorMessage.! !

!methodRemoval: MerchantProcessorSimulator #debit:on: stamp: 'MR 11/4/2021 10:08:43'!
debit: aTransactionAmount on: aCreditCard
	"| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard number.
	
	self assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	self assertIsNotStolen: aCreditCard.
	
	((creditCards at: aCreditCard number) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(creditCards name = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	"
	^'0|OK'.!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:08:51'!
debit: aTransactionAmount on: aCreditCard andClientName: aClientName 
	"| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard number.
	
	self assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	self assertIsNotStolen: aCreditCard.
	
	((creditCards at: aCreditCard number) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(creditCards name = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	"
	^'0|OK'.! !

!methodRemoval: MerchantProcessorSimulator #debit:on:aClientName: stamp: 'MR 11/4/2021 10:08:57'!
debit: aTransactionAmount on: aCreditCard aClientName: andClientName 
	"| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard number.
	
	self assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	self assertIsNotStolen: aCreditCard.
	
	((creditCards at: aCreditCard number) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(creditCards name = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	"
	^'0|OK'.!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:09:13' prior: 50927579!
checkout
	| total result |
	
	result _ ''.
	total _ cart registerTotal: salesBook.
	
	result _ merchantProcessor debit: total on: creditCard andClientName: clientName. " if production ? "
	
	(result = '0|OK') ifTrue: [^total].
	
	^self error: Cashier invalidCheckoutErrorMessage.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:09:39'!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	"| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard number.
	
	self assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	self assertIsNotStolen: aCreditCard.
	
	((creditCards at: aCreditCard number) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(creditCards name = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	"
	^'0|OK'.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:09:39' prior: 50927657!
checkout
	| total result |
	
	result _ ''.
	total _ cart registerTotal: salesBook.
	
	result _ merchantProcessor debit: total on: creditCard forClient: clientName. " if production ? "
	
	(result = '0|OK') ifTrue: [^total].
	
	^self error: Cashier invalidCheckoutErrorMessage.! !

!methodRemoval: MerchantProcessorSimulator #debit:on:andClientName: stamp: 'MR 11/4/2021 10:09:39'!
debit: aTransactionAmount on: aCreditCard andClientName: aClientName 
	"| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard number.
	
	self assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	self assertIsNotStolen: aCreditCard.
	
	((creditCards at: aCreditCard number) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(creditCards name = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	"
	^'0|OK'.!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:11:16' prior: 50927669!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	"| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard number.
	"
	self assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	self assertIsNotStolen: aCreditCard usedBy: aClientName.
	"
	((creditCards at: aCreditCard number) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(creditCards name = clientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].
	"
	^'0|OK'.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:11:55'!
assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	((creditCards at: aCreditCard number) < aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:12:22'!
assertIsNotStolen: aCreditCard usedBy: aClientName.
	(creditCards name = aClientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:12:37' prior: 50927727!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	"| creditCards creditCardNumber |
	creditCards _ Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.
	creditCardNumber _ creditCard number.
	"
	self assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	self assertIsNotStolen: aCreditCard usedBy: aClientName.

	^'0|OK'.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:13:04' prior: 50927767!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 

	self assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	self assertIsNotStolen: aCreditCard usedBy: aClientName.

	^'0|OK'.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:13:22' prior: 50927448 overrides: 16896425!
initialize

	creditCards := Dictionary new.
	creditCards add: 4545565667677878 -> 50.
	creditCards add: 4545565667677879 -> 30.
	creditCards add: 4545565667677877 -> 0.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:13:27'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:13:27'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:13:27'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:13:27'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:13:27'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:13:27'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:13:27'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:13:27'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:13:27'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:13:27'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:13:27'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:13:27'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:13:27'!
FAILURE!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:13:27'!
FAILURE!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:13:27'!
PASSED!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:14:06' prior: 50927759!
assertIsNotStolen: aCreditCard usedBy: aClientName.
	(aCreditCard name = aClientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:14:20'!
FAILURE!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:14:20'!
FAILURE!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:14:20'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:14:26'!
FAILURE!

(creditCards at: aCreditCard number)!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:17:36' prior: 50927785!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	| result | 
	result _ '0|OK'.
	
	result _ self assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	result _ self assertIsNotStolen: aCreditCard usedBy: aClientName.

	^result.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:17:40'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:17:40'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:17:40'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:17:40'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:17:40'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:17:40'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:17:40'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:17:40'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:17:40'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:17:40'!
ERROR!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:17:40'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:17:40'!
ERROR!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:17:40'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:17:40'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:17:40'!
ERROR!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:18:13'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:18:13'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:18:13'!
ERROR!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:18:13'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:18:13'!
ERROR!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:18:13'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:18:13'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:18:13'!
ERROR!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:18:17'!
ERROR!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:18:24'!
ERROR!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:19:50' prior: 50927750!
assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	^(creditCards at: (aCreditCard number)) < aTransactionAmount.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:20:02' prior: 50927856!
assertIsNotStolen: aCreditCard usedBy: aClientName.
	^aCreditCard name = aClientName.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:20:43' prior: 50927921!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertHasEnoughFunds: aCreditCard for: aTransactionAmount) ifTrue: [
		
	].

	(self assertIsNotStolen: aCreditCard usedBy: aClientName) ifTrue: [
		
	].

	^'0|OK'.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:20:53' prior: 50928036!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertHasEnoughFunds: aCreditCard for: aTransactionAmount) ifTrue: [
		
	].

	(self assertIsNotStolen: aCreditCard usedBy: aClientName) ifTrue: [
		^'1|Client is not credit card owner'.
	].

	^'0|OK'.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:21:03' prior: 50928047!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertHasEnoughFunds: aCreditCard for: aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(self assertIsNotStolen: aCreditCard usedBy: aClientName) ifTrue: [
		^'1|Client is not credit card owner'.
	].

	^'0|OK'.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:21:07'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:21:07'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:21:07'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:21:07'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:21:07'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:21:07'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:21:07'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:21:07'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:21:07'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:21:07'!
ERROR!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:21:07'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:21:07'!
ERROR!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:21:07'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:21:07'!
FAILURE!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:21:07'!
ERROR!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:21:48' prior: 50928060!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertHasEnoughFunds: aCreditCard for: aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(self assertIsNotStolen: aCreditCard usedBy: aClientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].

	^'0|OK'.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:21:52' prior: 50928125!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertHasEnoughFunds: aCreditCard for: aTransactionAmount) ifFalse: [
		^'1|Credit card has no funds'.
	].

	(self assertIsNotStolen: aCreditCard usedBy: aClientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].

	^'0|OK'.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:21:53'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:21:53'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:21:53'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:21:53'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:21:53'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:21:53'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:21:53'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:21:53'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:21:53'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:21:53'!
ERROR!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:21:53'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:21:53'!
ERROR!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:21:53'!
FAILURE!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:21:53'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:21:53'!
ERROR!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:22:05' prior: 50928139!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertHasEnoughFunds: aCreditCard for: aTransactionAmount) ifTrue: [
		^'1|Credit card has no funds'.
	].

	(self assertIsNotStolen: aCreditCard usedBy: aClientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].

	^'0|OK'.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:22:08'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:22:08'!
PASSED!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:22:31' prior: 50928204!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertHasEnoughFunds: aCreditCard for: aTransactionAmount) ifFalse: [
		^'1|Credit card has no funds'.
	].

	(self assertIsNotStolen: aCreditCard usedBy: aClientName) ifFalse: [
		^'1|Client is not credit card owner'.
	].

	^'0|OK'.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:22:42' prior: 50928021!
assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	^(creditCards at: (aCreditCard number)) >= aTransactionAmount.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:22:47'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:22:47'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:22:47'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:22:47'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:22:47'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:22:47'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:22:48'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:22:48'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:22:48'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:22:48'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:22:48'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:22:48'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:22:48'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:22:48'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:22:48'!
PASSED!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:23:05' prior: 50928269!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertHasEnoughFunds: aCreditCard for: aTransactionAmount) ifFalse: [^'1|Credit card has no funds'.].
	(self assertIsNotStolen: aCreditCard usedBy: aClientName) ifFalse: [^'1|Client is not credit card owner'.].

	^'0|OK'.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:23:46'!
assertHasNotEnoughFunds: aCreditCard for: aTransactionAmount.
	^(creditCards at: (aCreditCard number)) >= aTransactionAmount.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:23:46' prior: 50928342!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertHasNotEnoughFunds: aCreditCard for: aTransactionAmount) ifFalse: [^'1|Credit card has no funds'.].
	(self assertIsNotStolen: aCreditCard usedBy: aClientName) ifFalse: [^'1|Client is not credit card owner'.].

	^'0|OK'.! !

!methodRemoval: MerchantProcessorSimulator #assertHasEnoughFunds:for: stamp: 'MR 11/4/2021 10:23:46'!
assertHasEnoughFunds: aCreditCard for: aTransactionAmount.
	^(creditCards at: (aCreditCard number)) >= aTransactionAmount.!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:23:56'!
assertIsStolen: aCreditCard usedBy: aClientName.
	^aCreditCard name = aClientName.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:23:56' prior: 50928363!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertHasNotEnoughFunds: aCreditCard for: aTransactionAmount) ifFalse: [^'1|Credit card has no funds'.].
	(self assertIsStolen: aCreditCard usedBy: aClientName) ifFalse: [^'1|Client is not credit card owner'.].

	^'0|OK'.! !

!methodRemoval: MerchantProcessorSimulator #assertIsNotStolen:usedBy: stamp: 'MR 11/4/2021 10:23:56'!
assertIsNotStolen: aCreditCard usedBy: aClientName.
	^aCreditCard name = aClientName.!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:24:06' prior: 50928390!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertHasNotEnoughFunds: aCreditCard for: aTransactionAmount) ifTrue: [^'1|Credit card has no funds'.].
	(self assertIsStolen: aCreditCard usedBy: aClientName) ifTrue: [^'1|Client is not credit card owner'.].

	^'0|OK'.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:24:17' prior: 50928355!
assertHasNotEnoughFunds: aCreditCard for: aTransactionAmount.
	^(creditCards at: (aCreditCard number)) < aTransactionAmount.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:24:26' prior: 50928383!
assertIsStolen: aCreditCard usedBy: aClientName.
	^aCreditCard name /= aClientName.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:24:30'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:24:30'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:24:30'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:24:30'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:24:30'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:24:30'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:24:30'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:24:30'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:24:30'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:24:30'!
ERROR!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:24:30'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:24:30'!
ERROR!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:24:30'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:24:30'!
ERROR!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:24:30'!
ERROR!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:24:40' prior: 50928430!
assertIsStolen: aCreditCard usedBy: aClientName.
	^(aCreditCard name = aClientName) not.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:24:42'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:24:42'!
PASSED!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:27:27' prior: 50928422!
assertHasNotEnoughFunds: aCreditCard for: aTransactionAmount.
	^(creditCards at: (aCreditCard)) < aTransactionAmount.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:28:07' prior: 50928546!
assertHasNotEnoughFunds: aCreditCard for: aTransactionAmount.
	^(creditCards at: (aCreditCard number)) < aTransactionAmount.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:29:10' prior: 50927796 overrides: 16896425!
initialize

	creditCards := Dictionary new.
	creditCards 
		add: 4545565667677878 -> 50;
	 	add: 4545565667677879 -> 30;
	 	add: 4545565667677877 -> 0.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:29:12' prior: 50928563 overrides: 16896425!
initialize

	creditCards := Dictionary new.
	
	creditCards 
		add: 4545565667677878 -> 50;
	 	add: 4545565667677879 -> 30;
	 	add: 4545565667677877 -> 0.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:30:51' prior: 50928488!
assertIsStolen: aCreditCard usedBy: aClientName.
	^(aCreditCard belongsTo: aClientName) not.! !
!CreditCard methodsFor: 'nil' stamp: 'MR 11/4/2021 10:31:18'!
belongsTo: aName

	^aName = name.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:31:20'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:31:20'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:31:20'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:31:20'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:31:20'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:31:21'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:31:21'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:31:21'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:31:21'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:31:21'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:31:21'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:31:21'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:31:21'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:31:21'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:31:21'!
PASSED!
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/4/2021 10:32:15' prior: 50926860!
assertIsNotExpired: aCreditCard on: aDate

	^aCreditCard isValidOn: aDate.! !

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'MR 11/4/2021 10:33:55'!
Object subclass: #CreditCard
	instanceVariableNames: 'name number expirationMonth expirationYear expirationDate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCard methodsFor: 'nil' stamp: 'MR 11/4/2021 10:33:54'!
isValidOn: aDate
	
	^aDate > expirationDate.! !
!CreditCard methodsFor: 'initialization' stamp: 'MR 11/4/2021 10:34:17' prior: 50926439!
initializeWithName: aName number: aNumber expirationMonth: anExpirationMonth expirationYear: anExpirationYear
	name _ aName.
	number _ aNumber.	
	expirationDate := GregorianMonthOfYear 
					year: (GregorianYear number: (anExpirationYear)) 
					month: (GregorianMonth numbered: (anExpirationMonth))! !

Object subclass: #CreditCard
	instanceVariableNames: 'name number expirationDate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'MR 11/4/2021 10:34:23'!
Object subclass: #CreditCard
	instanceVariableNames: 'name number expirationDate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:34:36'!
FAILURE!
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/4/2021 10:35:05' prior: 50924502!
assertIsNotEmpty: aCart

	aCart isEmpty ifTrue: [^self error: Cashier invalidCheckoutErrorMessage.].! !
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/4/2021 10:35:19' prior: 50928642!
assertIsNotExpired: aCreditCard on: aDate

	^(aCreditCard isValidOn: aDate) ifFalse: [^self error: Cashier invalidCheckoutErrorMessage].! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:35:20'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:35:20'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:35:20'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:35:20'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:35:20'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:35:20'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:35:20'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:35:20'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:35:20'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:35:20'!
ERROR!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:35:20'!
FAILURE!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:35:20'!
ERROR!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:35:20'!
ERROR!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:35:20'!
ERROR!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:35:20'!
ERROR!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:35:28'!
ERROR!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:35:58' prior: 50928655!
isValidOn: aDate
	
	^aDate < expirationDate.! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:36:09' prior: 50928759!
isValidOn: aDate
	
	^aDate <= expirationDate.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:36:15'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:36:16'!
PASSED!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:37:45' prior: 50928554!
assertHasNotEnoughFunds: aCreditCard for: aTransactionAmount.
	"self funds: aCreditCard"
	"check si tarjeta existe?"
	^(creditCards at: (aCreditCard number)) < aTransactionAmount.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:42:51' prior: 50928409!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertCardExists: aCreditCard) ifFalse: [^'1|Credit card does not exist'].
	(self assertCardHasEnoughFunds: aCreditCard for: aTransactionAmount) ifFalse: [^'1|Credit card has no funds'.].
	(self assertCardIsNotStolen: aCreditCard usedBy: aClientName) ifFalse: [^'1|Client is not credit card owner'.].

	^'0|OK'.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:43:01'!
assertIsNotStolen: aCreditCard usedBy: aClientName.
	^(aCreditCard belongsTo: aClientName) not.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:43:04' prior: 50928846!
assertIsNotStolen: aCreditCard usedBy: aClientName.
	^aCreditCard belongsTo: aClientName.! !

!methodRemoval: MerchantProcessorSimulator #assertIsStolen:usedBy: stamp: 'MR 11/4/2021 10:43:07'!
assertIsStolen: aCreditCard usedBy: aClientName.
	^(aCreditCard belongsTo: aClientName) not.!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:43:17'!
assertCardHasEnoughFunds: aCreditCard for: aTransactionAmount.
	"self funds: aCreditCard"
	"check si tarjeta existe?"
	^(creditCards at: (aCreditCard number)) >= aTransactionAmount.! !

!methodRemoval: MerchantProcessorSimulator #assertHasNotEnoughFunds:for: stamp: 'MR 11/4/2021 10:43:18'!
assertHasNotEnoughFunds: aCreditCard for: aTransactionAmount.
	"self funds: aCreditCard"
	"check si tarjeta existe?"
	^(creditCards at: (aCreditCard number)) < aTransactionAmount.!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:43:25' prior: 50928865!
assertCardHasEnoughFunds: aCreditCard for: aTransactionAmount.
	"self funds: aCreditCard"
	^(creditCards at: (aCreditCard number)) >= aTransactionAmount.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:43:34' prior: 50928830!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertCardExists: aCreditCard) ifFalse: [^'1|Credit card does not exist'].
	(self assertCardHasEnoughFunds: aCreditCard for: aTransactionAmount) ifFalse: [^'1|Credit card has no funds'.].
	(self assertCardIsNotStolen: aCreditCard usedBy: aClientName) ifFalse: [^'1|Client is not credit card owner'.].

	^'0|OK'.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:43:41'!
assertCardIsNotStolen: aCreditCard usedBy: aClientName.
	^aCreditCard belongsTo: aClientName.! !

!methodRemoval: MerchantProcessorSimulator #assertIsNotStolen:usedBy: stamp: 'MR 11/4/2021 10:43:41'!
assertIsNotStolen: aCreditCard usedBy: aClientName.
	^aCreditCard belongsTo: aClientName.!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:44:33'!
assertCardExists: aCreditCard
	^creditCards includesKey: (aCreditCard number).! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:44:36'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:44:36'!
PASSED!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:44:44' prior: 50928893!
debit: aTransactionAmount on: aCreditCard forClient: aClientName 
	
	(self assertCardExists: aCreditCard) ifFalse: [^'1|Credit card does not exist'].
	(self assertCardHasEnoughFunds: aCreditCard for: aTransactionAmount) ifFalse: [^'1|Credit card has no funds'].
	(self assertCardIsNotStolen: aCreditCard usedBy: aClientName) ifFalse: [^'1|Client is not credit card owner'].

	^'0|OK'.! !
!CashierTest methodsFor: 'tests' stamp: 'MR 11/4/2021 10:46:14'!
test16CashierCannotCheckoutWhenCreditCardDoesNotExist
	| cart cashier invalidCreditCard salesBook |
	
	salesBook := Bag new.
	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	
	invalidCreditCard := testObjectsFactory createInvalidCreditCard.
	
	cashier := Cashier toCheckout: cart withCreditCard: invalidCreditCard onDate: testObjectsFactory today registerAt: salesBook forClient: invalidCreditCard name andMerchantProcessor: merchantProcessor.
	
	self 
		should: [cashier checkout]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier invalidCheckoutErrorMessage.
		].
	
! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:46:25'!
createInvalidCreditCard

	^CreditCard 
		withName: 'Mike Wazowsky'
		number: 4545565667677810
		expirationMonth: 02
		expirationYear: 2020.! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:46:28' prior: 50929020!
createInvalidCreditCard

	^CreditCard 
		withName: 'Mike Wazowsky'
		number: 4545565667677810
		expirationMonth: 02
		expirationYear: 2025.! !

!testRun: #CashierTest #test16CashierCannotCheckoutWhenCreditCardDoesNotExist stamp: 'MR 11/4/2021 10:46:35'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:46:35'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:46:35'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:46:35'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:46:35'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:46:35'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:46:35'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:46:35'!
PASSED!

!testRun: #CashierTest #test16CashierCannotCheckoutWhenCreditCardDoesNotExist stamp: 'MR 11/4/2021 10:46:35'!
PASSED!
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/4/2021 10:48:41'!
assertCartIsNotEmpty: aCart

	aCart isEmpty ifTrue: [^self error: Cashier invalidCheckoutErrorMessage.].! !
!Cashier class methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:48:41' prior: 50927196!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName andMerchantProcessor: aMerchantProcessor   

	self assertIsNotExpired: aCreditCard on: aDate.
	self assertCartIsNotEmpty: aCart.

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName andMerchantProcessor: aMerchantProcessor.! !

!methodRemoval: Cashier class #assertIsNotEmpty: stamp: 'MR 11/4/2021 10:48:41'!
assertIsNotEmpty: aCart

	aCart isEmpty ifTrue: [^self error: Cashier invalidCheckoutErrorMessage.].!
!Cashier class methodsFor: 'instance creation' stamp: 'MR 11/4/2021 10:48:50'!
assertCardIsNotExpired: aCreditCard on: aDate

	^(aCreditCard isValidOn: aDate) ifFalse: [^self error: Cashier invalidCheckoutErrorMessage].! !
!Cashier class methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:48:50' prior: 50929076!
toCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName andMerchantProcessor: aMerchantProcessor   

	self assertCardIsNotExpired: aCreditCard on: aDate.
	self assertCartIsNotEmpty: aCart.

	^self new initializeToCheckout: aCart withCreditCard: aCreditCard onDate: aDate registerAt: aSalesBook forClient: aClientName andMerchantProcessor: aMerchantProcessor.! !

!methodRemoval: Cashier class #assertIsNotExpired:on: stamp: 'MR 11/4/2021 10:48:50'!
assertIsNotExpired: aCreditCard on: aDate

	^(aCreditCard isValidOn: aDate) ifFalse: [^self error: Cashier invalidCheckoutErrorMessage].!
!Cashier methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:49:53' prior: 50927692!
checkout
	| total result |
	total _ 0.
	result _ ''.
	
	total _ cart registerTotal: salesBook.
	result _ merchantProcessor debit: total on: creditCard forClient: clientName. " if production ? "
	
	(result = '0|OK') ifTrue: [^total].
	^self error: Cashier invalidCheckoutErrorMessage.! !

!methodRemoval: Cart #checkout stamp: 'MR 11/4/2021 10:51:40'!
checkout
	|value|
	
	self isEmpty ifTrue: [	^self error: Cart invalidCheckoutErrorMessage].
	
	value _ 0.
	items do: [:anItem |
		value _ value + catalog at: anItem.
	].

	^value.
	!
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:54:38' prior: 50925052!
registerTotal: aSalesBook
	aSalesBook addAll: items.
	
	^items inject: 0 into: [:itemsTotal :anItem | itemsTotal + catalog at: anItem].
	! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'MR 11/4/2021 10:54:42'!
PASSED!

!testRun: #CashierTest #test16CashierCannotCheckoutWhenCreditCardDoesNotExist stamp: 'MR 11/4/2021 10:54:42'!
PASSED!
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:54:54' prior: 50929148!
registerTotal: aSalesBook
	aSalesBook addAll: items.
	
	^items inject: 0 into: [:booksTotal :anItem | booksTotal + catalog at: anItem].
	! !
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:55:07' prior: 50929210!
registerTotal: aSalesBook
	aSalesBook addAll: items.
	
	^items inject: 0 into: [:itemsTotal :anItem | itemsTotal + catalog at: anItem].
	! !
!Cashier methodsFor: 'checkout' stamp: 'MR 11/4/2021 10:57:39' prior: 50929128!
checkout
	| price result |
	price _ 0.
	result _ ''.
	
	cart registerItemsOn: salesBook.
	price _ cart calculatePrice.
	result _ merchantProcessor debit: price on: creditCard forClient: clientName. " if production ? "
	
	(result = '0|OK') ifTrue: [^price].
	^self error: Cashier invalidCheckoutErrorMessage.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:57:52'!
registerItemsOn: aSalesBook
	aSalesBook addAll: items.
	
	^items inject: 0 into: [:itemsTotal :anItem | itemsTotal + catalog at: anItem].
	! !
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:57:58'!
calculatePrice
	^items inject: 0 into: [:itemsTotal :anItem | itemsTotal + catalog at: anItem].
	! !

!methodRemoval: Cart #registerTotal: stamp: 'MR 11/4/2021 10:57:59'!
registerTotal: aSalesBook
	aSalesBook addAll: items.
	
	^items inject: 0 into: [:itemsTotal :anItem | itemsTotal + catalog at: anItem].
	!
!Cart methodsFor: 'as yet unclassified' stamp: 'MR 11/4/2021 10:58:02' prior: 50929237!
registerItemsOn: aSalesBook
	aSalesBook addAll: items.
	! !
!Cashier methodsFor: 'checkout' stamp: 'MR 11/4/2021 10:59:03' prior: 50929225!
checkout
	| price result |
		
	cart registerItemsOn: salesBook.
	
	price _ cart calculatePrice.
	result _ merchantProcessor debit: price on: creditCard forClient: clientName. " if production ? "
	
	(result = '0|OK') ifTrue: [^price].
	^self error: Cashier invalidCheckoutErrorMessage.! !
!Cashier methodsFor: 'checkout' stamp: 'MR 11/4/2021 11:00:19' prior: 50929262!
checkout
	| price result |
		
	cart registerItemsOn: salesBook.
	
	price _ cart calculatePrice.
	result _ merchantProcessor debit: price on: creditCard forClient: clientName.
	
	(result = '0|OK') ifTrue: [^price].
	^self error: Cashier invalidCheckoutErrorMessage.! !

!methodRemoval: CreditCard #expirationMonth stamp: 'MR 11/4/2021 11:00:38'!
expirationMonth
	^expirationMonth.!

!methodRemoval: CreditCard #expirationYear stamp: 'MR 11/4/2021 11:00:39'!
expirationYear
	^expirationYear.!
!MerchantProcessorSimulator methodsFor: 'asserting' stamp: 'MR 11/4/2021 11:02:10' prior: 50928884!
assertCardHasEnoughFunds: aCreditCard for: aTransactionAmount.
	^(creditCards at: (aCreditCard number)) >= aTransactionAmount.! !

----SNAPSHOT----(4 November 2021 11:14:37) CuisUniversity-4913.image priorSource: 19032311!

----STARTUP---- (4 November 2021 11:15:57) as C:\Users\Guido\Desktop\20 - TusLibros\CuisUniversity-4913.image!


!classRemoval: #CashierTest stamp: 'GRC 11/4/2021 11:16:05'!
Object subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'GRC 11/4/2021 11:16:06'!
Object subclass: #Cashier
	instanceVariableNames: 'catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'GRC 11/4/2021 11:16:06'!
Object subclass: #CartTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'GRC 11/4/2021 11:16:07'!
Object subclass: #Cart
	instanceVariableNames: 'catalog items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of \Users\Guido\Desktop\20 - TusLibros\TusLibros.st----!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'GRC 11/4/2021 11:16:59'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'GRC 11/4/2021 11:17:00'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'GRC 11/4/2021 11:17:00'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'GRC 11/4/2021 11:17:00'!
PASSED!

!testRun: #CashierTest #test16CashierCannotCheckoutWhenCreditCardDoesNotExist stamp: 'GRC 11/4/2021 11:17:00'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CashierTest #test09CashierCannotCheckoutEmptyCart stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CashierTest #test10CashierCheckoutCartWithMultipleItemsHasCorrectPrice stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CashierTest #test11CashierCannotCheckoutCartWithExpiredCreditCard stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CashierTest #test12CashierCheckoutAddsBooksToSalesBook stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CashierTest #test13CashierCannotCheckoutWhenCreditCardHasNotEnoughFunds stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CashierTest #test14CashierCannotCheckoutWhenClientIsNotCreditCardOwner stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CashierTest #test15CashierCheckoutsCorrectlyWithValidCreditCardAndClient stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

!testRun: #CashierTest #test16CashierCannotCheckoutWhenCreditCardDoesNotExist stamp: 'GRC 11/4/2021 11:17:03'!
PASSED!

----QUIT----(4 November 2021 11:17:13) CuisUniversity-4913.image priorSource: 18675394!

----STARTUP---- (4 November 2021 19:48:11) as C:\Users\Guido\Desktop\20 - TusLibros\CuisUniversity-4913.image!


!classRemoval: #StoreTestObjectsFactory stamp: 'GRC 11/4/2021 19:50:07'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'GRC 11/4/2021 19:50:07'!
Object subclass: #CreditCard
	instanceVariableNames: 'name number expirationDate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'GRC 11/4/2021 19:50:08'!
Object subclass: #Cashier
	instanceVariableNames: 'catalog cart creditCard date salesBook clientName merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'GRC 11/4/2021 19:50:08'!
Object subclass: #Cart
	instanceVariableNames: 'catalog items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #MerchantProcessorSimulator stamp: 'GRC 11/4/2021 19:50:09'!
TestCase subclass: #MerchantProcessorSimulator
	instanceVariableNames: 'creditCards'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'GRC 11/4/2021 19:50:09'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'GRC 11/4/2021 19:50:10'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of \Users\Guido\Desktop\20 - TusLibros\TusLibros.st----!

TestCase subclass: #TusLibrosInterfaceTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosInterfaceTest category: 'TusLibros' stamp: 'GRC 11/4/2021 19:54:08'!
TestCase subclass: #TusLibrosInterfaceTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterfaceTest methodsFor: 'no messages' stamp: 'GRC 11/4/2021 19:54:24'!
test01

	! !

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'GRC 11/4/2021 19:57:01'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 19:56:53' prior: 50916671!
test01

	| interface |
	interface _ TusLibrosInterface authenticatingWith: self.

	self 
		should: [ | invalidUser password |interface createCartFor: invalidUser with: password]
		raise: Error
		withMessageText: [:anError | anError messageText = 'invalid username or password'].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 19:58:09' prior: 50916682!
test01

	| interface invalidUser password |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	

	self 
		should: [interface createCartFor: invalidUser with: password]
		raise: Error
		withMessageText: [:anError | anError messageText = 'invalid username or password'].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 19:59:18' prior: 50916695!
test01

	| interface invalidUser password |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	
	self 
		should: [interface createCartFor: invalidUser with: password]
		raise: Error
		withMessageText: [:anError | anError messageText = 'invalid username or password'].! !

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 19:59:26'!
ERROR!
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 19:59:37'!
authenticatingWith: aTusLibrosInterfaceTest 
	self shouldBeImplemented.! !

!classDefinition: 'TusLibrosInterface class' category: 'TusLibros' stamp: 'GRC 11/4/2021 20:00:21'!
TusLibrosInterface class
	instanceVariableNames: 'authenticationSystem'!
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:00:19' prior: 50916723!
authenticatingWith: anAuthenticationSystem
	
	authenticationSystem _ anAuthenticationSystem.! !

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:00:23'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:00:43'!
ERROR!
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:01:51' prior: 50916735!
authenticatingWith: anAuthenticationSystem
	
	^self new initializeAutenticatingWith: anAuthenticationSystem.! !

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'GRC 11/4/2021 20:02:30'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'authenticationSystem'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'no messages' stamp: 'GRC 11/4/2021 20:02:29'!
initializeAuthenticatingWith: anAuthenticationSystem

	authenticationSystem _ anAuthenticationSystem. ! !

TusLibrosInterface class
	instanceVariableNames: ''!

!classDefinition: 'TusLibrosInterface class' category: 'TusLibros' stamp: 'GRC 11/4/2021 20:02:37'!
TusLibrosInterface class
	instanceVariableNames: ''!

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:02:46'!
ERROR!
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:03:03' prior: 50916747!
authenticatingWith: anAuthenticationSystem
	
	^self new initializeAuthenticatingWith: anAuthenticationSystem.! !

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:03:07'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:04:02' prior: 50916708!
test01

	| interface invalidUser password |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	
	self 
		should: [interface createCartFor: invalidUser with: password]
		raise: Error - MessageNotUnderstood 
		withMessageText: [:anError | anError messageText = 'invalid username or password'].! !

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:04:07'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:04:12'!
createCartFor: anUndefinedObject with: anUndefinedObject2 
	self shouldBeImplemented.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:06:07' prior: 50916802!
createCartFor: aUsername with: aPassword

	authenticationSystem login: aUsername with: aPassword.! !

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:06:09'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:06:14'!
login: anUndefinedObject with: anUndefinedObject2 
	self shouldBeImplemented.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:07:13' prior: 50916817!
login: aUsername with: aPassword
	
	^self error: TusLibrosInterface invalidLoginErrorMessage.! !

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:07:18'!
ERROR!
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:07:23'!
invalidLoginErrorMessage
	self shouldBeImplemented.! !
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:07:35' prior: 50916832!
invalidLoginErrorMessage
	
	^'invalid username or password'.! !

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:07:36'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:08:22' prior: 50916787!
test01

	| interface invalidUser password |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	invalidUser _ 'Ryan'.
	password _ 'rugby2021'.
	
	self 
		should: [interface createCartFor: invalidUser with: password]
		raise: Error - MessageNotUnderstood 
		withMessageText: [:anError | anError messageText = 'invalid username or password'].! !

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:08:23'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:09:46' prior: 50916846!
test01

	| interface invalidUser password |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	invalidUser _ 'Ryan'.
	password _ 'rugby2021'.
	
	self 
		should: [interface createCartFor: invalidUser with: password]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: anError messageText = TusLibrosInterface invalidLoginErrorMessage].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:10:23' prior: 50916863!
test01

	| interface invalidUser password |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	invalidUser _ 'Ryan'.
	password _ 'rugby2021'.
	
	self 
		should: [interface createCartFor: invalidUser with: password]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:10:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:10:24'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:10:57'!
test02

	| interface validUser password |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser _ 'Ryan'.
	password _ 'rugby2021'.
	
	self 
		should: [interface createCartFor: validUser with: password]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:15:13' prior: 50916900!
test02

	| interface validUser password cartContents cartId |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser _ 'Ryan'.
	password _ 'rugby2021'.
	
	cartId _ interface createCartFor: validUser with: password.
	cartContents _ interface listCart: cartId.
	
	self assert: 1 equals: cartId.
	self assert: cartContents isEmpty. ! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:15:43' prior: 50916916!
test02

	| interface validUser password cartContents cartId |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser _ 'Guido'.
	password _ 'juancho'.
	
	cartId _ interface createCartFor: validUser with: password.
	cartContents _ interface listCart: cartId.
	
	self assert: 1 equals: cartId.
	self assert: cartContents isEmpty. ! !

!testRun: #TusLibrosInterfaceTest #test02 stamp: 'GRC 11/4/2021 20:15:48'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:18:31' prior: 50916823!
login: aUsername with: aPassword
	
	aUsername = 'Ryan' ifTrue: [^self error: TusLibrosInterface invalidLoginErrorMessage.].
	
	! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:19:20' prior: 50916808!
createCartFor: aUsername with: aPassword

	authenticationSystem login: aUsername with: aPassword.
	
	^Cart! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:19:57' prior: 50916956!
createCartFor: aUsername with: aPassword

	authenticationSystem login: aUsername with: aPassword.
	
	^1.! !

!testRun: #TusLibrosInterfaceTest #test02 stamp: 'GRC 11/4/2021 20:20:04'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:20:09'!
listCart: aSmallInteger 
	self shouldBeImplemented.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:20:54' prior: 50916972!
listCart: aCartId 
	
	^OrderedCollection new.! !

!testRun: #TusLibrosInterfaceTest #test02 stamp: 'GRC 11/4/2021 20:20:55'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:20:55'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02 stamp: 'GRC 11/4/2021 20:20:55'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:24:12'!
test03

	| interface validUser1 password cartContents cart1Id cart2Id validUser2 |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser1 _ 'Guido'.
	validUser2 _ 'Migue'.
	password _ 'juancho'.
	
	cart1Id _ interface createCartFor: validUser1 with: password.
	cart2Id _ interface createCartFor: validUser1 with: password.
	cartContents _ interface listCart: cart1Id.
	
	self assert: 1 equals: cart1Id.
	self assert: cartContents isEmpty. ! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:24:54' prior: 50916990!
test03

	| interface validUser1 password cart1Id cart2Id validUser2 |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser1 _ 'Guido'.
	validUser2 _ 'Migue'.
	password _ 'juancho'.
	
	cart1Id _ interface createCartFor: validUser1 with: password.
	cart2Id _ interface createCartFor: validUser2 with: password.
	
	self assert: 1 equals: cart1Id.
	self assert: 2 equals: cart2Id.! !

!testRun: #TusLibrosInterfaceTest #test03 stamp: 'GRC 11/4/2021 20:25:05'!
FAILURE!

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'GRC 11/4/2021 20:26:39'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'authenticationSystem nextCartId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:26:38' prior: 50916963!
createCartFor: aUsername with: aPassword

	authenticationSystem login: aUsername with: aPassword.
	
	^nextCartId + 1.! !

!testRun: #TusLibrosInterfaceTest #test03 stamp: 'GRC 11/4/2021 20:26:41'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:26:52' prior: 50916761!
initializeAuthenticatingWith: anAuthenticationSystem

	authenticationSystem _ anAuthenticationSystem. 
	nextCartId _ 0.! !

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02 stamp: 'GRC 11/4/2021 20:26:54'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03 stamp: 'GRC 11/4/2021 20:26:54'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test03 stamp: 'GRC 11/4/2021 20:26:54'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test03 stamp: 'GRC 11/4/2021 20:27:05'!
FAILURE!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:27:41' prior: 50917035!
createCartFor: aUsername with: aPassword

	authenticationSystem login: aUsername with: aPassword.
	
	^nextCartId _ nextCartId + 1.! !

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:27:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02 stamp: 'GRC 11/4/2021 20:27:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03 stamp: 'GRC 11/4/2021 20:27:43'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:28:49'!
test04

	| interface validUser1 password cart1Id cartContents validUser |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser _ 'Guido'.
	password _ 'juancho'.
	
	cart1Id _ interface createCartFor: validUser1 with: password.
	cartContents _ interface listCart: cart1Id.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:29:06' prior: 50917081!
test04

	| interface password cart1Id cartContents validUser |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser _ 'Guido'.
	password _ 'juancho'.
	
	cart1Id _ interface createCartFor: validUser with: password.
	cartContents _ interface listCart: cart1Id.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:29:22' prior: 50917094!
test04

	| interface password cartId cartContents validUser |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser _ 'Guido'.
	password _ 'juancho'.
	
	cartId _ interface createCartFor: validUser with: password.
	cartContents _ interface listCart: cartId.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:31:10' prior: 50917107!
test04

	| interface password cartId cartContents validUser bookIsbn |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser _ 'Guido'.
	password _ 'juancho'.
	bookIsbn _ StoreTestObjectsFactory.
	
	cartId _ interface createCartFor: validUser with: password.
	interface addToCart: cartId item: bookIsbn amount: 1.
	
	cartContents _ interface listCart: cartId.! !

!classDefinition: #TusLibrosInterfaceTest category: 'TusLibros' stamp: 'GRC 11/4/2021 20:31:32'!
TestCase subclass: #TusLibrosInterfaceTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:31:31' overrides: 16927572!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:31:48' prior: 50917119!
test04

	| interface password cartId cartContents validUser bookIsbn |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser _ 'Guido'.
	password _ 'juancho'.
	bookIsbn _ 
	
	cartId _ interface createCartFor: validUser with: password.
	interface addToCart: cartId item: bookIsbn amount: 1.
	
	cartContents _ interface listCart: cartId.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:32:13' prior: 50917149!
test04

	| interface password cartId cartContents validUser bookIsbn |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser _ 'Guido'.
	password _ 'juancho'.
	bookIsbn _ testObjectsFactory.
	
	cartId _ interface createCartFor: validUser with: password.
	interface addToCart: cartId item: bookIsbn amount: 1.
	
	cartContents _ interface listCart: cartId.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:32:41' prior: 50917164!
test04

	| interface password cartId cartContents validUser bookIsbn |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser _ 'Guido'.
	password _ 'juancho'.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: validUser with: password.
	interface addToCart: cartId item: bookIsbn amount: 1.
	
	cartContents _ interface listCart: cartId.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:33:38' prior: 50917180!
test04

	| interface password cartId cartContents validUser bookIsbn |
	
	interface _ TusLibrosInterface authenticatingWith: self.
	validUser _ 'Guido'.
	password _ 'juancho'.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: validUser with: password.
	interface addToCart: cartId item: bookIsbn amount: 1.
	
	cartContents _ interface listCart: cartId.
	
	self assert: bookIsbn equals: cartContents first.
	self assert: 1 equals: cartContents size.! !

!testRun: #TusLibrosInterfaceTest #test04 stamp: 'GRC 11/4/2021 20:33:40'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:33:45'!
addToCart: aSmallInteger item: aString amount: aSmallInteger3 
	self shouldBeImplemented.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:34:30' prior: 50917217!
addToCart: aCartId item: anItem amount: anAmount
	
	! !

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'GRC 11/4/2021 20:36:33'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'authenticationSystem nextCartId catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:36:31' prior: 50917066!
createCartFor: aUsername with: aPassword

	| cart |
	authenticationSystem login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	^nextCartId _ nextCartId + 1.! !

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'GRC 11/4/2021 20:38:19'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'authenticationSystem nextCartId catalogue carts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:38:17' prior: 50917238!
createCartFor: aUsername with: aPassword

	| cart |
	authenticationSystem login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	carts add: nextCartId -> cart.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:39:33'!
initializeAuthenticatingWith: anAuthenticationSystem withCatalogue: aCatalogue

	authenticationSystem _ anAuthenticationSystem. 
	nextCartId _ 0.
	carts _ Dictionary new.
	catalogue _ aCatalogue.! !

!methodRemoval: TusLibrosInterface #initializeAuthenticatingWith: stamp: 'GRC 11/4/2021 20:46:11'!
initializeAuthenticatingWith: anAuthenticationSystem

	authenticationSystem _ anAuthenticationSystem. 
	nextCartId _ 0.!
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:46:45'!
authenticatingWith: anAuthenticationSystem withCatalogue: aCatalog.
	
	^self new initializeAuthenticatingWith: anAuthenticationSystem withCatalogue: aCatalog.! !

!methodRemoval: TusLibrosInterface class #authenticatingWith: stamp: 'GRC 11/4/2021 20:46:49'!
authenticatingWith: anAuthenticationSystem
	
	^self new initializeAuthenticatingWith: anAuthenticationSystem.!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:47:23' prior: 50916879!
test01

	| interface invalidUser password catalogue |
	
	catalogue _ testObjectsFactory.
	interface _ TusLibrosInterface authenticatingWith: self.
	invalidUser _ 'Ryan'.
	password _ 'rugby2021'.
	
	self 
		should: [interface createCartFor: invalidUser with: password]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:47:58' prior: 50917299!
test01

	| interface invalidUser password catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	invalidUser _ 'Ryan'.
	password _ 'rugby2021'.
	
	self 
		should: [interface createCartFor: invalidUser with: password]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:48:49' prior: 50916931!
test02

	| interface validUser password cartContents cartId catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	validUser _ 'Guido'.
	password _ 'juancho'.
	
	cartId _ interface createCartFor: validUser with: password.
	cartContents _ interface listCart: cartId.
	
	self assert: 1 equals: cartId.
	self assert: cartContents isEmpty. ! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:49:17' prior: 50917008!
test03

	| interface validUser1 password cart1Id cart2Id validUser2 catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	validUser1 _ 'Guido'.
	validUser2 _ 'Migue'.
	password _ 'juancho'.
	
	cart1Id _ interface createCartFor: validUser1 with: password.
	cart2Id _ interface createCartFor: validUser2 with: password.
	
	self assert: 1 equals: cart1Id.
	self assert: 2 equals: cart2Id.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:49:23' prior: 50917196!
test04

	| interface password cartId cartContents validUser bookIsbn catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	validUser _ 'Guido'.
	password _ 'juancho'.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: validUser with: password.
	interface addToCart: cartId item: bookIsbn amount: 1.
	
	cartContents _ interface listCart: cartId.
	
	self assert: bookIsbn equals: cartContents first.
	self assert: 1 equals: cartContents size.! !

!testRun: #TusLibrosInterfaceTest #test04 stamp: 'GRC 11/4/2021 20:49:36'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:50:57' prior: 50917224!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	cart _ carts at: aCartId.
	
	cart.
	! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:51:41' prior: 50917394!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	cart _ carts at: aCartId.
	
	cart add: anAmount of: anItem.
	! !

!testRun: #TusLibrosInterfaceTest #test04 stamp: 'GRC 11/4/2021 20:51:43'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:52:36' prior: 50916977!
listCart: aCartId 

	| cart |
	cart _ carts at: aCartId.
	^cart items.! !
!Cart methodsFor: 'nil' stamp: 'GRC 11/4/2021 20:53:35'!
items

	^items.! !

----End fileIn of C:\Users\Guido\Desktop\20 - TusLibros\Packages\TerseGuide.pck.st----!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:56:02' prior: 50917411!
listCart: aCartId 

	| cart |
	cart _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	^cart items.! !
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:56:37'!
invalidCartErrorMessage
	
	^'invalid cart'.! !

!testRun: #TusLibrosInterfaceTest #test04 stamp: 'GRC 11/4/2021 20:56:42'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 20:56:42'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02 stamp: 'GRC 11/4/2021 20:56:42'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03 stamp: 'GRC 11/4/2021 20:56:42'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04 stamp: 'GRC 11/4/2021 20:56:42'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 20:59:20'!
test05

	| interface password cartId cartContents validUser bookIsbn catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	"self
		should interface listCart: cartId."! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:00:26' prior: 50920372!
test05

	| interface catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	self 
		should: [interface listCart: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test05 stamp: 'GRC 11/4/2021 21:00:34'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:00:44' prior: 50920384!
test05

	| interface catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	self 
		should: [interface listCart: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test05 stamp: 'GRC 11/4/2021 21:00:45'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 21:00:45'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02 stamp: 'GRC 11/4/2021 21:00:45'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03 stamp: 'GRC 11/4/2021 21:00:45'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04 stamp: 'GRC 11/4/2021 21:00:45'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05 stamp: 'GRC 11/4/2021 21:00:45'!
PASSED!

----SNAPSHOT----(4 November 2021 21:00:53) CuisUniversity-4913.image priorSource: 18700798!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:04:02'!
test01CannotCreateCartWithInvalidUser

	| interface invalidUser password catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	invalidUser _ 'Ryan'.
	password _ 'rugby2021'.
	
	self 
		should: [interface createCartFor: invalidUser with: password]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !

!methodRemoval: TusLibrosInterfaceTest #test01 stamp: 'GRC 11/4/2021 21:04:02'!
test01

	| interface invalidUser password catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	invalidUser _ 'Ryan'.
	password _ 'rugby2021'.
	
	self 
		should: [interface createCartFor: invalidUser with: password]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:04:12'!
test01CannotCreateCartWithInvalidUsernameOrPassword

	| interface invalidUser password catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	invalidUser _ 'Ryan'.
	password _ 'rugby2021'.
	
	self 
		should: [interface createCartFor: invalidUser with: password]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !

!methodRemoval: TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUser stamp: 'GRC 11/4/2021 21:04:12'!
test01CannotCreateCartWithInvalidUser

	| interface invalidUser password catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	invalidUser _ 'Ryan'.
	password _ 'rugby2021'.
	
	self 
		should: [interface createCartFor: invalidUser with: password]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:05:16'!
test02NewlyCreatedCartShouldBeEmpty

	| interface validUser password cartContents cartId catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	validUser _ 'Guido'.
	password _ 'juancho'.
	
	cartId _ interface createCartFor: validUser with: password.
	cartContents _ interface listCart: cartId.
	
	self assert: 1 equals: cartId.
	self assert: cartContents isEmpty. ! !

!methodRemoval: TusLibrosInterfaceTest #test02 stamp: 'GRC 11/4/2021 21:05:16'!
test02

	| interface validUser password cartContents cartId catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	validUser _ 'Guido'.
	password _ 'juancho'.
	
	cartId _ interface createCartFor: validUser with: password.
	cartContents _ interface listCart: cartId.
	
	self assert: 1 equals: cartId.
	self assert: cartContents isEmpty. !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:05:55'!
test03CartsHaveUniqueIds

	| interface validUser1 password cart1Id cart2Id validUser2 catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	validUser1 _ 'Guido'.
	validUser2 _ 'Migue'.
	password _ 'juancho'.
	
	cart1Id _ interface createCartFor: validUser1 with: password.
	cart2Id _ interface createCartFor: validUser2 with: password.
	
	self assert: 1 equals: cart1Id.
	self assert: 2 equals: cart2Id.! !

!methodRemoval: TusLibrosInterfaceTest #test03 stamp: 'GRC 11/4/2021 21:05:55'!
test03

	| interface validUser1 password cart1Id cart2Id validUser2 catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	validUser1 _ 'Guido'.
	validUser2 _ 'Migue'.
	password _ 'juancho'.
	
	cart1Id _ interface createCartFor: validUser1 with: password.
	cart2Id _ interface createCartFor: validUser2 with: password.
	
	self assert: 1 equals: cart1Id.
	self assert: 2 equals: cart2Id.!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:06:36'!
test04CartShouldContainAllItemsAddedToIt

	| interface password cartId cartContents validUser bookIsbn catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	validUser _ 'Guido'.
	password _ 'juancho'.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: validUser with: password.
	interface addToCart: cartId item: bookIsbn amount: 1.
	
	cartContents _ interface listCart: cartId.
	
	self assert: bookIsbn equals: cartContents first.
	self assert: 1 equals: cartContents size.! !

!methodRemoval: TusLibrosInterfaceTest #test04 stamp: 'GRC 11/4/2021 21:06:36'!
test04

	| interface password cartId cartContents validUser bookIsbn catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	validUser _ 'Guido'.
	password _ 'juancho'.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: validUser with: password.
	interface addToCart: cartId item: bookIsbn amount: 1.
	
	cartContents _ interface listCart: cartId.
	
	self assert: bookIsbn equals: cartContents first.
	self assert: 1 equals: cartContents size.!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:07:25'!
test05CannotListCartUsingAnInvalidCartId

	| interface catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	self 
		should: [interface listCart: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!methodRemoval: TusLibrosInterfaceTest #test05 stamp: 'GRC 11/4/2021 21:07:25'!
test05

	| interface catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	self 
		should: [interface listCart: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].!

!classDefinition: #TusLibrosInterfaceTest category: 'TusLibros' stamp: 'GRC 11/4/2021 21:10:31'!
TestCase subclass: #TusLibrosInterfaceTest
	instanceVariableNames: 'testObjectsFactory shouldAuthenticate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:10:30' prior: 50916948!
login: aUsername with: aPassword
	
	"aUsername = 'Ryan' ifTrue: [^self error: TusLibrosInterface invalidLoginErrorMessage.]."
	^shouldAuthenticate.
	
	! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:15:02' prior: 50920471!
test01CannotCreateCartWithInvalidUsernameOrPassword

	| interface catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	shouldAuthenticate _ false.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	self 
		should: [interface createCartFor: 'Ryan' with: 'Rugby2021']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:15:51' prior: 50917143 overrides: 16927572!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	shouldAuthenticate _ true.! !

----SNAPSHOT----(4 November 2021 21:16:48) CuisUniversity-4913.image priorSource: 18840999!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:17:46' prior: 50920509!
test02NewlyCreatedCartShouldBeEmpty

	| interface validUser password cartContents cartId catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	validUser _ 'Guido'.
	password _ 'juancho'.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	cartContents _ interface listCart: cartId.
	
	self assert: 1 equals: cartId.
	self assert: cartContents isEmpty. ! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:17:53' prior: 50920699!
test02NewlyCreatedCartShouldBeEmpty

	| interface cartContents cartId catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	cartContents _ interface listCart: cartId.
	
	self assert: 1 equals: cartId.
	self assert: cartContents isEmpty. ! !

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/4/2021 21:17:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/4/2021 21:17:56'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/4/2021 21:17:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/4/2021 21:17:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/4/2021 21:17:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/4/2021 21:17:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/4/2021 21:17:56'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/4/2021 21:18:24'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/4/2021 21:19:22' prior: 50920661!
login: aUsername with: aPassword
	
	"aUsername = 'Ryan' ifTrue: [^self error: TusLibrosInterface invalidLoginErrorMessage.]."
	shouldAuthenticate ifFalse: [^self error: TusLibrosInterface invalidLoginErrorMessage].
	
	! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/4/2021 21:19:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/4/2021 21:19:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/4/2021 21:19:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/4/2021 21:19:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/4/2021 21:19:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/4/2021 21:19:29'!
PASSED!

----SNAPSHOT----(4 November 2021 21:19:38) CuisUniversity-4913.image priorSource: 18849402!

----SNAPSHOT----(4 November 2021 21:20:39) CuisUniversity-4913.image priorSource: 18852610!

----QUIT----(4 November 2021 21:20:46) CuisUniversity-4913.image priorSource: 18852703!

----STARTUP---- (8 November 2021 13:43:06) as C:\Users\Guido\Desktop\20 - TusLibros\CuisUniversity-4913.image!

!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 13:46:34' prior: 50920543!
test03CartsHaveUniqueIds

	| interface validUser1 password cart1Id cart2Id validUser2 catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	validUser1 _ 'Guido'.
	validUser2 _ 'Migue'.
	password _ 'juancho'.
	
	cart1Id _ interface createCartFor: validUser1 with: password.
	cart2Id _ interface createCartFor: validUser2 with: password.
	
	self deny: cart1Id = cart2Id.! !

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 13:46:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 13:46:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 13:46:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 13:46:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 13:46:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 13:46:35'!
PASSED!
!Cart methodsFor: 'initialization' stamp: 'GRC 11/8/2021 13:49:40' prior: 50916139!
initializeAcceptingItemsOf: aCatalog

	catalog := aCatalog.
	items := Bag new.! !
!Cart methodsFor: 'adding' stamp: 'GRC 11/8/2021 13:51:08' prior: 50916161!
add: aQuantity of: anItem

	self assertIsValidQuantity: aQuantity.
	self assertIsValidItem: anItem.
	
	items add: anItem withOccurrences: aQuantity.
	"1 to: aQuantity do: [ :aNumber | items add: anItem ]"! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'GRC 11/8/2021 13:51:09'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'GRC 11/8/2021 13:51:09'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'GRC 11/8/2021 13:51:09'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'GRC 11/8/2021 13:51:09'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'GRC 11/8/2021 13:51:09'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'GRC 11/8/2021 13:51:09'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'GRC 11/8/2021 13:51:09'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'GRC 11/8/2021 13:51:09'!
PASSED!
!Cart methodsFor: 'queries' stamp: 'GRC 11/8/2021 13:51:45' prior: 50916145!
occurrencesOf: anItem

	^items occurrencesOf: anItem! !

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 13:54:11'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 13:55:19' prior: 50920579!
test04CartShouldContainAllItemsAddedToIt

	| interface cartId cartContents bookIsbn catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 1.
	
	cartContents _ interface listCart: cartId.
	
	self assert: bookIsbn equals: cartContents first.
	self assert: 1 equals: cartContents size.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 13:56:41' prior: 50920896!
test04CartShouldContainAllItemsAddedToIt

	| interface cartId cartContents bookIsbn catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 1.
	
	cartContents _ interface listCart: cartId.
	
	self assert: 1 equals: (cartContents occurrencesOf: bookIsbn).
	self assert: 1 equals: cartContents size.! !

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 13:56:41'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 13:56:41'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 13:56:41'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 13:56:42'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 13:56:42'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 13:56:42'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 13:56:58' prior: 50920917!
test04CartShouldContainAllItemsAddedToIt

	| interface cartId cartContents bookIsbn catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	cartContents _ interface listCart: cartId.
	
	self assert: 10 equals: (cartContents occurrencesOf: bookIsbn).
	self assert: 1 equals: cartContents size.! !

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 13:56:59'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 13:57:08' prior: 50920960!
test04CartShouldContainAllItemsAddedToIt

	| interface cartId cartContents bookIsbn catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	cartContents _ interface listCart: cartId.
	
	self assert: 10 equals: (cartContents occurrencesOf: bookIsbn).
	self assert: 10 equals: cartContents size.! !

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 13:57:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 13:57:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 13:57:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 13:57:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 13:57:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 13:57:09'!
PASSED!

----SNAPSHOT----(8 November 2021 13:58:09) CuisUniversity-4913.image priorSource: 18852796!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 13:58:54' prior: 50920763!
login: aUsername with: aPassword

	shouldAuthenticate ifFalse: [^self error: TusLibrosInterface invalidLoginErrorMessage].
	
	! !

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'GRC 11/8/2021 14:00:43'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'GRC 11/8/2021 14:00:43'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'GRC 11/8/2021 14:00:43'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'GRC 11/8/2021 14:00:43'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'GRC 11/8/2021 14:00:43'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'GRC 11/8/2021 14:00:43'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'GRC 11/8/2021 14:00:43'!
PASSED!
!Cart methodsFor: 'adding' stamp: 'GRC 11/8/2021 14:04:13' prior: 50920852!
add: aQuantity of: anItem

	self assertIsValidQuantity: aQuantity.
	self assertIsValidItem: anItem.
	
	items add: anItem withOccurrences: aQuantity.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'GRC 11/8/2021 14:04:13'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'GRC 11/8/2021 14:04:13'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'GRC 11/8/2021 14:04:13'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'GRC 11/8/2021 14:04:13'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'GRC 11/8/2021 14:04:13'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'GRC 11/8/2021 14:04:13'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'GRC 11/8/2021 14:04:13'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'GRC 11/8/2021 14:04:13'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 14:12:25'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 14:12:30'!
PASSED!

----SNAPSHOT----(8 November 2021 15:37:41) CuisUniversity-4913.image priorSource: 18860039!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 15:39:45'!
test06CheckingOutValidCartsReturnsAValidTransaction

	| interface catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	self 
		should: [interface listCart: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 15:40:00' prior: 50921225!
test06CheckingOutValidCartsReturnsAValidTransaction

	| interface catalogue bookIsbn cartContents cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	cartContents _ interface listCart: cartId.
	
	self assert: 10 equals: (cartContents occurrencesOf: bookIsbn).
	self assert: 10 equals: cartContents size.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 15:41:44' prior: 50921242!
test06CheckingOutValidCartsReturnsAValidTransaction

	| interface catalogue bookIsbn cartContents cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	"transaction _ interace checkout: cartId with: creditCard"
	
	self assert: 10 equals: (cartContents occurrencesOf: bookIsbn).
	self assert: 10 equals: cartContents size.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 15:43:55' prior: 50921264!
test06CheckingOutValidCartsReturnsAValidTransaction

	| interface catalogue bookIsbn cartContents cartId creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	"transaction _ interace checkout: cartId with: creditCard"
	
	self assert: 10 equals: (cartContents occurrencesOf: bookIsbn).
	self assert: 10 equals: cartContents size.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 15:44:39' prior: 50921286!
test06CheckingOutValidCartsReturnsAValidTransaction

	| interface catalogue bookIsbn cartContents cartId creditCard transaction |
	
	catalogue _ testObjectsFactory defaultCatalog.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transaction _ interface checkout: cartId with: creditCard for: 'Guido'.
	
	self assert: 10 equals: (cartContents occurrencesOf: bookIsbn).
	self assert: 10 equals: cartContents size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 15:50:48' prior: 50921310!
test06CheckingOutValidCartsReturnsAValidTransaction

	| interface catalogue bookIsbn cartId creditCard transaction |
	
	catalogue _ testObjectsFactory defaultCatalog.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transaction _ interface checkout: cartId with: creditCard for: 'Guido'.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 15:51:20' prior: 50921335!
test06CheckingOutValidCartsReturnsAValidTransaction

	| interface catalogue bookIsbn cartId creditCard transaction |
	
	catalogue _ testObjectsFactory defaultCatalog.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transaction _ interface checkout: cartId with: creditCard for: 'Guido'.
	
	self assert: 1 equals: transaction.! !

!testRun: #TusLibrosInterfaceTest #test06CheckingOutValidCartsReturnsAValidTransaction stamp: 'GRC 11/8/2021 15:51:22'!
ERROR!
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 15:51:28'!
checkout: aSmallInteger with: aCreditCard for: aString 
	self shouldBeImplemented.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 15:52:15' prior: 50921381!
checkout: aCartId with: aCreditCard for: aPerson 
	
	! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 15:53:04' prior: 50921387!
checkout: aCartId with: aCreditCard for: aPerson 
	
	| cart |
	
	cart _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 16:01:01' prior: 50921392!
checkout: aCartId with: aCreditCard for: aPerson 
	
	| cart |
	
	cart _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	
	^CashierTest checkout: cart with: aCreditCard. ! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 16:01:09' prior: 50921400!
checkout: aCartId with: aCreditCard for: aPerson 
	
	| cart |
	
	cart _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	
	^CashierTest checkout: cart with: aCreditCard.! !

----STARTUP---- (8 November 2021 17:14:59) as C:\Users\Guido\Desktop\20 - TusLibros\CuisUniversity-4913.image!


----SNAPSHOT----(8 November 2021 17:41:37) CuisUniversity-4913.image priorSource: 18866260!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 19:30:11'!
test06CannotAddToCartInactiveFor30min

	| interface catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	
	self 
		should: [interface listCart: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 19:30:36' prior: 50921426!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	self 
		should: [interface listCart: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 19:31:03' prior: 50921442!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	self 
		should: [interface listCart: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 19:31:20' prior: 50921460!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 10]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 19:31:40' prior: 50921482!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 10]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:32:02'!
FAILURE!
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 19:38:25' prior: 50917401!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	
	self assertActiveCart: aCartId.
	
	cart _ carts at: aCartId.
	cart add: anAmount of: anItem.
	! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:38:35'!
ERROR!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 19:38:44'!
assertActiveCart: aSmallInteger 
	self shouldBeImplemented.! !

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'GRC 11/8/2021 19:42:30'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'authenticationSystem nextCartId catalogue carts cartsLastTimeOfModification'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 19:42:28' prior: 50921541!
assertActiveCart: aCartId
	
	(cartsLastTimeOfModification at: aCartId) < (Time now - (30 * minute)) ifFalse: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:42:34'!
FAILURE!
!TusLibrosInterface methodsFor: 'initialization' stamp: 'GRC 11/8/2021 19:43:30' prior: 50917267!
initializeAuthenticatingWith: anAuthenticationSystem withCatalogue: aCatalogue

	authenticationSystem _ anAuthenticationSystem. 
	nextCartId _ 0.
	carts _ Dictionary new.
	cartsLastTimeOfModification _ Dictionary new.
	catalogue _ aCatalogue.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 19:43:55' prior: 50917256!
createCartFor: aUsername with: aPassword

	| cart |
	authenticationSystem login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	carts add: nextCartId -> cart.
	cartsLastTimeOfModification add: nextCartId -> Time now.
	
	^nextCartId.! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:44:01'!
ERROR!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 19:48:53' prior: 50921556!
assertActiveCart: aCartId
	
	(Time now -cartsLastTimeOfModification at: aCartId) minute > 30 ifFalse: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:48:55'!
ERROR!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 19:49:12' prior: 50921596!
assertActiveCart: aCartId
	
	(Time now - cartsLastTimeOfModification at: aCartId) minute > 30 ifFalse: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 19:49:52' prior: 50921608!
assertActiveCart: aCartId
	
	(Time now - (cartsLastTimeOfModification at: aCartId)) minute > 30 ifFalse: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:49:53'!
ERROR!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 19:50:05' prior: 50921617!
assertActiveCart: aCartId
	
	(Time now - (cartsLastTimeOfModification at: aCartId)) > 30 ifFalse: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:50:06'!
ERROR!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 19:50:19' prior: 50921629!
assertActiveCart: aCartId
	
	(Time now - (cartsLastTimeOfModification at: aCartId)) totalMinutes > 30 ifFalse: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:50:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 19:50:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 19:50:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 19:50:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 19:50:20'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 19:50:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:50:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 19:50:20'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:50:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 19:50:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 19:50:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 19:50:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 19:50:35'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 19:50:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:50:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 19:50:35'!
ERROR!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 19:52:01' prior: 50921641!
assertActiveCart: aCartId
	
	(Time now - (cartsLastTimeOfModification at: aCartId)) totalMinutes > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 19:52:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:52:05'!
FAILURE!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 19:53:19' prior: 50921708!
assertActiveCart: aCartId
	
	(Time now - (cartsLastTimeOfModification at: aCartId)) totalMinutes > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 19:53:24'!
FAILURE!
!TusLibrosInterface methodsFor: 'initialization' stamp: 'GRC 11/8/2021 19:57:19'!
through: anAuthenticationSystem withCatalogue: aCatalogue

	authenticationSystem _ anAuthenticationSystem. 
	nextCartId _ 0.
	carts _ Dictionary new.
	cartsLastTimeOfModification _ Dictionary new.
	catalogue _ aCatalogue.! !
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 19:57:20' prior: 50917284!
authenticatingWith: anAuthenticationSystem withCatalogue: aCatalog.
	
	^self new through: anAuthenticationSystem withCatalogue: aCatalog.! !

!methodRemoval: TusLibrosInterface #initializeAuthenticatingWith:withCatalogue: stamp: 'GRC 11/8/2021 19:57:20'!
initializeAuthenticatingWith: anAuthenticationSystem withCatalogue: aCatalogue

	authenticationSystem _ anAuthenticationSystem. 
	nextCartId _ 0.
	carts _ Dictionary new.
	cartsLastTimeOfModification _ Dictionary new.
	catalogue _ aCatalogue.!

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'GRC 11/8/2021 19:58:01'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'authenticationSystem nextCartId catalogue carts cartsLastTimeOfModification restApi'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'initialization' stamp: 'GRC 11/8/2021 19:57:59' prior: 50921736!
through: aRestApi withCatalogue: aCatalogue

	restApi _ aRestApi.
	nextCartId _ 0.
	carts _ Dictionary new.
	cartsLastTimeOfModification _ Dictionary new.
	catalogue _ aCatalogue.! !

Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts cartsLastTimeOfModification restApi'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'GRC 11/8/2021 19:58:13'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts cartsLastTimeOfModification restApi'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 19:58:47' prior: 50921724!
assertActiveCart: aCartId
	
	(restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!classDefinition: #TusLibrosInterfaceTest category: 'TusLibros' stamp: 'GRC 11/8/2021 19:59:45'!
TestCase subclass: #TusLibrosInterfaceTest
	instanceVariableNames: 'testObjectsFactory shouldAuthenticate currentTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterfaceTest methodsFor: 'restApi' stamp: 'GRC 11/8/2021 19:59:43'!
currentTime

	^currentTime
	
	! !
!TusLibrosInterfaceTest methodsFor: 'setup' stamp: 'GRC 11/8/2021 20:00:01' prior: 50920689 overrides: 16927572!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	shouldAuthenticate _ true.
	currentTime _ Time now.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 20:02:30' prior: 50921505!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time now + ((30 * minute) asDurationSinceMidnight).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 10]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:02:30'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:02:43'!
ERROR!
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 20:03:04' prior: 50921580!
createCartFor: aUsername with: aPassword

	| cart |
	restApi login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	carts add: nextCartId -> cart.
	cartsLastTimeOfModification add: nextCartId -> Time now.
	
	^nextCartId.! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:03:06'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 20:05:58' prior: 50921830!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time now + (Time seconds: 30 * 60).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 10]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:05:59'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 20:07:02' prior: 50921876!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time now +  (30 * 60 * second).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 10]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:07:03'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 20:08:46' prior: 50921902!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 10]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:08:49'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:11:46'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:12:14'!
FAILURE!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 20:13:23' prior: 50921800!
assertActiveCart: aCartId
	
	(restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes > 30 ifTrue: [self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 20:13:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 20:13:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 20:13:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 20:13:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 20:13:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:13:24'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:13:24'!
FAILURE!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 20:13:31' prior: 50921962!
assertActiveCart: aCartId
	
	(restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 20:14:05' prior: 50921997!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	dif > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:14:08'!
FAILURE!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 20:15:11' prior: 50922006!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	dif > 30 ifTrue: [self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 20:15:31' prior: 50921928!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 10]
		raise: Error 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:15:32'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 20:15:59' prior: 50922030!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 10]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 20:16:16' prior: 50922056!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:16:17'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 20:18:03' prior: 50922079!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	interface addToCart: cartId item: bookIsbn amount: 1.
	
	"self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText]."! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:18:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 20:18:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 20:18:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 20:18:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 20:18:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 20:18:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:18:03'!
PASSED!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 20:19:12' prior: 50922020!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	dif > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:20:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 20:20:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 20:20:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 20:20:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 20:20:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 20:20:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:20:20'!
PASSED!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 20:21:15' prior: 50922156!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	dif > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 20:21:27' prior: 50922106!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:21:29'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 20:27:20' prior: 50922201!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn l |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	interface addToCart: cartId item: bookIsbn amount: 1.
	l _ interface listCart: cartId.
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 20:27:29' prior: 50922228!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn l |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	interface addToCart: cartId item: bookIsbn amount: 1.
	l _ interface listCart: cartId.
	
	"self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText]."! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:27:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 20:27:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 20:27:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 20:27:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 20:27:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 20:27:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:27:31'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 20:27:57' prior: 50922254!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface authenticatingWith: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:28:10'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:28:29'!
FAILURE!

dif > 30!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 20:29:57' prior: 50922191!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	dif > 30 ifTrue: [self error: TusLibrosInterface invalidCartErrorMessage].! !

----SNAPSHOT----(8 November 2021 20:30:00) CuisUniversity-4913.image priorSource: 18872708!

!classRemoval: #TusLibrosInterface stamp: 'GRC 11/8/2021 20:30:12'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts cartsLastTimeOfModification restApi'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #StoreTestObjectsFactory stamp: 'GRC 11/8/2021 20:30:13'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Sale stamp: 'GRC 11/8/2021 20:30:13'!
Object subclass: #Sale
	instanceVariableNames: 'total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'GRC 11/8/2021 20:30:14'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'GRC 11/8/2021 20:30:14'!
Object subclass: #Cashier
	instanceVariableNames: 'cart salesBook merchantProcessor creditCard total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'GRC 11/8/2021 20:30:15'!
Object subclass: #Cart
	instanceVariableNames: 'catalog items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #TusLibrosInterfaceTest stamp: 'GRC 11/8/2021 20:30:15'!
TestCase subclass: #TusLibrosInterfaceTest
	instanceVariableNames: 'testObjectsFactory shouldAuthenticate currentTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'GRC 11/8/2021 20:30:16'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'GRC 11/8/2021 20:30:16'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of \Users\Guido\Desktop\20 - TusLibros\TusLibros.st----!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:30:40'!
FAILURE!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'GRC 11/8/2021 20:31:13' prior: 50923155!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	dif > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 20:31:36' prior: 50923119!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	dif > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].
	
	cart _ carts at: aCartId.
	cart add: anAmount of: anItem.
	! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 20:31:37'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 20:31:37'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 20:31:37'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 20:31:37'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 20:31:37'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:31:37'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:31:37'!
FAILURE!
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 20:32:31' prior: 50923207!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	
	self assertActiveCart: aCartId.
	
	cart _ carts at: aCartId.
	cart add: anAmount of: anItem.
	! !
!TusLibrosInterface methodsFor: 'initialization' stamp: 'GRC 11/8/2021 20:40:15'!
invalidCartErrorMessage
	
	^'invalid cart'.! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 20:40:26' prior: 50923197!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	dif > 30 ifTrue: [self error: self invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 20:40:27'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 20:40:27'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 20:40:27'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 20:40:27'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 20:40:27'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:40:27'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:40:27'!
FAILURE!

!methodRemoval: TusLibrosInterface #invalidCartErrorMessage stamp: 'GRC 11/8/2021 20:40:37'!
invalidCartErrorMessage
	
	^'invalid cart'.!
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 20:40:50' prior: 50923258!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	dif > 30 ifTrue: [self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 20:41:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 20:41:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 20:41:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 20:41:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 20:41:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:41:09'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 20:41:09'!
FAILURE!

----SNAPSHOT----(8 November 2021 20:41:16) CuisUniversity-4913.image priorSource: 18902220!

----STARTUP---- (8 November 2021 20:45:00) as C:\Users\Guido\Desktop\20 - TusLibros\CuisUniversity-4913.image!

!TusLibrosInterfaceTest methodsFor: 'restApi' stamp: 'GRC 11/8/2021 20:47:23' prior: 50922788!
currentTime

	^currentTime _ Time now.
	
	! !
!TusLibrosInterfaceTest methodsFor: 'restApi' stamp: 'GRC 11/8/2021 20:47:37' prior: 50923339!
currentTime

	^currentTime.
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:06:56' prior: 50922765!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:07:51'!
through: anAuthenticationSystem withCatalogue: aCatalog.
	
	^self new through: anAuthenticationSystem withCatalogue: aCatalog.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:07:51' prior: 50922750!
test05CannotListCartUsingAnInvalidCartId

	| interface catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue.
	
	self 
		should: [interface listCart: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:07:51' prior: 50922698!
test02NewlyCreatedCartShouldBeEmpty

	| interface cartContents cartId catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	cartContents _ interface listCart: cartId.
	
	self assert: 1 equals: cartId.
	self assert: cartContents isEmpty. ! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:07:51' prior: 50922730!
test04CartShouldContainAllItemsAddedToIt

	| interface cartId cartContents bookIsbn catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	cartContents _ interface listCart: cartId.
	
	self assert: 10 equals: (cartContents occurrencesOf: bookIsbn).
	self assert: 10 equals: cartContents size.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:07:51' prior: 50922713!
test03CartsHaveUniqueIds

	| interface validUser1 password cart1Id cart2Id validUser2 catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue.
	validUser1 _ 'Guido'.
	validUser2 _ 'Migue'.
	password _ 'juancho'.
	
	cart1Id _ interface createCartFor: validUser1 with: password.
	cart2Id _ interface createCartFor: validUser2 with: password.
	
	self deny: cart1Id = cart2Id.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:07:51' prior: 50922680!
test01CannotCreateCartWithInvalidUsernameOrPassword

	| interface catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	shouldAuthenticate _ false.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue.
	
	self 
		should: [interface createCartFor: 'Ryan' with: 'Rugby2021']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !

!methodRemoval: TusLibrosInterface class #authenticatingWith:withCatalogue: stamp: 'GRC 11/8/2021 21:07:51'!
authenticatingWith: anAuthenticationSystem withCatalogue: aCatalog.
	
	^self new through: anAuthenticationSystem withCatalogue: aCatalog.!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:09:12'!
test07CannotListCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:09:23' prior: 50923475!
test07CannotListCartInactiveFor30min

	| interface catalogue cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 21:09:29'!
FAILURE!
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 21:09:56' prior: 50923139!
listCart: aCartId 

	| cart |
	
	self assertActiveCart: aCartId.
	
	cart _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	^cart items.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 21:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 21:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 21:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 21:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 21:09:59'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 21:09:59'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 21:09:59'!
FAILURE!
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 21:11:27' prior: 50923521!
listCart: aCartId 

	| cart |
	
	cart _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	^cart items.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 21:11:36'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 21:11:36'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 21:11:36'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 21:11:36'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 21:11:36'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 21:11:36'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 21:11:36'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:12:31'!
test08

	| interface catalogue cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:12:58' prior: 50923589!
test08

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:15:28' prior: 50923606!
test08

	| interface catalogue cartId bookIsbn transactionId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transactionId _ interface checkout: cartId.! !

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'GRC 11/8/2021 21:18:31'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts cartsLastTimeOfModification restApi transactionsList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'initialization' stamp: 'GRC 11/8/2021 21:18:29' prior: 50923146!
through: aRestApi withCatalogue: aCatalogue

	restApi _ aRestApi.
	nextCartId _ 0.
	carts _ Dictionary new.
	cartsLastTimeOfModification _ Dictionary new.
	catalogue _ aCatalogue.
	transactionsList _ OrderedCollection new.! !
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:19:32'!
through: anAuthenticationSystem withCatalogue: aCatalog registeringOn: aTransactionList .
	
	^self new through: anAuthenticationSystem withCatalogue: aCatalog.! !
!TusLibrosInterface methodsFor: 'initialization' stamp: 'GRC 11/8/2021 21:19:32'!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	nextCartId _ 0.
	carts _ Dictionary new.
	cartsLastTimeOfModification _ Dictionary new.
	catalogue _ aCatalogue.
	transactionsList _ OrderedCollection new.! !
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:19:32' prior: 50923371!
through: anAuthenticationSystem withCatalogue: aCatalog.
	
	^self new through: anAuthenticationSystem withCatalogue: aCatalog registeringOn: transactionsList.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:19:32' prior: 50923379!
test05CannotListCartUsingAnInvalidCartId

	| interface catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	self 
		should: [interface listCart: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:19:32' prior: 50923395!
test02NewlyCreatedCartShouldBeEmpty

	| interface cartContents cartId catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	cartContents _ interface listCart: cartId.
	
	self assert: 1 equals: cartId.
	self assert: cartContents isEmpty. ! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:19:32' prior: 50923450!
test01CannotCreateCartWithInvalidUsernameOrPassword

	| interface catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	shouldAuthenticate _ false.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	self 
		should: [interface createCartFor: 'Ryan' with: 'Rugby2021']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:19:32' prior: 50923411!
test04CartShouldContainAllItemsAddedToIt

	| interface cartId cartContents bookIsbn catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	cartContents _ interface listCart: cartId.
	
	self assert: 10 equals: (cartContents occurrencesOf: bookIsbn).
	self assert: 10 equals: cartContents size.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:19:33' prior: 50923497!
test07CannotListCartInactiveFor30min

	| interface catalogue cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:19:33' prior: 50923432!
test03CartsHaveUniqueIds

	| interface validUser1 password cart1Id cart2Id validUser2 catalogue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	validUser1 _ 'Guido'.
	validUser2 _ 'Migue'.
	password _ 'juancho'.
	
	cart1Id _ interface createCartFor: validUser1 with: password.
	cart2Id _ interface createCartFor: validUser2 with: password.
	
	self deny: cart1Id = cart2Id.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:19:33' prior: 50923628!
test08

	| interface catalogue cartId bookIsbn transactionId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transactionId _ interface checkout: cartId.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:19:33' prior: 50923348!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:19:33' prior: 50923666!
through: anAuthenticationSystem withCatalogue: aCatalog registeringOn: aTransactionList .
	
	^self new through: anAuthenticationSystem withCatalogue: aCatalog registeringOn: transactionsList.! !

!methodRemoval: TusLibrosInterface class #through:withCatalogue: stamp: 'GRC 11/8/2021 21:19:33'!
through: anAuthenticationSystem withCatalogue: aCatalog.
	
	^self new through: anAuthenticationSystem withCatalogue: aCatalog registeringOn: transactionsList.!

!methodRemoval: TusLibrosInterface #through:withCatalogue: stamp: 'GRC 11/8/2021 21:19:33'!
through: aRestApi withCatalogue: aCatalogue

	restApi _ aRestApi.
	nextCartId _ 0.
	carts _ Dictionary new.
	cartsLastTimeOfModification _ Dictionary new.
	catalogue _ aCatalogue.
	transactionsList _ OrderedCollection new.!
!TusLibrosInterface methodsFor: 'initialization' stamp: 'GRC 11/8/2021 21:19:42' prior: 50923674!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	nextCartId _ 0.
	carts _ Dictionary new.
	cartsLastTimeOfModification _ Dictionary new.
	catalogue _ aCatalogue.
	transactionsList _ aTransactionList.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:20:22' prior: 50923770!
test07CannotListCartInactiveFor30min

	| interface catalogue cartId transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:20:31' prior: 50923829!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ Time seconds: currentTime privateSeconds + (30 * 60).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:20:36' prior: 50923695!
test05CannotListCartUsingAnInvalidCartId

	| interface catalogue transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	self 
		should: [interface listCart: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:20:40' prior: 50923748!
test04CartShouldContainAllItemsAddedToIt

	| interface cartId cartContents bookIsbn catalogue transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	cartContents _ interface listCart: cartId.
	
	self assert: 10 equals: (cartContents occurrencesOf: bookIsbn).
	self assert: 10 equals: cartContents size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:20:44' prior: 50923791!
test03CartsHaveUniqueIds

	| interface validUser1 password cart1Id cart2Id validUser2 catalogue transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	validUser1 _ 'Guido'.
	validUser2 _ 'Migue'.
	password _ 'juancho'.
	
	cart1Id _ interface createCartFor: validUser1 with: password.
	cart2Id _ interface createCartFor: validUser2 with: password.
	
	self deny: cart1Id = cart2Id.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:20:50' prior: 50923712!
test02NewlyCreatedCartShouldBeEmpty

	| interface cartContents cartId catalogue transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	cartContents _ interface listCart: cartId.
	
	self assert: 1 equals: cartId.
	self assert: cartContents isEmpty. ! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:20:54' prior: 50923729!
test01CannotCreateCartWithInvalidUsernameOrPassword

	| interface catalogue transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	shouldAuthenticate _ false.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	self 
		should: [interface createCartFor: 'Ryan' with: 'Rugby2021']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:20:58' prior: 50923810!
test08

	| interface catalogue cartId bookIsbn transactionId transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transactionId _ interface checkout: cartId.! !

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 21:21:05'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 21:21:11'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:22:35' prior: 50924041!
test08

	| interface catalogue cartId bookIsbn transactionId transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transactionId _ interface checkout: cartId.
	
	self assert: transactionId equals: transactionsList first.
	self assert: 1 equals: transactionsList size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:25:18' prior: 50924069!
test08

	| interface catalogue cartId bookIsbn transactionId transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transactionId _ interface checkout: cartId charging: creditCard.
	
	self assert: transactionId equals: transactionsList first.
	self assert: 1 equals: transactionsList size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:26:01' prior: 50924093!
test08

	| interface catalogue cartId bookIsbn transactionId transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transactionId _ interface checkout: cartId charging: creditCard.
	
	self assert: transactionId equals: transactionsList first.
	self assert: 1 equals: transactionsList size.! !

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:26:10'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:26:17'!
checkout: aSmallInteger charging: aCreditCard 
	self shouldBeImplemented.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:29:18' prior: 50924147!
checkout: aCartId charging: aCreditCard 
	
	| cart cashierToCheckout salesBook |
	
	cart _ carts at: aCartId.
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: cart charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:31:08' prior: 50924153!
checkout: aCartId charging: aCreditCard 
	
	| cart cashierToCheckout salesBook total |
	
	cart _ carts at: aCartId.
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: cart charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	transactionsList add: (transactionsList size + 1).! !

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:31:33'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:31:41'!
today
	self shouldBeImplemented.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:32:13' prior: 50924183!
today
	
	^testObjectsFactory today.! !

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:32:15'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:32:25'!
debit: aSmallInteger from: aCreditCard 
	self shouldBeImplemented.! !

!classDefinition: #TusLibrosInterfaceTest category: 'TusLibros' stamp: 'GRC 11/8/2021 21:33:42'!
TestCase subclass: #TusLibrosInterfaceTest
	instanceVariableNames: 'testObjectsFactory shouldAuthenticate currentTime debitBehaviour'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:33:41' prior: 50924195!
debit: anAmount from: aCreditCard 
	
	^debitBehaviour value: anAmount value: aCreditCard! !

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:33:45'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'setup' stamp: 'GRC 11/8/2021 21:34:11' prior: 50922673 overrides: 16927572!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	shouldAuthenticate _ true.
	currentTime _ Time now.
	debitBehaviour _ [:anAmount :aCreditCard |].! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 21:34:12'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 21:34:12'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 21:34:12'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 21:34:12'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 21:34:12'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 21:34:12'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 21:34:12'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:34:12'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:34:30'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:35:01'!
ERROR!
!TusLibrosInterface class methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:35:57' prior: 50923853!
through: anAuthenticationSystem withCatalogue: aCatalog registeringOn: aTransactionsList
	
	^self new through: anAuthenticationSystem withCatalogue: aCatalog registeringOn: aTransactionsList.! !

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:35:58'!
FAILURE!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:37:07' prior: 50924165!
checkout: aCartId charging: aCreditCard 
	
	| cart cashierToCheckout salesBook total transactionId |
	
	cart _ carts at: aCartId.
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: cart charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	^transactionId.! !

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:37:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 21:37:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 21:37:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 21:37:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 21:37:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 21:37:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 21:37:16'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 21:37:16'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:37:16'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:40:45'!
test09

	| interface catalogue cartId1 bookIsbn transactionId1 transactionsList creditCard cartId cartId2 transactionId2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId1 _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId1 item: bookIsbn amount: 10.
	transactionId1 _ interface checkout: cartId1 charging: creditCard.
	
	cartId2 _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId2 item: bookIsbn amount: 5.
	transactionId2 _ interface checkout: cartId1 charging: creditCard.
	
	self assert: transactionId1 equals: transactionsList first.
	self assert: transactionId2 equals: (transactionsList at: 2).
	self assert: 2 equals: transactionsList size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:41:29' prior: 50924320!
test09

	| interface catalogue cartId1 bookIsbn transactionId1 transactionsList creditCard cartId2 transactionId2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId1 _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId1 item: bookIsbn amount: 10.
	transactionId1 _ interface checkout: cartId1 charging: creditCard.
	
	cartId2 _ interface createCartFor: 'Pepe' with: 'Juancho'.
	interface addToCart: cartId2 item: bookIsbn amount: 5.
	transactionId2 _ interface checkout: cartId1 charging: creditCard.
	
	self assert: transactionId1 equals: transactionsList first.
	self assert: transactionId2 equals: (transactionsList at: 2).
	self deny: transactionId1 = transactionId2.
	self assert: 2 equals: transactionsList size.! !

!testRun: #TusLibrosInterfaceTest #test09 stamp: 'GRC 11/8/2021 21:41:34'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 21:41:34'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 21:41:34'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 21:41:34'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 21:41:34'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 21:41:34'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 21:41:34'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 21:41:34'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:41:34'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09 stamp: 'GRC 11/8/2021 21:41:34'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:42:03'!
test10

	| interface catalogue cartId1 bookIsbn transactionId1 transactionsList creditCard cartId2 transactionId2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId1 _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId1 item: bookIsbn amount: 10.
	transactionId1 _ interface checkout: cartId1 charging: creditCard.
	
	cartId2 _ interface createCartFor: 'Pepe' with: 'Juancho'.
	interface addToCart: cartId2 item: bookIsbn amount: 5.
	transactionId2 _ interface checkout: cartId2 charging: creditCard.
	
	self assert: transactionId1 equals: transactionsList first.
	self assert: transactionId2 equals: (transactionsList at: 2).
	self deny: transactionId1 = transactionId2.
	self assert: 2 equals: transactionsList size.! !

!testRun: #TusLibrosInterfaceTest #test10 stamp: 'GRC 11/8/2021 21:42:04'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 21:42:04'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 21:42:04'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 21:42:04'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 21:42:04'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 21:42:04'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 21:42:04'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 21:42:04'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:42:04'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09 stamp: 'GRC 11/8/2021 21:42:04'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10 stamp: 'GRC 11/8/2021 21:42:04'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:42:12' prior: 50924356!
test09

	| interface catalogue cartId1 bookIsbn transactionId1 transactionsList creditCard cartId2 transactionId2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId1 _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId1 item: bookIsbn amount: 10.
	transactionId1 _ interface checkout: cartId1 charging: creditCard.
	
	cartId2 _ interface createCartFor: 'Pepe' with: 'Juancho'.
	interface addToCart: cartId2 item: bookIsbn amount: 5.
	transactionId2 _ interface checkout: cartId2 charging: creditCard.
	
	self assert: transactionId1 equals: transactionsList first.
	self assert: transactionId2 equals: (transactionsList at: 2).
	self deny: transactionId1 = transactionId2.
	self assert: 2 equals: transactionsList size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:42:26' prior: 50924424!
test10

	| interface catalogue cartId1 bookIsbn transactionId1 transactionsList creditCard cartId2 transactionId2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId1 _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId1 item: bookIsbn amount: 10.
	transactionId1 _ interface checkout: cartId1 charging: creditCard.
	
	cartId2 _ interface createCartFor: 'Pepe' with: 'Juancho'.
	interface addToCart: cartId2 item: bookIsbn amount: 5.
	transactionId2 _ interface checkout: cartId2 charging: creditCard.
	
	self assert: transactionId1 equals: transactionsList first.
	self assert: transactionId2 equals: (transactionsList at: 2).
	self deny: transactionId1 = transactionId2.
	self assert: 2 equals: transactionsList size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:42:44' prior: 50924530!
test10

	| interface catalogue cartId bookIsbn transactionId transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transactionId _ interface checkout: cartId charging: creditCard.
	
	self assert: transactionId equals: transactionsList first.
	self assert: 1 equals: transactionsList size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:43:09' prior: 50924565!
test10

	| interface catalogue cartId bookIsbn transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	interface checkout: cartId charging: creditCard.
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:44:03' prior: 50924592!
test10

	| interface catalogue cartId bookIsbn transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	interface checkout: cartId charging: creditCard.
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !

!testRun: #TusLibrosInterfaceTest #test10 stamp: 'GRC 11/8/2021 21:44:08'!
FAILURE!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:45:01' prior: 50924273!
checkout: aCartId charging: aCreditCard 
	
	| cart cashierToCheckout salesBook total transactionId |
	
	cart _ carts at: aCartId.
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: cart charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:45:27' prior: 50924647!
checkout: aCartId charging: aCreditCard 
	
	| cart cashierToCheckout salesBook total transactionId |
	
	cart _ carts at: aCartId.
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: cart charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	cartsLastTimeOfModification removeKey: aCartId.
	
	^transactionId.! !

!testRun: #TusLibrosInterfaceTest #test10 stamp: 'GRC 11/8/2021 21:45:39'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 21:45:39'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 21:45:39'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 21:45:39'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 21:45:39'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 21:45:39'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 21:45:39'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 21:45:39'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:45:39'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09 stamp: 'GRC 11/8/2021 21:45:39'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10 stamp: 'GRC 11/8/2021 21:45:39'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 21:46:22'!
test11

	| interface catalogue transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	self 
		should: [interface checkout: 1 charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !

!testRun: #TusLibrosInterfaceTest #test11 stamp: 'GRC 11/8/2021 21:46:28'!
FAILURE!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 21:46:49' prior: 50924665!
checkout: aCartId charging: aCreditCard 
	
	| cart cashierToCheckout salesBook total transactionId |
	
	cart _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: cart charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	cartsLastTimeOfModification removeKey: aCartId.
	
	^transactionId.! !

!testRun: #TusLibrosInterfaceTest #test11 stamp: 'GRC 11/8/2021 21:46:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 21:46:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 21:46:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 21:46:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 21:46:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 21:46:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 21:46:57'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 21:46:57'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 21:46:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09 stamp: 'GRC 11/8/2021 21:46:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10 stamp: 'GRC 11/8/2021 21:46:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11 stamp: 'GRC 11/8/2021 21:46:57'!
PASSED!

----SNAPSHOT----(8 November 2021 21:53:50) CuisUniversity-4913.image priorSource: 18933784!

----QUIT----(8 November 2021 21:53:57) CuisUniversity-4913.image priorSource: 18980859!

----STARTUP---- (8 November 2021 22:33:30) as C:\Users\Guido\Desktop\20 - TusLibros\CuisUniversity-4913.image!

!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:34:15'!
test08CheckingOutAValidCartRegistersTransaction

	| interface catalogue cartId bookIsbn transactionId transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transactionId _ interface checkout: cartId charging: creditCard.
	
	self assert: transactionId equals: transactionsList first.
	self assert: 1 equals: transactionsList size.! !

!methodRemoval: TusLibrosInterfaceTest #test08 stamp: 'GRC 11/8/2021 22:34:15'!
test08

	| interface catalogue cartId bookIsbn transactionId transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transactionId _ interface checkout: cartId charging: creditCard.
	
	self assert: transactionId equals: transactionsList first.
	self assert: 1 equals: transactionsList size.!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:34:28'!
test09TransactionsHaveUniqueIds

	| interface catalogue cartId1 bookIsbn transactionId1 transactionsList creditCard cartId2 transactionId2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId1 _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId1 item: bookIsbn amount: 10.
	transactionId1 _ interface checkout: cartId1 charging: creditCard.
	
	cartId2 _ interface createCartFor: 'Pepe' with: 'Juancho'.
	interface addToCart: cartId2 item: bookIsbn amount: 5.
	transactionId2 _ interface checkout: cartId2 charging: creditCard.
	
	self assert: transactionId1 equals: transactionsList first.
	self assert: transactionId2 equals: (transactionsList at: 2).
	self deny: transactionId1 = transactionId2.
	self assert: 2 equals: transactionsList size.! !

!methodRemoval: TusLibrosInterfaceTest #test09 stamp: 'GRC 11/8/2021 22:34:28'!
test09

	| interface catalogue cartId1 bookIsbn transactionId1 transactionsList creditCard cartId2 transactionId2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId1 _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId1 item: bookIsbn amount: 10.
	transactionId1 _ interface checkout: cartId1 charging: creditCard.
	
	cartId2 _ interface createCartFor: 'Pepe' with: 'Juancho'.
	interface addToCart: cartId2 item: bookIsbn amount: 5.
	transactionId2 _ interface checkout: cartId2 charging: creditCard.
	
	self assert: transactionId1 equals: transactionsList first.
	self assert: transactionId2 equals: (transactionsList at: 2).
	self deny: transactionId1 = transactionId2.
	self assert: 2 equals: transactionsList size.!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:35:05'!
test10CheckingOutACartDeletesIt

	| interface catalogue cartId bookIsbn transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	interface checkout: cartId charging: creditCard.
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !

!methodRemoval: TusLibrosInterfaceTest #test10 stamp: 'GRC 11/8/2021 22:35:05'!
test10

	| interface catalogue cartId bookIsbn transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	interface checkout: cartId charging: creditCard.
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:36:14'!
test11CannotCheckOutInvalidCart

	| interface catalogue transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	self 
		should: [interface checkout: 1 charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !

!methodRemoval: TusLibrosInterfaceTest #test11 stamp: 'GRC 11/8/2021 22:36:14'!
test11

	| interface catalogue transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	self 
		should: [interface checkout: 1 charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:37:27'!
FAILURE!
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 22:40:12' prior: 50923297!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	(dif > 30) ifTrue: [self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 22:40:42' prior: 50925038!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	(dif > 30) ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:41:20'!
FAILURE!
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 22:41:50' prior: 50925048!
assertActiveCart: aCartId
	
	^self error: TusLibrosInterface invalidCartErrorMessage.
	
	"| dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	(dif > 30) ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage]."! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 22:41:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 22:41:51'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 22:41:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 22:41:51'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 22:41:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:41:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:41:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 22:41:51'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 22:41:51'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 22:41:51'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 22:41:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:42:05'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:42:09'!
PASSED!
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 22:42:50' prior: 50925062!
assertActiveCart: aCartId
	
	"^self error: TusLibrosInterface invalidCartErrorMessage."
	
	| dif test |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	test _ dif > 30.
	test ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 22:42:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 22:42:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 22:42:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 22:42:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 22:42:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:42:56'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:42:56'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 22:42:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 22:42:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 22:42:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 22:42:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:43:03'!
FAILURE!
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 22:44:23' prior: 50925120!
assertActiveCart: aCartId
	
	"^self error: TusLibrosInterface invalidCartErrorMessage."
	
	| dif test |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	test _ dif > 30.
	test ifTrue: [^TusLibrosInterface error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 22:45:08' prior: 50925175!
assertActiveCart: aCartId
	
	"^self error: TusLibrosInterface invalidCartErrorMessage."
	
	| dif test |
	
	test _ self.
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	"test _ dif > 30."
	dif > 30 ifTrue: [^test error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:45:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:45:16'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:45:23'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:45:23'!
FAILURE!
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 22:45:54' prior: 50925188!
assertActiveCart: aCartId
	
	"^self error: TusLibrosInterface invalidCartErrorMessage."
	
	| dif test |
	
	test _ self.
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	"test _ dif > 30."
	dif > 30 ifTrue: [^self error: 'Invalid cart'].! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 22:45:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 22:45:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 22:45:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 22:45:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 22:45:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:45:57'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:45:57'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 22:45:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 22:45:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 22:45:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 22:45:57'!
PASSED!
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 22:46:15' prior: 50925215!
assertActiveCart: aCartId
	
	"^self error: TusLibrosInterface invalidCartErrorMessage."
	
	| dif test |
	
	test _ self.
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	"test _ dif > 30."
	dif > 30 ifTrue: [^self error: 'invalid cart'].! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 22:46:18'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 22:46:18'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 22:46:18'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 22:46:18'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 22:46:18'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:46:18'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:46:18'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 22:46:18'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 22:46:18'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 22:46:18'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 22:46:18'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'setup' stamp: 'GRC 11/8/2021 22:49:35' prior: 50924219 overrides: 16927572!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	shouldAuthenticate _ true.
	currentTime _ DateAndTime now.
	debitBehaviour _ [:anAmount :aCreditCard |].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:50:26' prior: 50923915!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + Duration minutes: 30.
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:51:03' prior: 50925328!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 30).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:51:04'!
ERROR!
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 22:51:33' prior: 50923127!
createCartFor: aUsername with: aPassword

	| cart |
	restApi login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	carts add: nextCartId -> cart.
	cartsLastTimeOfModification add: nextCartId -> DateAndTime now.
	
	^nextCartId.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 22:51:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 22:51:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 22:51:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 22:51:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 22:51:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:51:43'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:51:43'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 22:51:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 22:51:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 22:51:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 22:51:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:51:46'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:52:16' prior: 50925353!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 30).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 22:53:01' prior: 50925267!
assertActiveCart: aCartId
	
	"^self error: TusLibrosInterface invalidCartErrorMessage."
	
	| dif test |
	
	test _ self.
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) minutes.
	"test _ dif > 30."
	dif > 30 ifTrue: [^self error: 'invalid cart'].! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 22:53:27' prior: 50925462!
assertActiveCart: aCartId
	
	"^self error: TusLibrosInterface invalidCartErrorMessage."
	
	| dif test |
	
	test _ self.
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) minutes.
	"test _ dif > 30."
	dif > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:53:44'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:53:52'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:54:15' prior: 50923892!
test07CannotListCartInactiveFor30min

	| interface catalogue cartId transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 30).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:54:17'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:54:23'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:54:23'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:55:14' prior: 50925437!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 300).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:55:18' prior: 50925494!
test07CannotListCartInactiveFor30min

	| interface catalogue cartId transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 300).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:55:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 22:55:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 22:55:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 22:55:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 22:55:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 22:55:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:55:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:55:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 22:55:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 22:55:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 22:55:20'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 22:55:20'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:55:28' prior: 50925552!
test07CannotListCartInactiveFor30min

	| interface catalogue cartId transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 31).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:55:34' prior: 50925527!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 31).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:55:36'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:55:46' prior: 50925639!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 32).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:55:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 22:55:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 22:55:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 22:55:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 22:55:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 22:55:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 22:55:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:55:47'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 22:55:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 22:55:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 22:55:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 22:55:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:55:48'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 22:55:52' prior: 50925668!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 31).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 22:55:56'!
FAILURE!
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 23:01:33' prior: 50925474!
assertActiveCart: aCartId
	
	"^self error: TusLibrosInterface invalidCartErrorMessage."
	
	| dif test |
	
	test _ self.
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	"test _ dif > 30."
	dif > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:01:39'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:01:46' prior: 50925740!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 300).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:01:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 23:01:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 23:01:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 23:01:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 23:01:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 23:01:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:01:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 23:01:47'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 23:01:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 23:01:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 23:01:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 23:01:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 23:01:47'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:01:56' prior: 50925617!
test07CannotListCartInactiveFor30min

	| interface catalogue cartId transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 300).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 23:01:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 23:01:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 23:01:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 23:01:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 23:01:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 23:01:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:01:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 23:01:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 23:01:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 23:01:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 23:01:57'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 23:01:57'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:02:07' prior: 50925786!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 32).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:02:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 23:02:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 23:02:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 23:02:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 23:02:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 23:02:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:02:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 23:02:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 23:02:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 23:02:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 23:02:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 23:02:08'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:02:13' prior: 50925923!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 31).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:02:14'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:02:18' prior: 50925991!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 32).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'GRC 11/8/2021 23:02:56' prior: 50925769!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - (cartsLastTimeOfModification at: aCartId)) totalMinutes.
	dif > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:03:53'!
test12CannotCheckOutCartInactiveFor30min

	| interface catalogue transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	self 
		should: [interface checkout: 1 charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:04:28' prior: 50926054!
test12CannotCheckOutCartInactiveFor30min

	| interface catalogue transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	interface checkout: 1 charging: creditCard.
	
	self 
		should: [interface checkout: 1 charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:04:49' prior: 50926075!
test12CannotCheckOutCartInactiveFor30min

	| interface catalogue transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	currentTime _ currentTime + (Duration minutes: 300).
	
	self 
		should: [interface checkout: 1 charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'GRC 11/8/2021 23:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 23:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 23:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 23:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 23:04:52'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 23:04:52'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:04:52'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 23:04:52'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 23:04:52'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 23:04:52'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 23:04:52'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 23:04:52'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'GRC 11/8/2021 23:04:52'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:05:26' prior: 50926098!
test12CannotCheckOutCartInactiveFor30min

	| interface catalogue transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	
	currentTime _ currentTime + (Duration minutes: 300).
	
	self 
		should: [interface checkout: 1 charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:05:45' prior: 50924936!
test10CheckingOutACartDeletesIt

	| interface catalogue cartId bookIsbn transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	interface checkout: cartId charging: creditCard.
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:05:53' prior: 50926168!
test12CannotCheckOutCartInactiveFor30min

	| interface catalogue transactionsList creditCard bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	
	currentTime _ currentTime + (Duration minutes: 300).
	
	self 
		should: [interface checkout: 1 charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:06:01' prior: 50926219!
test12CannotCheckOutCartInactiveFor30min

	| interface catalogue transactionsList creditCard bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	
	currentTime _ currentTime + (Duration minutes: 300).
	
	self 
		should: [interface checkout: cartId charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'GRC 11/8/2021 23:06:02'!
FAILURE!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'GRC 11/8/2021 23:06:49' prior: 50924743!
checkout: aCartId charging: aCreditCard 
	
	| cart cashierToCheckout salesBook total transactionId |
	
	cart _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: cart charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	cartsLastTimeOfModification removeKey: aCartId.
	
	^transactionId.! !

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'GRC 11/8/2021 23:06:59'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:07:15' prior: 50926248!
test12CannotCheckOutCartInactiveFor30min

	| interface catalogue transactionsList creditCard bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 300).
	
	self 
		should: [interface checkout: cartId charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:09:30'!
test13OperationOnCartUpdatesLastModificationTime

	| interface catalogue transactionsList creditCard bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 300).
	
	self 
		should: [interface checkout: cartId charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:12:11' prior: 50926380!
test13OperationOnCartUpdatesLastModificationTime

	| interface catalogue transactionsList creditCard bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: (interface listCart: cartId size).
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:12:24' prior: 50926409!
test13OperationOnCartUpdatesLastModificationTime

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: (interface listCart: cartId size).
	
	! !

!testRun: #TusLibrosInterfaceTest #test13OperationOnCartUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:12:26'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:12:47' prior: 50926435!
test13OperationOnCartUpdatesLastModificationTime

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	! !

!testRun: #TusLibrosInterfaceTest #test13OperationOnCartUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:12:48'!
ERROR!
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 23:13:45' prior: 50923245!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	
	self assertActiveCart: aCartId.
	
	cartsLastTimeOfModification at: aCartId put: restApi currentTime.
	cart _ carts at: aCartId.
	cart add: anAmount of: anItem.
	! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 23:13:57' prior: 50926491!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	
	self assertActiveCart: aCartId.
	
	cartsLastTimeOfModification at: aCartId put: (restApi currentTime).
	cart _ carts at: aCartId.
	cart add: anAmount of: anItem.
	! !

!testRun: #TusLibrosInterfaceTest #test13OperationOnCartUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:14:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 23:14:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 23:14:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 23:14:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 23:14:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 23:14:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:14:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 23:14:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 23:14:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 23:14:12'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 23:14:12'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 23:14:12'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'GRC 11/8/2021 23:14:12'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13OperationOnCartUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:14:12'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:14:26' prior: 50926463!
test13OperationOnCartUpdatesLastModificationTime

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 32).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	! !

!testRun: #TusLibrosInterfaceTest #test13OperationOnCartUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:14:26'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:14:34' prior: 50926564!
test13OperationOnCartUpdatesLastModificationTime

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	! !

!testRun: #TusLibrosInterfaceTest #test13OperationOnCartUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13OperationOnCartUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:14:35'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:15:21'!
test14CartInactiveFor30minGetsDeleted

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:15:43'!
test13AddToCartOperationUpdatesLastModificationTime

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	! !

!methodRemoval: TusLibrosInterfaceTest #test13OperationOnCartUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:15:43'!
test13OperationOnCartUpdatesLastModificationTime

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:16:02'!
test16CartInactiveFor30minGetsDeleted

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	! !

!methodRemoval: TusLibrosInterfaceTest #test14CartInactiveFor30minGetsDeleted stamp: 'GRC 11/8/2021 23:16:02'!
test14CartInactiveFor30minGetsDeleted

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:16:15'!
test15CartInactiveFor30minGetsDeleted

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	! !

!methodRemoval: TusLibrosInterfaceTest #test16CartInactiveFor30minGetsDeleted stamp: 'GRC 11/8/2021 23:16:15'!
test16CartInactiveFor30minGetsDeleted

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:16:27'!
test14ListCartOperationUpdatesLastModificationTime

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:16:44' prior: 50926831!
test14ListCartOperationUpdatesLastModificationTime

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface listCart: cartId.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:16:58' prior: 50926855!
test14ListCartOperationUpdatesLastModificationTime

	| interface catalogue transactionsList cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface listCart: cartId.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	! !

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:16:58'!
ERROR!
!TusLibrosInterface methodsFor: 'operations' stamp: 'GRC 11/8/2021 23:17:16' prior: 50923555!
listCart: aCartId 

	| cart |
	
	cart _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	cartsLastTimeOfModification at: aCartId put: (restApi currentTime).
	
	^cart items.! !

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:17:20'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:17:29' prior: 50926878!
test14ListCartOperationUpdatesLastModificationTime

	| interface catalogue transactionsList cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface listCart: cartId.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 0 equals: ((interface listCart: cartId) size).
	
	! !

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15CartInactiveFor30minGetsDeleted stamp: 'GRC 11/8/2021 23:17:30'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:18:21' prior: 50926784!
test15CartInactiveFor30minGetsDeleted

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	self assert: 0 equals: (interface listCart: cartId).
	
	currentTime _ currentTime + (Duration minutes: 32).
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:18:28' prior: 50926998!
test15CartInactiveFor30minGetsDeleted

	| interface catalogue transactionsList cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	self assert: 0 equals: (interface listCart: cartId).
	
	currentTime _ currentTime + (Duration minutes: 32).
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:18:53' prior: 50927018!
test15CartInactiveFor30minGetsDeleted

	| interface catalogue transactionsList cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	self assert: 0 equals: (interface listCart: cartId).
	
	currentTime _ currentTime + (Duration minutes: 32).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText]
	
	! !

!testRun: #TusLibrosInterfaceTest #test15CartInactiveFor30minGetsDeleted stamp: 'GRC 11/8/2021 23:19:17'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:19:29' prior: 50927036!
test15CartInactiveFor30minGetsDeleted

	| interface catalogue transactionsList cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	self assert: Bag new equals: (interface listCart: cartId).
	
	currentTime _ currentTime + (Duration minutes: 32).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText]
	
	! !

!testRun: #TusLibrosInterfaceTest #test15CartInactiveFor30minGetsDeleted stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15CartInactiveFor30minGetsDeleted stamp: 'GRC 11/8/2021 23:19:31'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'GRC 11/8/2021 23:20:45' prior: 50927064!
test15CartInactiveFor30minGetsDeleted

	| interface catalogue transactionsList cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	self assert: Bag new equals: (interface listCart: cartId).
	
	currentTime _ currentTime + (Duration minutes: 32).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText]
	
	! !

!methodRemoval: TusLibrosInterfaceTest #test15CartInactiveFor30minGetsDeleted stamp: 'GRC 11/8/2021 23:22:57'!
test15CartInactiveFor30minGetsDeleted

	| interface catalogue transactionsList cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	self assert: Bag new equals: (interface listCart: cartId).
	
	currentTime _ currentTime + (Duration minutes: 32).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText]
	
	!

----SNAPSHOT----(8 November 2021 23:26:28) CuisUniversity-4913.image priorSource: 18980952!

----SNAPSHOT----(8 November 2021 23:26:59) CuisUniversity-4913.image priorSource: 19057425!

----SNAPSHOT----(8 November 2021 23:27:28) CuisUniversity-4913.image priorSource: 19057518!

----QUIT----(8 November 2021 23:27:35) CuisUniversity-4913.image priorSource: 19057611!

----STARTUP---- (9 November 2021 15:15:07) as /home/ryan/UBA/Ing1/cuis2/CuisUniversity-4913.image!


!classRemoval: #Cart stamp: 'RI 11/9/2021 15:15:21'!
Object subclass: #Cart
	instanceVariableNames: 'books'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTests stamp: 'RI 11/9/2021 15:15:22'!
TestCase subclass: #CartTests
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /home/ryan/UBA/Ing1/isw1-ejercicios/20-TusLibros/it4/TusLibros.st----!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:18:37' prior: 50920856!
listCart: aCartId 

	| cartInformation |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	(carts at: aCartId) at: #lastTimeOfModification put: (restApi currentTime).
	
	^cartInformation items.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:19:09' prior: 50920918!
listCart: aCartId 

	| cartInformation |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	(carts at: aCartId) at: #lastTimeOfModification put: (restApi currentTime).
	
	^cartInformation at: #cart items.! !
!TusLibrosInterface methodsFor: 'initialization' stamp: 'RI 11/9/2021 15:19:17' prior: 50920867!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	nextCartId _ 0.
	carts _ Dictionary new.
	catalogue _ aCatalogue.
	transactionsList _ aTransactionList.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:21:22' prior: 50920844!
createCartFor: aUsername with: aPassword

	| cart cartInformation |
	restApi login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ Dictionary new.
	cartInformation add: #cart->cart; add: #lastTimeOfModification->DateAndTime now
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:21:29' prior: 50920953!
createCartFor: aUsername with: aPassword

	| cart cartInformation |
	restApi login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ Dictionary new.
	cartInformation add: #cart->cart; add: #lastTimeOfModification->DateAndTime now.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !

Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts restApi transactionsList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'RI 11/9/2021 15:21:33'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts restApi transactionsList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:21:47' prior: 50920968!
createCartFor: aUsername with: aPassword

	| cart cartInformation |
	restApi login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ Dictionary new.
	cartInformation 
		add: #cart->cart;
		add: #lastTimeOfModification->DateAndTime now.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:23:09' prior: 50920822!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation at: #cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'RI 11/9/2021 15:23:39' prior: 50920878!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - ((carts at: aCartId) at: #lastTimeOfModification)) totalMinutes.
	dif > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:24:37' prior: 50920812!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	
	self assertActiveCart: aCartId.
	
	(carts at: aCartId) at: #lastTimeOfModification put: (restApi currentTime).
	cart _ (carts at: aCartId) at: #cart.
	cart add: anAmount of: anItem.
	! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 15:24:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:24:43'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 15:24:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 15:24:43'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 15:24:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 15:24:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 15:24:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 15:24:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 15:24:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 15:24:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 15:24:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 15:24:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:24:43'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:24:43'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:24:56'!
ERROR!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:25:32' prior: 50920930!
listCart: aCartId 

	| cartInformation |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	(carts at: aCartId) at: #lastTimeOfModification put: (restApi currentTime).
	
	^(cartInformation at: #cart) items.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:25:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:25:33'!
PASSED!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:31:04' prior: 50921045!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	
	self assertActiveCart: aCartId.
	(carts at: aCartId) at: #lastTimeOfModification put: (restApi currentTime).
	
	cart _ (carts at: aCartId) at: #cart.
	cart add: anAmount of: anItem.
	! !

Object subclass: #CartInterface
	instanceVariableNames: 'cart modifiedAt'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartInterface category: 'TusLibros' stamp: 'RI 11/9/2021 15:32:09'!
Object subclass: #CartInterface
	instanceVariableNames: 'cart modifiedAt'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:33:25' prior: 50920997!
createCartFor: aUsername with: aPassword

	| cart cartInformation |
	restApi login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ Dictionary new.
	cartInformation 
		add: #cart->cart;
		add: #lastTimeOfModification->restApi now.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 15:33:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:33:26'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 15:33:26'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 15:33:26'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 15:33:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 15:33:26'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 15:33:26'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 15:33:26'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 15:33:26'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 15:33:26'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 15:33:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 15:33:26'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:33:26'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:33:26'!
ERROR!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:33:59' prior: 50921196!
createCartFor: aUsername with: aPassword

	| cart cartInformation |
	restApi login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ Dictionary new.
	cartInformation 
		add: #cart->cart;
		add: #lastTimeOfModification->restApi today.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:34:14' prior: 50921261!
createCartFor: aUsername with: aPassword

	| cart cartInformation |
	restApi login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ Dictionary new.
	cartInformation 
		add: #cart->cart;
		add: #lastTimeOfModification->restApi today.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !
!TusLibrosInterfaceTest methodsFor: 'restApi' stamp: 'RI 11/9/2021 15:34:32' prior: 50920487!
today
	
	^DateAndTime now.! !
!TusLibrosInterfaceTest methodsFor: 'restApi' stamp: 'RI 11/9/2021 15:34:55'!
now
	
	^DateAndTime now.! !

!methodRemoval: TusLibrosInterfaceTest #today stamp: 'RI 11/9/2021 15:34:55'!
today
	
	^DateAndTime now.!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:35:14' prior: 50921276!
createCartFor: aUsername with: aPassword

	| cart cartInformation |
	restApi login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ Dictionary new.
	cartInformation 
		add: #cart->cart;
		add: #lastTimeOfModification->restApi now.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 15:35:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:35:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 15:35:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 15:35:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 15:35:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 15:35:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 15:35:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 15:35:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 15:35:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 15:35:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 15:35:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 15:35:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:35:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:35:19'!
PASSED!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:36:14' prior: 50921303!
createCartFor: aUsername with: aPassword

	| cart cartInformation |
	restApi login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ Dictionary new.
	cartInformation 
		add: #cart->cart;
		add: #lastTimeOfModification->restApi currentTime.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !
!TusLibrosInterfaceTest methodsFor: 'restApi' stamp: 'RI 11/9/2021 15:36:25'!
today
	
	^DateAndTime now.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:36:25' prior: 50920130 overrides: 16927572!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	shouldAuthenticate _ true.
	currentTime _ DateAndTime today.
	debitBehaviour _ [:anAmount :aCreditCard |].! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:36:25' prior: 50921295!
now
	
	^DateAndTime today.! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:36:25' prior: 50921384!
today
	
	^DateAndTime today.! !

!methodRemoval: TusLibrosInterfaceTest #now stamp: 'RI 11/9/2021 15:36:25'!
now
	
	^DateAndTime today.!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:36:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:36:30'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'restApi' stamp: 'RI 11/9/2021 15:36:48' prior: 50921403!
today
	
	^DateAndTime today.! !
!TusLibrosInterfaceTest methodsFor: 'restApi' stamp: 'RI 11/9/2021 15:38:52' prior: 50921461!
today
	
	^testObjectsFactory today.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:38:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:38:53'!
PASSED!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:40:10' prior: 50921369!
createCartFor: aUsername with: aPassword

	| cart cartInformation |
	restApi login: aUsername with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ CartInterface cart: cart modifiedAt: restApi currentTime.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:41:30' prior: 50921110!
listCart: aCartId 

	| cartInformation |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	cartInformation modifiedAt: (restApi currentTime).
	
	^cartInformation items.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:41:58' prior: 50921012!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'RI 11/9/2021 15:42:33' prior: 50921035!
assertActiveCart: aCartId
	
	| dif |
	
	dif _ (restApi currentTime - ((carts at: aCartId) modifiedAt)) totalMinutes.
	dif > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'RI 11/9/2021 15:42:51' prior: 50921569!
assertActiveCart: aCartId
	
	| timeDiference |
	
	timeDiference _ (restApi currentTime - ((carts at: aCartId) modifiedAt)) totalMinutes.
	timeDiference > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'RI 11/9/2021 15:43:00' prior: 50921579!
assertActiveCart: aCartId
	
	| timeDifference |
	
	timeDifference _ (restApi currentTime - ((carts at: aCartId) modifiedAt)) totalMinutes.
	timeDifference > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:43:21' prior: 50921173!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	
	self assertActiveCart: aCartId.
	(carts at: aCartId) modifiedAt: (restApi currentTime).
	
	cart _ (carts at: aCartId) cart.
	cart add: anAmount of: anItem.
	! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 15:43:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:43:31'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 15:43:31'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 15:43:31'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 15:43:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 15:43:31'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 15:43:31'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 15:43:31'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 15:43:31'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 15:43:31'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 15:43:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 15:43:31'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:43:31'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:43:31'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:43:34'!
ERROR!
!CartInterface class methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:43:45'!
cart: aCart modifiedAt: aDateAndTime 
	self shouldBeImplemented.! !
!CartInterface class methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:45:03' prior: 50921664!
cart: aCart modifiedAt: aDateAndTime
	
	^self new initializeWIthCart: aCart modifiedAt: aDateAndTime.! !
!CartInterface class methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:45:11' prior: 50921670!
cart: aCart modifiedAt: aDateAndTime
	
	^self new initializeWithCart: aCart modifiedAt: aDateAndTime.! !

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:45:13'!
ERROR!

!classDefinition: #CartInterface category: 'TusLibros' stamp: 'RI 11/9/2021 15:45:18'!
Object subclass: #CartInterface
	instanceVariableNames: 'cart modifiedAt dateAndTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartInterface methodsFor: 'initialization' stamp: 'RI 11/9/2021 15:45:18'!
initializeWithCart: aCart modifiedAt: aDateAndTime 
	self shouldBeImplemented.
	cart := aCart.
	dateAndTime := aDateAndTime.! !
!CartInterface methodsFor: 'initialization' stamp: 'RI 11/9/2021 15:45:36' prior: 50921694!
initializeWithCart: aCart modifiedAt: aDateAndTime 
	
	cart _ aCart.
	modifiedAt _ aDateAndTime.! !

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:45:38'!
ERROR!
!CartInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:45:42'!
modifiedAt
	self shouldBeImplemented.
	^modifiedAt! !
!CartInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:45:49' prior: 50921711!
modifiedAt

	^modifiedAt! !

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:45:54'!
ERROR!
!CartInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:45:59'!
modifiedAt: aDateAndTime 
	self shouldBeImplemented.
	modifiedAt _ aDateAndTime! !
!CartInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:46:04' prior: 50921723!
modifiedAt: aDateAndTime 

	modifiedAt _ aDateAndTime! !

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:46:05'!
ERROR!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 15:46:29' prior: 50921534!
listCart: aCartId 

	| cartInformation |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	cartInformation modifiedAt: (restApi currentTime).
	
	^cartInformation cart items.! !

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:46:32'!
ERROR!
!CartInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:46:38'!
cart
	self shouldBeImplemented.
	^cart! !
!CartInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:46:40' prior: 50921753!
cart

	^cart! !

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:46:42'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 15:46:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 15:46:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 15:46:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 15:46:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 15:46:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 15:46:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 15:46:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 15:46:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:46:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:46:50'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 15:54:08'!
test15

	| interface catalogue transactionsList purchases |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	purchases _ interface listPurchases for: 'Guido' with: '123456'.
	
	self assert: purchases size equals: 0.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 15:54:22' prior: 50921801!
test15

	| interface catalogue transactionsList purchases |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: purchases size equals: 0.! !

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 15:54:23'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:54:30'!
listPurchasesFor: aString with: aString2 
	self shouldBeImplemented.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 15:54:58' prior: 50921833!
listPurchasesFor: aClientId with: aPassword 
	
	^OrderedCollection new.! !

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 15:55:00'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 15:55:00'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 15:56:21'!
test16

	| interface catalogue transactionsList purchases cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: purchases size equals: 0.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 15:56:30' prior: 50921900!
test16

	| interface catalogue transactionsList purchases cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: purchases size equals: 0.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 15:57:03' prior: 50921917!
test16

	| interface catalogue transactionsList purchases cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: purchases size equals: 0.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 15:58:58' prior: 50921934!
test16

	| interface catalogue transactionsList purchases cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: purchases size equals: 2.
	self assert: purchases first equals: bookIsbn.
	self assert: (purchases at: 2) equals: 10.! !

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 15:58:59'!
FAILURE!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:00:30' prior: 50921839!
listPurchasesFor: aClientId with: aPassword 
	
	| amount isbn purchases |
	purchases _ OrderedCollection new.
	
	purchases add: isbn add: amount.
	
	^purchases.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:01:14' prior: 50921981!
listPurchasesFor: aClientId with: aPassword 
	
	| amount isbn purchases |
	purchases _ OrderedCollection new.
	
	purchases add: isbn add: amount.
	
	^purchases.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 16:05:27' prior: 50921546!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
		
	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 16:06:32' prior: 50921520!
createCartFor: aClientId with: aPassword

	| cart cartInformation |
	restApi login: aClientId with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !
!CartInterface class methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:06:57'!
cart: aCart modifiedAt: aDateAndTime for: aClientId
	
	^self new initializeWithCart: aCart modifiedAt: aDateAndTime for: aClientId.! !

!methodRemoval: CartInterface class #cart:modifiedAt: stamp: 'RI 11/9/2021 16:07:00'!
cart: aCart modifiedAt: aDateAndTime
	
	^self new initializeWithCart: aCart modifiedAt: aDateAndTime.!

!classDefinition: #CartInterface category: 'TusLibros' stamp: 'RI 11/9/2021 16:07:21'!
Object subclass: #CartInterface
	instanceVariableNames: 'cart modifiedAt dateAndTime clientId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartInterface methodsFor: 'initialization' stamp: 'RI 11/9/2021 16:07:18'!
initializeWithCart: aCart modifiedAt: aDateAndTime for: aClientId
	
	clientId _ aClientId.
	cart _ aCart.
	modifiedAt _ aDateAndTime.! !

!methodRemoval: CartInterface #initializeWithCart:modifiedAt: stamp: 'RI 11/9/2021 16:07:28'!
initializeWithCart: aCart modifiedAt: aDateAndTime 
	
	cart _ aCart.
	modifiedAt _ aDateAndTime.!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 16:08:10' prior: 50921999!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
		
	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!CartInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:08:26'!
clientId

	^clientId! !
!CartInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:08:27' prior: 50922093!
clientId

	^clientId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 16:10:37' prior: 50922071!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId purchases |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	(purchases at: (cartInformation clientId)) add: (cartInformation cart items).

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !

!classDefinition: 'TusLibrosInterface class' category: 'TusLibros' stamp: 'RI 11/9/2021 16:11:16'!
TusLibrosInterface class
	instanceVariableNames: 'clientsPurchases'!

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'RI 11/9/2021 16:11:39'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts restApi transactionsList clientsPurchases'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 16:11:37' prior: 50922101!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	(clientsPurchases at: (cartInformation clientId)) add: (cartInformation cart items).

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !

TusLibrosInterface class
	instanceVariableNames: ''!

!classDefinition: 'TusLibrosInterface class' category: 'TusLibros' stamp: 'RI 11/9/2021 16:12:13'!
TusLibrosInterface class
	instanceVariableNames: ''!
!TusLibrosInterface methodsFor: 'initialization' stamp: 'RI 11/9/2021 16:12:29' prior: 50920943!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	nextCartId _ 0.
	carts _ Dictionary new.
	clientsPurchases _ Dictionary new.
	catalogue _ aCatalogue.
	transactionsList _ aTransactionList.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:15:53' prior: 50921990!
listPurchasesFor: aClientId with: aPassword 
	
	| purchases clientPurchases |
	purchases _ OrderedCollection new.
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	"purchases add: (clientPurchases first)."
	
	^clientsPurchases asOrderedCollection.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:16:01'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:16:01'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:16:01'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:16:01'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:16:01'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:16:01'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:16:01'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:16:01'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:16:01'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:16:01'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:16:01'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:16:01'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:16:01'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:16:01'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:16:01'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:16:01'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:16:14'!
ERROR!
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 16:17:17' prior: 50922141!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	(clientsPurchases at: (cartInformation clientId)) add: (cartInformation cart items).

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'RI 11/9/2021 16:18:55' prior: 50922022!
createCartFor: aClientId with: aPassword

	| cart cartInformation |
	restApi login: aClientId with: aPassword.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:19:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:19:06'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:19:06'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:19:17'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:19:35'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:20:00' prior: 50922184!
listPurchasesFor: aClientId with: aPassword 
	
	| purchases clientPurchases |
	purchases _ OrderedCollection new.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	"purchases add: (clientPurchases first)."
	
	^clientsPurchases asOrderedCollection.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:20:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:20:16'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:20:16'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:20:19'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:20:42' prior: 50921816!
test15

	| interface catalogue transactionsList purchases |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 0 equals: purchases size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:21:03' prior: 50921955!
test16

	| interface catalogue transactionsList purchases cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 2 equals: purchases size.
	self assert: bookIsbn equals: purchases first.
	self assert: 10 equals: (purchases at: 2).! !

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:21:04'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:21:09'!
FAILURE!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:21:37' prior: 50922359!
listPurchasesFor: aClientId with: aPassword 
	
	| purchases clientPurchases |
	purchases _ OrderedCollection new.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	"purchases add: (clientPurchases first)."
	
	^clientPurchases asOrderedCollection.! !

clientPurchases asOrderedCollection!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:21:58'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:21:58'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:21:58'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:22:09'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:23:17' prior: 50922447!
test16

	| interface catalogue transactionsList purchases cartId bookIsbn |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 2 equals: purchases size.
	self assert: bookIsbn equals: purchases first.
	self assert: 10 equals: (purchases at: 2).! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:23:44' prior: 50920284!
test08CheckingOutAValidCartRegistersTransaction

	| interface catalogue cartId bookIsbn transactionId transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transactionId _ interface checkout: cartId charging: creditCard.
	
	self assert: transactionId equals: transactionsList first.
	self assert: 1 equals: transactionsList size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:23:50' prior: 50922555!
test16

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard transactionId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	transactionId _ interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 2 equals: purchases size.
	self assert: bookIsbn equals: purchases first.
	self assert: 10 equals: (purchases at: 2).! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:24:02' prior: 50922607!
test16

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard transactionId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	transactionId _ interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 2 equals: purchases size.
	self assert: bookIsbn equals: purchases first.
	self assert: 10 equals: (purchases at: 2).! !

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:24:15'!
FAILURE!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:25:29' prior: 50922476!
listPurchasesFor: aClientId with: aPassword 
	
	| purchases clientPurchases |
	purchases _ OrderedCollection new.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	"purchases add: (clientPurchases first)."
	
	^clientPurchases first asOrderedCollection.! !

clientPurchases first!

clientPurchases first asOrderedCollection!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:26:19' prior: 50922666!
listPurchasesFor: aClientId with: aPassword 
	
	| purchases clientPurchases |
	purchases _ OrderedCollection new.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	"purchases add: (clientPurchases first)."
	
	^clientPurchases first asOrderedCollection.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:29:33' prior: 50922683!
listPurchasesFor: aClientId with: aPassword 
	
	| purchases clientPurchases result |
	purchases _ OrderedCollection new.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	"purchases add: (clientPurchases first)."
	
	result _ OrderedCollection new.
	clientPurchases first do: [:aBookIsbn | result add: aBookIsbn add: (clientPurchases first occurrencesOf: aBookIsbn)]
	
	^result.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:29:40' prior: 50922698!
listPurchasesFor: aClientId with: aPassword 
	
	| purchases clientPurchases result |
	purchases _ OrderedCollection new.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	"purchases add: (clientPurchases first)."
	
	result _ OrderedCollection new.
	clientPurchases first do: [:aBookIsbn | result add: aBookIsbn add: (clientPurchases first occurrencesOf: aBookIsbn)].
	
	^result.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:29:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:29:49'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:29:49'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:30:08' prior: 50922717!
listPurchasesFor: aClientId with: aPassword 
	
	| purchases clientPurchases result |
	purchases _ OrderedCollection new.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	"purchases add: (clientPurchases first)."
	
	result _ OrderedCollection new.
	clientPurchases first do: [:aBookIsbn | result add: aBookIsbn; add: (clientPurchases first occurrencesOf: aBookIsbn)].
	
	^result.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:30:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:30:11'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:30:11'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:30:26'!
FAILURE!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:33:34' prior: 50922792!
listPurchasesFor: aClientId with: aPassword 
	
	| purchases clientPurchases result |
	purchases _ OrderedCollection new.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	"purchases add: (clientPurchases first)."
	
	result _ OrderedCollection new.
	clientPurchases first asSet do: [:aBookIsbn | result add: aBookIsbn; add: (clientPurchases first occurrencesOf: aBookIsbn)].
	
	^result.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:33:38'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:33:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:33:38'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:34:12' prior: 50922870!
listPurchasesFor: aClientId with: aPassword 
	
	| purchases clientPurchases result |
	purchases _ OrderedCollection new.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	"purchases add: (clientPurchases first)."
	
	result _ OrderedCollection new.
	clientPurchases  size > 0 ifTrue: [
		clientPurchases first asSet do: [:aBookIsbn | result add: aBookIsbn; add: (clientPurchases first occurrencesOf: aBookIsbn)].
	]
	
	^result.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:34:20' prior: 50922948!
listPurchasesFor: aClientId with: aPassword 
	
	| purchases clientPurchases result |
	purchases _ OrderedCollection new.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ OrderedCollection new.
	clientPurchases  size > 0 ifTrue: [
		clientPurchases first asSet do: [:aBookIsbn | result add: aBookIsbn; add: (clientPurchases first occurrencesOf: aBookIsbn)].
	]
	
	^result.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:34:26' prior: 50922968!
listPurchasesFor: aClientId with: aPassword 
	
	| purchases clientPurchases result |
	purchases _ OrderedCollection new.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ OrderedCollection new.
	clientPurchases  size > 0 ifTrue: [
		clientPurchases first asSet do: [:aBookIsbn | result add: aBookIsbn; add: (clientPurchases first occurrencesOf: aBookIsbn)].
	].
	
	^result.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:34:34' prior: 50922987!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ OrderedCollection new.
	clientPurchases  size > 0 ifTrue: [
		clientPurchases first asSet do: [:aBookIsbn | result add: aBookIsbn; add: (clientPurchases first occurrencesOf: aBookIsbn)].
	].
	
	^result.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:34:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:34:35'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:35:22'!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard transactionId bookIsbn2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	bookIsbn2 _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	transactionId _ interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 2 equals: purchases size.
	self assert: bookIsbn equals: purchases first.
	self assert: 10 equals: (purchases at: 2).
	self assert: bookIsbn2 equals: purchases at: 3.
	self assert: 10 equals: (purchases at: 4).! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:36:10' prior: 50923079!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard transactionId bookIsbn2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	bookIsbn2 _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface addToCart: cartId item: bookIsbn2 amount: 10.
	transactionId _ interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 2 equals: purchases size.
	self assert: bookIsbn equals: (purchases at: 1).
	self assert: 10 equals: (purchases at: 2).
	self assert: bookIsbn2 equals: (purchases at: 3).
	self assert: 10 equals: (purchases at: 4).! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'RI 11/9/2021 16:36:39'!
itemSellByTheStore2
	
	^ 'validBook2'! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'RI 11/9/2021 16:36:52'!
itemSellByTheStorePrice2
	
	^12! !
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'RI 11/9/2021 16:37:20' prior: 50920766!
defaultCatalog
	
	^ Dictionary new
		at: self itemSellByTheStore put: self itemSellByTheStorePrice;
		at: self itemSellByTheStore2 put: self itemSellByTheStorePrice2;
		yourself ! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:37:49' prior: 50923112!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard transactionId bookIsbn2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	bookIsbn2 _ testObjectsFactory itemSellByTheStore2.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface addToCart: cartId item: bookIsbn2 amount: 5.
	transactionId _ interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 2 equals: purchases size.
	self assert: bookIsbn equals: (purchases at: 1).
	self assert: 10 equals: (purchases at: 2).
	self assert: bookIsbn2 equals: (purchases at: 3).
	self assert: 5 equals: (purchases at: 4).! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:37:57' prior: 50923163!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard bookIsbn2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	bookIsbn2 _ testObjectsFactory itemSellByTheStore2.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface addToCart: cartId item: bookIsbn2 amount: 5.
	interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 2 equals: purchases size.
	self assert: bookIsbn equals: (purchases at: 1).
	self assert: 10 equals: (purchases at: 2).
	self assert: bookIsbn2 equals: (purchases at: 3).
	self assert: 5 equals: (purchases at: 4).! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:38:03'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:38:36' prior: 50923198!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard bookIsbn2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	bookIsbn2 _ testObjectsFactory itemSellByTheStore2.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface addToCart: cartId item: bookIsbn2 amount: 5.
	interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 4 equals: purchases size.
	self assert: bookIsbn equals: (purchases at: 1).
	self assert: 10 equals: (purchases at: 2).
	self assert: bookIsbn2 equals: (purchases at: 3).
	self assert: 5 equals: (purchases at: 4).! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:38:37'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:39:03' prior: 50923234!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard bookIsbn2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	bookIsbn2 _ testObjectsFactory itemSellByTheStore2.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface addToCart: cartId item: bookIsbn2 amount: 5.
	interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 4 equals: purchases size.
	self assert: bookIsbn2 equals: (purchases at: 1).
	self assert: 5 equals: (purchases at: 2).
	self assert: bookIsbn equals: (purchases at: 3).
	self assert: 10 equals: (purchases at: 4).! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:39:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:39:14'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:39:14'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:40:27' prior: 50923270!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard cartId2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.
	
	cartId2 _ interface createCartFor: 'Migue' with: '123456'.
	interface addToCart: cartId2 item: bookIsbn amount: 5.
	interface checkout: cartId2 charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Migue' with: '123456'.
	
	self assert: 4 equals: purchases size.
	self assert: bookIsbn equals: (purchases at: 3).
	self assert: 10 equals: (purchases at: 4).! !

!methodRemoval: StoreTestObjectsFactory #itemSellByTheStore2 stamp: 'RI 11/9/2021 16:40:38'!
itemSellByTheStore2
	
	^ 'validBook2'!

!methodRemoval: StoreTestObjectsFactory #itemSellByTheStorePrice2 stamp: 'RI 11/9/2021 16:40:41'!
itemSellByTheStorePrice2
	
	^12!
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'RI 11/9/2021 16:40:45' prior: 50923154!
defaultCatalog
	
	^ Dictionary new
		at: self itemSellByTheStore put: self itemSellByTheStorePrice;
		yourself ! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:41:05' prior: 50923426!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard cartId2 purchases2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.
	
	cartId2 _ interface createCartFor: 'Migue' with: '123456'.
	interface addToCart: cartId2 item: bookIsbn amount: 5.
	interface checkout: cartId2 charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Migue' with: '123456'.
	purchases2 _ interface listPurchasesFor: 'Migue' with: '123456'.
	
	self assert: 4 equals: purchases size.
	self assert: bookIsbn equals: (purchases at: 3).
	self assert: 10 equals: (purchases at: 4).! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:41:30' prior: 50923474!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard cartId2 purchasesGuido purchasesMigue |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.
	
	cartId2 _ interface createCartFor: 'Migue' with: '123456'.
	interface addToCart: cartId2 item: bookIsbn amount: 5.
	interface checkout: cartId2 charging: creditCard.
	
	purchasesGuido _ interface listPurchasesFor: 'Guido' with: '123456'.
	purchasesMigue _ interface listPurchasesFor: 'Migue' with: '123456'.
	
	self assert: 4 equals: purchases size.
	self assert: bookIsbn equals: (purchases at: 3).
	self assert: 10 equals: (purchases at: 4).! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:37:57' prior: 50923509!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard bookIsbn2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	bookIsbn2 _ testObjectsFactory itemSellByTheStore2.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface addToCart: cartId item: bookIsbn2 amount: 5.
	interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 2 equals: purchases size.
	self assert: bookIsbn equals: (purchases at: 1).
	self assert: 10 equals: (purchases at: 2).
	self assert: bookIsbn2 equals: (purchases at: 3).
	self assert: 5 equals: (purchases at: 4).! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:44:27' prior: 50923545!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard bookIsbn2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	bookIsbn2 _ testObjectsFactory itemSellByTheStore2.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.

	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 5.
	interface checkout: cartId charging: creditCard.

	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 2 equals: purchases size.
	self assert: bookIsbn equals: (purchases at: 1).
	self assert: 15 equals: (purchases at: 2).! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:44:43' prior: 50923579!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.

	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 5.
	interface checkout: cartId charging: creditCard.

	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 2 equals: purchases size.
	self assert: bookIsbn equals: (purchases at: 1).
	self assert: 15 equals: (purchases at: 2).! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:44:55'!
FAILURE!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:45:50' prior: 50923006!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ OrderedCollection new.
	clientPurchases size > 0 ifTrue: [
		clientPurchases do: [:aPurchase | aPurchase asSet do: [:aBookIsbn | result add: aBookIsbn; add: (clientPurchases first occurrencesOf: aBookIsbn)]].
	].
	
	^result.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:46:08' prior: 50923648!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ OrderedCollection new.
	clientPurchases size > 0 ifTrue: [
		clientPurchases do: [:aPurchase | 
			aPurchase asSet do: [:aBookIsbn | 
				result add: aBookIsbn; add: (clientPurchases first occurrencesOf: aBookIsbn)
			]
		].
	].
	
	^result.! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:46:11'!
FAILURE!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:50:04' prior: 50923666!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ Dictionary new.
	clientPurchases size = 0 ifTrue: [^OrderedCollection new].

	clientPurchases do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			(result at: aBookIsbn put: ((result at: aBookIsbn) + clientPurchases first occurrencesOf: aBookIsbn)) ifAbsent: [
				result add: aBookIsbn-> (clientPurchases first occurrencesOf: aBookIsbn)
			]
		]
	].
	
	^result.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:51:03' prior: 50923687!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ Dictionary new.
	clientPurchases size = 0 ifTrue: [^OrderedCollection new].

	clientPurchases do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			(result at: aBookIsbn ifAbsent: [
				result add: aBookIsbn-> (clientPurchases first occurrencesOf: aBookIsbn)
			]) put: ((result at: aBookIsbn) + clientPurchases first occurrencesOf: aBookIsbn)
		]
	].
	
	^result.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:51:06'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:51:06'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:51:06'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:52:50' prior: 50923710!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ Dictionary new.
	clientPurchases size = 0 ifTrue: [^OrderedCollection new].

	clientPurchases do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			(result at: aBookIsbn ifAbsent: [
				result add: aBookIsbn-> (clientPurchases first occurrencesOf: aBookIsbn)
			]) put: ((result at: aBookIsbn) + clientPurchases first occurrencesOf: aBookIsbn)
		]
	].
	
	^result.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:54:09' prior: 50923791!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ Dictionary new.
	clientPurchases size = 0 ifTrue: [^OrderedCollection new].

	clientPurchases do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + clientPurchases first occurrencesOf: aBookIsbn)
		]
	].
	
	^result.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:54:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:54:10'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:54:11'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:54:17'!
ERROR!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:56:02' prior: 50923814!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ Dictionary new.
	clientPurchases size = 0 ifTrue: [^OrderedCollection new].

	clientPurchases do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + aPurchase occurrencesOf: aBookIsbn).
		]
	].
	
	^result.! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'RI 11/9/2021 16:56:25' prior: 50923897!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ Dictionary new.
	clientPurchases size = 0 ifTrue: [^OrderedCollection new].

	clientPurchases do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].
	
	^result.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:56:26'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:56:26'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:56:26'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:56:29'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:57:49' prior: 50922635!
test16

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard transactionId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	transactionId _ interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 1 equals: purchases keys size.
	self assert: 10 equals: (purchases at: bookIsbn).! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:58:12' prior: 50923613!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.

	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 5.
	interface checkout: cartId charging: creditCard.

	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 2 equals: purchases keys size.
	self assert: 15 equals: (purchases at: bookIsbn).! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:58:16'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'RI 11/9/2021 16:58:22' prior: 50924027!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.

	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 5.
	interface checkout: cartId charging: creditCard.

	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 1 equals: purchases keys size.
	self assert: 15 equals: (purchases at: bookIsbn).! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'RI 11/9/2021 16:58:23'!
PASSED!

----STARTUP---- (11 November 2021 15:04:43) as C:\Users\migue\Desktop\windows64\CuisUniversity-4913.image!


----End fileIn of \Users\migue\Desktop\windows64\TusLibros.st----!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:06:34' prior: 50916015!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ Dictionary new.
	clientPurchases size = 0 ifTrue: [^OrderedCollection new].

	clientPurchases do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].
	
	^result.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:06:52' prior: 50915939!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	(clientsPurchases at: (cartInformation clientId)) add: (cartInformation cart items).

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:07:53' prior: 50916088!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	
	total _ cashierToCheckout checkOut.
	
	(clientsPurchases at: (cartInformation clientId)) add: (cartInformation cart items).

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:08:06' prior: 50915981!
listCart: aCartId 

	| cartInformation |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	cartInformation modifiedAt: (restApi currentTime).
	
	^cartInformation cart items.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:08:08' prior: 50915964!
createCartFor: aClientId with: aPassword

	| cart cartInformation |
	restApi login: aClientId with: aPassword.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:08:21' prior: 50916067!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	restApi login: aClientId with: aPassword.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ Dictionary new.
	clientPurchases size = 0 ifTrue: [^OrderedCollection new].

	clientPurchases do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].
	
	^result.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:08:46' prior: 50915929!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	
	self assertActiveCart: aCartId.
	(carts at: aCartId) modifiedAt: (restApi currentTime).
	
	cart _ (carts at: aCartId) cart.
	cart add: anAmount of: anItem.
	! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'MR 11/11/2021 15:09:59'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'MR 11/11/2021 15:09:59'!
PASSED!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:10:02' prior: 50916150!
createCartFor: aClientId with: aPassword

	| cart cartInformation |
	restApi login: aClientId with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 15:10:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 15:10:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 15:10:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 15:10:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 15:10:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 15:10:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 15:10:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 15:10:02'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 15:10:02'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 15:10:02'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 15:10:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 15:10:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:10:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:10:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15 stamp: 'MR 11/11/2021 15:10:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'MR 11/11/2021 15:10:02'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'MR 11/11/2021 15:10:02'!
ERROR!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:10:09' prior: 50916259!
createCartFor: aClientId with: aPassword

	| cart cartInformation |
	restApi login: aClientId with: aPassword.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:10:18' prior: 50916113!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	total _ cashierToCheckout checkOut.
	
	(clientsPurchases at: (cartInformation clientId)) add: (cartInformation cart items).

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:11:05' prior: 50915456!
test15

	| interface catalogue transactionsList purchases |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 0 equals: purchases size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:11:07' prior: 50915471!
test16

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard transactionId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	transactionId _ interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 1 equals: purchases keys size.
	self assert: 10 equals: (purchases at: bookIsbn).! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:11:16' prior: 50916389!
test16

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 1 equals: purchases keys size.
	self assert: 10 equals: (purchases at: bookIsbn).! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:11:24' prior: 50915498!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.

	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 5.
	interface checkout: cartId charging: creditCard.

	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 1 equals: purchases keys size.
	self assert: 15 equals: (purchases at: bookIsbn).! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'MR 11/11/2021 15:12:04' prior: 50916004!
assertActiveCart: aCartId
	
	| timeDifference |
	
	timeDifference _ (restApi currentTime - ((carts at: aCartId) modifiedAt)) totalMinutes.
	timeDifference > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterface methodsFor: 'initialization' stamp: 'MR 11/11/2021 15:12:56' prior: 50915993!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	nextCartId _ 0.
	carts _ Dictionary new.
	clientsPurchases _ Dictionary new.
	catalogue _ aCatalogue.
	transactionsList _ aTransactionList.! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'MR 11/11/2021 15:14:39' prior: 50916473!
assertActiveCart: aCartId
	
	"(carts at: aCartId) isActive: restApi currentTime."
	
	| timeDifference |
	
	timeDifference _ (restApi currentTime - ((carts at: aCartId) modifiedAt)) totalMinutes.
	timeDifference > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:15:19'!
test15ListClientPurchasesWithoutCheckoutsIsEmpty

	| interface catalogue transactionsList purchases |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 0 equals: purchases size.! !

!methodRemoval: TusLibrosInterfaceTest #test15 stamp: 'MR 11/11/2021 15:15:19'!
test15

	| interface catalogue transactionsList purchases |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 0 equals: purchases size.!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:15:29' prior: 50916507!
test15ListClientPurchasesWithoutCheckoutsIsEmpty

	| interface catalogue transactionsList purchases |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: purchases isEmpty.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:15:41' prior: 50916537!
test15ListClientPurchasesWithoutCheckoutsIsEmpty

	| interface catalogue transactionsList purchases |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: purchases keys isEmpty! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:15:42' prior: 50916553!
test15ListClientPurchasesWithoutCheckoutsIsEmpty

	| interface catalogue transactionsList purchases |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: purchases keys isEmpty.! !

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 15:15:43'!
ERROR!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:15:50' prior: 50916569!
test15ListClientPurchasesWithoutCheckoutsIsEmpty

	| interface catalogue transactionsList purchases |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: purchases isEmpty.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:16:02' prior: 50916589!
test15ListClientPurchasesWithoutCheckoutsIsEmpty

	| interface catalogue transactionsList purchases |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: purchases keys isEmpty.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:16:17' prior: 50916167!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	restApi login: aClientId with: aPassword.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ Dictionary new.
	clientPurchases size = 0 ifTrue: [^result].

	clientPurchases do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].
	
	^result.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:16:20' prior: 50916621!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	restApi login: aClientId with: aPassword.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ Dictionary new.

	clientPurchases do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].
	
	^result.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16 stamp: 'MR 11/11/2021 15:16:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'MR 11/11/2021 15:16:23'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:16:57'!
test16ListClientPurchasesHasCorrectPurchases

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 1 equals: purchases keys size.
	self assert: 10 equals: (purchases at: bookIsbn).! !

!methodRemoval: TusLibrosInterfaceTest #test16 stamp: 'MR 11/11/2021 15:16:57'!
test16

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.
	
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 1 equals: purchases keys size.
	self assert: 10 equals: (purchases at: bookIsbn).!
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:17:21'!
test17ListDifferentClientPurchasesHasAllPurchases

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.

	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 5.
	interface checkout: cartId charging: creditCard.

	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 1 equals: purchases keys size.
	self assert: 15 equals: (purchases at: bookIsbn).! !

!methodRemoval: TusLibrosInterfaceTest #test17 stamp: 'MR 11/11/2021 15:17:21'!
test17

	| interface catalogue transactionsList purchases cartId bookIsbn creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	interface checkout: cartId charging: creditCard.

	cartId _ interface createCartFor: 'Guido' with: '123456'.
	interface addToCart: cartId item: bookIsbn amount: 5.
	interface checkout: cartId charging: creditCard.

	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: 1 equals: purchases keys size.
	self assert: 15 equals: (purchases at: bookIsbn).!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:18:21' prior: 50916643!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	restApi login: aClientId with: aPassword.
	
	clientsPurchases at: aClientId ifAbsent: [clientsPurchases add: aClientId->OrderedCollection new].
	
	clientPurchases _ clientsPurchases at: aClientId.
	
	result _ Dictionary new.

	clientPurchases do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].
	
	^result.! !
!TusLibrosInterface methodsFor: 'initialization' stamp: 'MR 11/11/2021 15:18:56' prior: 50916484!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	nextCartId _ 0.
	carts _ Dictionary new.
	clientsPurchases _ Dictionary new.
	catalogue _ aCatalogue.
	transactionsList _ aTransactionList.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:19:40' prior: 50916332!
createCartFor: aClientId with: aPassword

	| cart cartInformation |
	restApi login: aClientId with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	carts add: nextCartId -> cartInformation.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:22:18' prior: 50916349!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	total _ cashierToCheckout checkOut.
	
	clientsPurchases at: (cartInformation clientId) ifAbsent: [clientsPurchases add:  (cartInformation clientId) -> PurchasesInterface new].
	(clientsPurchases at: (cartInformation clientId)) addPurchase: cartInformation cart.

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !

Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts restApi transactionsList clientsPurchases'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'MR 11/11/2021 15:22:35'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts restApi transactionsList clientsPurchases'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

Object subclass: #PurchasesInterface
	instanceVariableNames: 'nextCartId catalogue carts restApi transactionsList clientsPurchases'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #PurchasesInterface category: 'TusLibros' stamp: 'MR 11/11/2021 15:22:40'!
Object subclass: #PurchasesInterface
	instanceVariableNames: 'nextCartId catalogue carts restApi transactionsList clientsPurchases'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

Object subclass: #PurchasesInterface
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #PurchasesInterface category: 'TusLibros' stamp: 'MR 11/11/2021 15:22:49'!
Object subclass: #PurchasesInterface
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

Object subclass: #PurchasesInterface
	instanceVariableNames: 'purchasesList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #PurchasesInterface category: 'TusLibros' stamp: 'MR 11/11/2021 15:23:02'!
Object subclass: #PurchasesInterface
	instanceVariableNames: 'purchasesList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!PurchasesInterface methodsFor: 'nil' stamp: 'MR 11/11/2021 15:23:18' overrides: 16896425!
initialize
	purchasesList := OrderedCollection new.! !
!PurchasesInterface methodsFor: 'nil' stamp: 'MR 11/11/2021 15:23:54'!
addPurchase: aCart

	purchasesList addAll: aCart items.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:24:25' prior: 50916885!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	total _ cashierToCheckout checkOut.
	
	clientsPurchases at: (cartInformation clientId) ifAbsent: [clientsPurchases add: (cartInformation clientId) -> PurchasesInterface new].
	(clientsPurchases at: (cartInformation clientId)) addPurchase: cartInformation cart.

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:25:28' prior: 50916839!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	result _ Dictionary new.
	
	restApi login: aClientId with: aPassword.
	
	clientPurchases _ clientsPurchases at: aClientId ifAbsent: [^result].	

	clientPurchases do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].
	
	^result.! !
!PurchasesInterface methodsFor: 'nil' stamp: 'MR 11/11/2021 15:25:41'!
purchasesList

	^purchasesList.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:26:05' prior: 50917008!
listPurchasesFor: aClientId with: aPassword 
	
	| clientPurchases result |
	
	result _ Dictionary new.
	
	restApi login: aClientId with: aPassword.
	
	clientPurchases _ clientsPurchases at: aClientId ifAbsent: [^result].	

	
	
	^result.! !
!PurchasesInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:26:24' prior: 50917026!
purchasesList

	| result |
	result _ Dictionary new.
	purchasesList do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].! !
!PurchasesInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:26:30' prior: 50917042!
purchasesList

	| result |
	result _ Dictionary new.
	
	purchasesList do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].

	^result.! !
!PurchasesInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:26:33' prior: 50917055!
purchasesList

	| result |
	
	result _ Dictionary new.
	
	purchasesList do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].

	^result.! !
!PurchasesInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:26:50'!
listPurchases

	| result |
	
	result _ Dictionary new.
	
	purchasesList do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].

	^result.! !

!methodRemoval: PurchasesInterface #purchasesList stamp: 'MR 11/11/2021 15:26:50'!
purchasesList

	| result |
	
	result _ Dictionary new.
	
	purchasesList do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].

	^result.!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:27:36' prior: 50917031!
listPurchasesFor: aClientId with: aPassword 
	
	| result client |
	
	result _ Dictionary new.
	
	restApi login: aClientId with: aPassword.
	
	client _ clientsPurchases at: aClientId ifAbsent: [^result].	

	^client listPurchases.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 15:27:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 15:27:40'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 15:27:40'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 15:27:45'!
FAILURE!
!PurchasesInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:28:23' prior: 50916973!
addPurchase: aCart

	purchasesList add: aCart items.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 15:28:28'!
PASSED!

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'MR 11/11/2021 15:30:26'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts restApi transactionsList clientsPurchases clients'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'initialization' stamp: 'MR 11/11/2021 15:30:23' prior: 50916860!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	nextCartId _ 0.
	carts _ Dictionary new.
	clients _ Dictionary new.
	catalogue _ aCatalogue.
	transactionsList _ aTransactionList.! !

Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts restApi transactionsList clients'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'MR 11/11/2021 15:30:35'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts restApi transactionsList clients'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:30:59' prior: 50916978!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	total _ cashierToCheckout checkOut.
	
	clients at: (cartInformation clientId) ifAbsent: [clients add: (cartInformation clientId) -> PurchasesInterface new].
	(clients at: (cartInformation clientId)) addPurchase: cartInformation cart.

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:31:06' prior: 50917106!
listPurchasesFor: aClientId with: aPassword 
	
	| result client |
	
	result _ Dictionary new.
	
	restApi login: aClientId with: aPassword.
	
	client _ clients at: aClientId ifAbsent: [^result].	

	^client listPurchases.! !

!classRenamed: #PurchasesInterface as: #ClientInterface stamp: 'MR 11/11/2021 15:31:22'!
Smalltalk renameClassNamed: #PurchasesInterface as: #ClientInterface!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:31:22' prior: 50917288!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	total _ cashierToCheckout checkOut.
	
	clients at: (cartInformation clientId) ifAbsent: [clients add: (cartInformation clientId) -> ClientInterface new].
	(clients at: (cartInformation clientId)) addPurchase: cartInformation cart.

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !

Object subclass: #ClientInterface
	instanceVariableNames: 'purchasesList totalAmount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #ClientInterface category: 'TusLibros' stamp: 'MR 11/11/2021 15:31:40'!
Object subclass: #ClientInterface
	instanceVariableNames: 'purchasesList totalAmount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:32:16' prior: 50917333!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook total transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	total _ cashierToCheckout checkOut.
	
	clients at: (cartInformation clientId) ifAbsent: [clients add: (cartInformation clientId) -> ClientInterface new].
	(clients at: (cartInformation clientId)) addPurchase: cartInformation cart withTotal: total.

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!ClientInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:32:47'!
addPurchase: aCart withTotal: aTotalAmount

	purchasesList add: aCart items.
	totalAmount _ totalAmount + aTotalAmount.! !

!methodRemoval: ClientInterface #addPurchase: stamp: 'MR 11/11/2021 15:32:49'!
addPurchase: aCart

	purchasesList add: aCart items.!
!ClientInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:32:56'!
addPurchase: aCart withAmount: aTotalAmount

	purchasesList add: aCart items.
	totalAmount _ totalAmount + aTotalAmount.! !

!methodRemoval: ClientInterface #addPurchase:withTotal: stamp: 'MR 11/11/2021 15:33:00'!
addPurchase: aCart withTotal: aTotalAmount

	purchasesList add: aCart items.
	totalAmount _ totalAmount + aTotalAmount.!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:33:17' prior: 50917374!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook totalAmount transactionId |
	
	cartInformation _ carts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	totalAmount _ cashierToCheckout checkOut.
	
	clients at: (cartInformation clientId) ifAbsent: [clients add: (cartInformation clientId) -> ClientInterface new].
	(clients at: (cartInformation clientId)) addPurchase: cartInformation cart withAmount: totalAmount.

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	carts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:33:32' prior: 50915435!
test14ListCartOperationUpdatesLastModificationTime

	| interface catalogue transactionsList cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface listCart: cartId.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 0 equals: ((interface listCart: cartId) size).
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:33:34' prior: 50915411!
test13AddToCartOperationUpdatesLastModificationTime

	| interface catalogue transactionsList bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 25).
	
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 10).
	
	self assert: 10 equals: ((interface listCart: cartId) size).
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:33:36' prior: 50915382!
test12CannotCheckOutCartInactiveFor30min

	| interface catalogue transactionsList creditCard bookIsbn cartId |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	currentTime _ currentTime + (Duration minutes: 300).
	
	self 
		should: [interface checkout: cartId charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:33:38' prior: 50915361!
test11CannotCheckOutInvalidCart

	| interface catalogue transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	self 
		should: [interface checkout: 1 charging: creditCard.]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:33:40' prior: 50915333!
test10CheckingOutACartDeletesIt

	| interface catalogue cartId bookIsbn transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	interface checkout: cartId charging: creditCard.
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].
	
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:33:47' prior: 50915297!
test09TransactionsHaveUniqueIds

	| interface catalogue cartId1 bookIsbn transactionId1 transactionsList creditCard cartId2 transactionId2 |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId1 _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId1 item: bookIsbn amount: 10.
	transactionId1 _ interface checkout: cartId1 charging: creditCard.
	
	cartId2 _ interface createCartFor: 'Pepe' with: 'Juancho'.
	interface addToCart: cartId2 item: bookIsbn amount: 5.
	transactionId2 _ interface checkout: cartId2 charging: creditCard.
	
	self assert: transactionId1 equals: transactionsList first.
	self assert: transactionId2 equals: (transactionsList at: 2).
	self deny: transactionId1 = transactionId2.
	self assert: 2 equals: transactionsList size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:33:49' prior: 50915269!
test08CheckingOutAValidCartRegistersTransaction

	| interface catalogue cartId bookIsbn transactionId transactionsList creditCard |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	creditCard _ testObjectsFactory notExpiredCreditCard.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	transactionId _ interface checkout: cartId charging: creditCard.
	
	self assert: transactionId equals: transactionsList first.
	self assert: 1 equals: transactionsList size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:33:52' prior: 50915247!
test07CannotListCartInactiveFor30min

	| interface catalogue cartId transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 300).
	
	self 
		should: [interface listCart: cartId]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:33:54' prior: 50915222!
test06CannotAddToCartInactiveFor30min

	| interface catalogue cartId bookIsbn transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	
	currentTime _ currentTime + (Duration minutes: 32).
	
	self 
		should: [interface addToCart: cartId item: bookIsbn amount: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:33:58' prior: 50915204!
test05CannotListCartUsingAnInvalidCartId

	| interface catalogue transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	self 
		should: [interface listCart: 1]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidCartErrorMessage equals: anError messageText].! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:34:00' prior: 50915181!
test04CartShouldContainAllItemsAddedToIt

	| interface cartId cartContents bookIsbn catalogue transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	bookIsbn _ testObjectsFactory itemSellByTheStore.
	
	cartId _ interface createCartFor: 'Guido' with: 'Juancho'.
	interface addToCart: cartId item: bookIsbn amount: 10.
	
	cartContents _ interface listCart: cartId.
	
	self assert: 10 equals: (cartContents occurrencesOf: bookIsbn).
	self assert: 10 equals: cartContents size.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:34:02' prior: 50915161!
test03CartsHaveUniqueIds

	| interface validUser1 password cart1Id cart2Id validUser2 catalogue transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	validUser1 _ 'Guido'.
	validUser2 _ 'Migue'.
	password _ 'juancho'.
	
	cart1Id _ interface createCartFor: validUser1 with: password.
	cart2Id _ interface createCartFor: validUser2 with: password.
	
	self deny: cart1Id = cart2Id.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:34:05' prior: 50915143!
test02NewlyCreatedCartShouldBeEmpty

	| interface cartContents cartId catalogue transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	cartId _ interface createCartFor: 'Guido' with: '123456'.
	cartContents _ interface listCart: cartId.
	
	self assert: 1 equals: cartId.
	self assert: cartContents isEmpty. ! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 15:34:07' prior: 50915122!
test01CannotCreateCartWithInvalidUsernameOrPassword

	| interface catalogue transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	shouldAuthenticate _ false.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	self 
		should: [interface createCartFor: 'Ryan' with: 'Rugby2021']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !
!ClientInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:37:00'!
listPurchases: aTusLibrosInterface

	| result |
	
	result _ Dictionary new.
	
	purchasesList do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].

	^result.! !
!ClientInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:38:36' prior: 50917791!
listPurchases: aTusLibrosInterface

	| result |
	
	^result.! !

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'MR 11/11/2021 15:40:36'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts restApi transactionsList clients activeCarts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'MR 11/11/2021 15:40:37'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue carts restApi transactionsList clients activeCarts checkedOutCarts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:40:32' prior: 50917428!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout salesBook totalAmount transactionId |
	
	cartInformation _ activeCarts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	salesBook _ OrderedCollection new.
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: salesBook.
	totalAmount _ cashierToCheckout checkOut.
	
	clients at: (cartInformation clientId) ifAbsent: [clients add: (cartInformation clientId) -> ClientInterface new].
	(clients at: (cartInformation clientId)) addPurchase: aCartId withAmount: totalAmount.

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	checkedOutCarts add: aCartId->cartInformation.
	activeCarts removeKey: aCartId.
	
	^transactionId.! !
!ClientInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:40:57' prior: 50917414!
addPurchase: aCartId withAmount: aTotalAmount

	purchasesList add: aCartId.
	totalAmount _ totalAmount + aTotalAmount.! !
!ClientInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:41:10' prior: 50916969 overrides: 16896425!
initialize
	purchasesList := OrderedCollection new.
	totalAmount := 0.! !

!methodRemoval: ClientInterface #listPurchases: stamp: 'MR 11/11/2021 15:41:21'!
listPurchases: aTusLibrosInterface

	| result |
	
	^result.!

Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue restApi transactionsList clients activeCarts checkedOutCarts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'MR 11/11/2021 15:41:36'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue restApi transactionsList clients activeCarts checkedOutCarts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'initialization' stamp: 'MR 11/11/2021 15:41:48' prior: 50917262!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	nextCartId _ 0.
	activeCarts _ Dictionary new.
	checkedOutCarts _ Dictionary new.
	clients _ Dictionary new.
	catalogue _ aCatalogue.
	transactionsList _ aTransactionList.! !
!TusLibrosInterface methodsFor: 'initialization' stamp: 'MR 11/11/2021 15:41:54' prior: 50917896!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	
	nextCartId _ 0.
	activeCarts _ Dictionary new.
	checkedOutCarts _ Dictionary new.
	clients _ Dictionary new.
	
	catalogue _ aCatalogue.
	transactionsList _ aTransactionList.! !
!TusLibrosInterface methodsFor: 'initialization' stamp: 'MR 11/11/2021 15:42:03' prior: 50917908!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	catalogue _ aCatalogue.
	transactionsList _ aTransactionList.
	
	
	activeCarts _ Dictionary new.
	checkedOutCarts _ Dictionary new.
	clients _ Dictionary new.
	
	nextCartId _ 0.
	
	! !
!TusLibrosInterface methodsFor: 'initialization' stamp: 'MR 11/11/2021 15:42:05' prior: 50917920!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	catalogue _ aCatalogue.
	transactionsList _ aTransactionList.
	
	activeCarts _ Dictionary new.
	checkedOutCarts _ Dictionary new.
	clients _ Dictionary new.
	
	nextCartId _ 0.
	
	! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:42:14' prior: 50916190!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	
	self assertActiveCart: aCartId.
	(activeCarts at: aCartId) modifiedAt: (restApi currentTime).
	
	cart _ (activeCarts at: aCartId) cart.
	cart add: anAmount of: anItem.
	! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:42:23' prior: 50916871!
createCartFor: aClientId with: aPassword

	| cart cartInformation |
	restApi login: aClientId with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInformation _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	activeCarts add: nextCartId -> cartInformation.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:42:28' prior: 50916138!
listCart: aCartId 

	| cartInformation |
	
	cartInformation _ activeCarts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	cartInformation modifiedAt: (restApi currentTime).
	
	^cartInformation cart items.! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'MR 11/11/2021 15:42:49' prior: 50916495!
assertActiveCart: aCartId
	
	"(carts at: aCartId) isActive: restApi currentTime."
	
	| timeDifference |
	
	timeDifference _ (restApi currentTime - ((activeCarts at: aCartId) modifiedAt)) totalMinutes.
	timeDifference > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!ClientInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:43:57'!
listPurchases: aTusLibrosInterface

	| result |
	
	result _ Dictionary new.
	
	purchasesList do: [:aCartId | 
		aTusLibrosInterface itemsOfCart: aCartId.
		"aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]"
	].

	^result.! !

!methodRemoval: ClientInterface #listPurchases stamp: 'MR 11/11/2021 15:43:59'!
listPurchases

	| result |
	
	result _ Dictionary new.
	
	purchasesList do: [:aPurchase | 
		aPurchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (aPurchase occurrencesOf: aBookIsbn)).
		]
	].

	^result.!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:44:08' prior: 50917317!
listPurchasesFor: aClientId with: aPassword 
	
	| result client |
	
	result _ Dictionary new.
	
	restApi login: aClientId with: aPassword.
	
	client _ clients at: aClientId ifAbsent: [^result].	

	^client listPurchases: self.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:45:18'!
itemsOfCart: aCartId 

	| cartInformation |
	cartInformation _ checkedOutCarts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	^cartInformation cart items.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 15:45:28'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 15:45:28'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 15:45:28'!
FAILURE!
!ClientInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:45:59' prior: 50917993!
listPurchases: aTusLibrosInterface

	| result |
	
	result _ Dictionary new.
	
	purchasesList do: [:aCartId | | purchase | 
		purchase _ aTusLibrosInterface itemsOfCart: aCartId.
		
		purchase asSet do: [:aBookIsbn | 
			result at: aBookIsbn ifAbsent: [result add: aBookIsbn->0].
			result at: aBookIsbn put: ((result at: aBookIsbn) + (purchase occurrencesOf: aBookIsbn)).
		]
	].

	^result.! !

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 15:46:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 15:46:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 15:46:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 15:46:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 15:46:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 15:46:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 15:46:10'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 15:46:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 15:46:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 15:46:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 15:46:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 15:46:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 15:46:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:46:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 15:46:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 15:46:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 15:46:11'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 15:46:11'!
PASSED!
!CartInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 15:52:41' prior: 50915654!
cart

	^cart! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:56:37' prior: 50918020!
listPurchasesFor: aClientId with: aPassword 
	
	| result client |
	
	restApi login: aClientId with: aPassword.
	
	result _ Dictionary new.
	
	client _ clients at: aClientId ifAbsent: [^result].	

	^client listPurchases: self.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:56:52' prior: 50917944!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	
	self assertActiveCart: aCartId.
	
	(activeCarts at: aCartId) modifiedAt: (restApi currentTime).
	
	cart _ (activeCarts at: aCartId) cart.
	
	cart add: anAmount of: anItem.
	! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:57:09' prior: 50918200!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart |
	
	self assertActiveCart: aCartId.
	
	cart _ (activeCarts at: aCartId) cart.
	
	cart add: anAmount of: anItem.
	
	(activeCarts at: aCartId) modifiedAt: (restApi currentTime).
	! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:58:03' prior: 50918211!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart cartInterface |
	
	self assertActiveCart: aCartId.
	
	cartInterface _ (activeCarts at: aCartId).
	cart _ cartInterface cart.
	
	cart add: anAmount of: anItem.
	
	cartInterface modifiedAt: (restApi currentTime).
	! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:58:17' prior: 50918222!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart cartInterface |
	
	self assertActiveCart: aCartId.
	
	cartInterface _ (activeCarts at: aCartId).
	
	cart _ cartInterface cart.
	
	cart add: anAmount of: anItem.
	cartInterface modifiedAt: (restApi currentTime).
	! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 15:58:21' prior: 50918234!
addToCart: aCartId item: anItem amount: anAmount
	
	| cart cartInterface |
	
	self assertActiveCart: aCartId.
	
	cartInterface _ (activeCarts at: aCartId).
	
	cart _ cartInterface cart.
	
	cart add: anAmount of: anItem.
	
	cartInterface modifiedAt: (restApi currentTime).
	! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 16:01:04'!
test18CannotListClientPurchasesWithInvalidCredentials

	| interface catalogue transactionsList purchases |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	shouldAuthenticate _ false.
	purchases _ interface listPurchasesFor: 'Guido' with: '123456'.
	
	self assert: purchases keys isEmpty.! !
!TusLibrosInterfaceTest methodsFor: 'tests' stamp: 'MR 11/11/2021 16:01:25' prior: 50918258!
test18CannotListClientPurchasesWithInvalidCredentials

	| interface catalogue transactionsList |
	
	catalogue _ testObjectsFactory defaultCatalog.
	transactionsList _ OrderedCollection new.
	interface _ TusLibrosInterface through: self withCatalogue: catalogue registeringOn: transactionsList.
	
	shouldAuthenticate _ false.
	
	self 
		should: [interface listPurchasesFor: 'Guido' with: '123456']
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:anError | self assert: TusLibrosInterface invalidLoginErrorMessage equals: anError messageText].! !

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:01:29'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:01:29'!
PASSED!
!TusLibrosInterface methodsFor: 'assertions' stamp: 'MR 11/11/2021 16:03:33' prior: 50917981!
assertActiveCart: aCartId
	
	| cart |
	cart _ (activeCarts at: aCartId).
	
	cart isActiveAt: restApi currentTime.! !
!CartInterface methodsFor: 'initialization' stamp: 'MR 11/11/2021 16:04:43'!
isActiveAt: aCurrentDate

	| timeDifference |
	
	timeDifference _ (aCurrentDate - modifiedAt) totalMinutes.
	
	timeDifference > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:04:50'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:04:50'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:04:50'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:04:50'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:04:50'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:04:51'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:04:51'!
PASSED!
!CartInterface methodsFor: 'initialization' stamp: 'MR 11/11/2021 16:05:14' prior: 50918374!
isActiveAt: aDate

	| timeDifference |
	
	timeDifference _ (aDate - modifiedAt) totalMinutes.
	
	timeDifference > 30 ifTrue: [^self error: TusLibrosInterface invalidCartErrorMessage].! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'MR 11/11/2021 16:05:41' prior: 50918367!
assertActiveCart: aCartId
	
	| cart |
	cart _ (activeCarts at: aCartId).
	cart isActiveAt: restApi currentTime.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:06:17' prior: 50918246!
addToCart: aCartId item: anItem amount: anAmount
	
	| cartInterface |
	
	self assertActiveCart: aCartId.
	
	cartInterface _ (activeCarts at: aCartId).
	
	cartInterface cart add: anAmount of: anItem.
	
	cartInterface modifiedAt: (restApi currentTime).
	! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:06:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:06:19'!
PASSED!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:06:37' prior: 50918467!
addToCart: aCartId item: anItem amount: anAmount
	
	| cartInterface |
	
	self assertActiveCart: aCartId.
	
	cartInterface _ (activeCarts at: aCartId).
	
	cartInterface add: anAmount of: anItem.
	
	cartInterface modifiedAt: (restApi currentTime).
	! !
!CartInterface methodsFor: 'nil' stamp: 'MR 11/11/2021 16:06:55'!
add: anAmount of: anItem

	cart add: anAmount of: anItem.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:08:45' prior: 50917955!
createCartFor: aClientId with: aPassword

	| cart cartInterface |
	restApi login: aClientId with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInterface _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	activeCarts add: nextCartId -> cartInterface.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:08:49' prior: 50918560!
createCartFor: aClientId with: aPassword

	| cart cartInterface |
	
	restApi login: aClientId with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	nextCartId _ nextCartId + 1.
	
	cartInterface _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	activeCarts add: nextCartId -> cartInterface.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:09:31' prior: 50917830!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashierToCheckout totalAmount transactionId |
	
	cartInformation _ activeCarts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	cashierToCheckout _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: OrderedCollection new.
	totalAmount _ cashierToCheckout checkOut.
	
	clients at: (cartInformation clientId) ifAbsent: [clients add: (cartInformation clientId) -> ClientInterface new].
	(clients at: (cartInformation clientId)) addPurchase: aCartId withAmount: totalAmount.

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	checkedOutCarts add: aCartId->cartInformation.
	activeCarts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:10:38' prior: 50918588!
checkout: aCartId charging: aCreditCard 
	
	| cartInformation cashier totalAmount transactionId |
	
	cartInformation _ activeCarts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	cashier _ Cashier toCheckout: (cartInformation cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: OrderedCollection new.
	totalAmount _ cashier checkOut.
	
	clients at: (cartInformation clientId) ifAbsent: [clients add: (cartInformation clientId) -> ClientInterface new].
	(clients at: (cartInformation clientId)) addPurchase: aCartId withAmount: totalAmount.

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	checkedOutCarts add: aCartId->cartInformation.
	activeCarts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:10:54' prior: 50918618!
checkout: aCartId charging: aCreditCard 
	
	| cartInterface cashier totalAmount transactionId |
	
	cartInterface _ activeCarts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	self assertActiveCart: aCartId.
	
	cashier _ Cashier toCheckout: (cartInterface cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: OrderedCollection new.
	totalAmount _ cashier checkOut.
	
	clients at: (cartInterface clientId) ifAbsent: [clients add: (cartInterface clientId) -> ClientInterface new].
	(clients at: (cartInterface clientId)) addPurchase: aCartId withAmount: totalAmount.

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	checkedOutCarts add: aCartId->cartInterface.
	activeCarts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:12:05' prior: 50918647!
checkout: aCartId charging: aCreditCard 
	
	| cartInterface cashier totalAmount transactionId |
	
	self assertActiveCart: aCartId.
	
	cartInterface _ activeCarts at: aCartId.
	cashier _ Cashier toCheckout: (cartInterface cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: OrderedCollection new.
	totalAmount _ cashier checkOut.
	
	clients at: (cartInterface clientId) ifAbsent: [clients add: (cartInterface clientId) -> ClientInterface new].
	(clients at: (cartInterface clientId)) addPurchase: aCartId withAmount: totalAmount.

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	checkedOutCarts add: aCartId->cartInterface.
	activeCarts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'MR 11/11/2021 16:12:27' prior: 50918460!
assertActiveCart: aCartId
	
	| cart |
	cart _ activeCarts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	cart isActiveAt: restApi currentTime.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:13:55' prior: 50918676!
checkout: aCartId charging: aCreditCard 
	
	| cartInterface cashier totalAmount transactionId client |
	
	self assertActiveCart: aCartId.
	
	cartInterface _ activeCarts at: aCartId.
	cashier _ Cashier toCheckout: (cartInterface cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: OrderedCollection new.
	totalAmount _ cashier checkOut.
	
	client _ clients at: cartInterface clientId.
	client addPurchase: aCartId withAmount: totalAmount.

	transactionId _ (transactionsList size + 1).
	transactionsList add: transactionId.
	
	checkedOutCarts add: aCartId->cartInterface.
	activeCarts removeKey: aCartId.
	
	^transactionId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:15:51' prior: 50918574!
createCartFor: aClientId with: aPassword

	| cart cartInterface |
	
	restApi login: aClientId with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	cartInterface _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	activeCarts add: nextCartId -> cartInterface.
	
	clients at: aClientId ifAbsent: [clients add: aClientId -> ClientInterface new].	
	
	nextCartId _ nextCartId + 1.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:17:48' prior: 50918736!
createCartFor: aClientId with: aPassword

	| cart cartInterface |
	
	restApi login: aClientId with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	cartInterface _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	activeCarts add: nextCartId -> cartInterface.
	
	nextCartId _ nextCartId + 1.
	
	^nextCartId.! !

TestCase subclass: #TusLibrosInterfaceTest
	instanceVariableNames: 'testObjectsFactory shouldAuthenticate currentTime debitBehaviour clients'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosInterfaceTest category: 'TusLibros' stamp: 'MR 11/11/2021 16:18:32'!
TestCase subclass: #TusLibrosInterfaceTest
	instanceVariableNames: 'testObjectsFactory shouldAuthenticate currentTime debitBehaviour clients'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterfaceTest methodsFor: 'setup' stamp: 'MR 11/11/2021 16:18:47' prior: 50915114 overrides: 16927572!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	shouldAuthenticate _ true.
	currentTime _ DateAndTime today.
	debitBehaviour _ [:anAmount :aCreditCard |].
	
	clients _ OrderedCollection with: 'Ryan' with: 'Guido'.! !
!TusLibrosInterface methodsFor: 'initialization' stamp: 'MR 11/11/2021 16:19:18' prior: 50917932!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	catalogue _ aCatalogue.
	transactionsList _ aTransactionList.
	
	activeCarts _ Dictionary new.
	checkedOutCarts _ Dictionary new.
	clients _ Dictionary new.
	
	nextCartId _ 0.
	
	aRestApi clients do: [:aClientId |
		clients add: aClientId -> ClientInterface new
	].
	
	! !
!TusLibrosInterfaceTest methodsFor: 'nil' stamp: 'MR 11/11/2021 16:19:27'!
clients
	^clients.! !
!TusLibrosInterface methodsFor: 'initialization' stamp: 'MR 11/11/2021 16:19:44' prior: 50918795!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	catalogue _ aCatalogue.
	transactionsList _ aTransactionList.
	
	activeCarts _ Dictionary new.
	checkedOutCarts _ Dictionary new.
	clients _ Dictionary new.
	
	nextCartId _ 0.
	
	aRestApi clients do: [:aClientId | clients add: aClientId -> ClientInterface new].
	
	! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:19:46'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:19:46'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:19:46'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:19:46'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:19:46'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:19:46'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:19:46'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:19:46'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:19:46'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:19:46'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:19:46'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:19:46'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:19:46'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:19:46'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:19:46'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:19:47'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:19:47'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:19:47'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:19:57'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:20:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:20:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:20:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:20:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:20:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:20:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:20:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:20:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:20:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:20:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:20:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:20:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:20:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:20:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:20:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:20:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:20:19'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:20:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:20:21'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:21:21'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:21:21'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:21:21'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:21:21'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:21:21'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:21:21'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:21:21'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:21:21'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:21:21'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:21:21'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:21:21'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:21:21'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:21:21'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:21:21'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:21:21'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:21:21'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:21:21'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:21:21'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:21:29'!
ERROR!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:22:06' prior: 50918753!
createCartFor: aClientId with: aPassword

	| cart cartInterface |
	
	restApi login: aClientId with: aPassword.
	
	nextCartId _ nextCartId + 1.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	cartInterface _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	activeCarts add: nextCartId -> cartInterface.
	
	^nextCartId.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:22:14' prior: 50919039!
createCartFor: aClientId with: aPassword

	| cart cartInterface |
	
	restApi login: aClientId with: aPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	
	cartInterface _ CartInterface cart: cart modifiedAt: restApi currentTime for: aClientId.
	
	nextCartId _ nextCartId + 1.
	
	activeCarts add: nextCartId -> cartInterface.
	
	^nextCartId.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:22:16'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:22:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:22:16'!
ERROR!

interface!
!TusLibrosInterfaceTest methodsFor: 'setup' stamp: 'MR 11/11/2021 16:22:56' prior: 50918784 overrides: 16927572!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	shouldAuthenticate _ true.
	currentTime _ DateAndTime today.
	debitBehaviour _ [:anAmount :aCreditCard |].
	
	clients _ OrderedCollection with: 'Ryan' with: 'Guido' with: 'Pepe'.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:22:56'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:22:56'!
PASSED!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:23:20' prior: 50917969!
listCart: aCartId 

	| cartInformation |

	self assertActiveCart: aCartId.
	
	cartInformation _ activeCarts at: aCartId.
	
	cartInformation modifiedAt: (restApi currentTime).
	
	^cartInformation cart items.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:23:24'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:23:24'!
PASSED!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:23:31' prior: 50918030!
itemsOfCart: aCartId 

	| cartInformation |
	
	cartInformation _ checkedOutCarts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	
	^cartInformation cart items.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:23:50' prior: 50919294!
itemsOfCart: aCartId 

	| cartInformation |
	
	cartInformation _ checkedOutCarts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	
	^cartInformation items.! !
!CartInterface methodsFor: 'nil' stamp: 'MR 11/11/2021 16:23:57'!
items
	^cart items.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:24:02'!
PASSED!

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'MR 11/11/2021 16:27:57'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'nextCartId catalogue restApi transactionsIds clients activeCarts checkedOutCarts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 16:27:57' prior: 50918813!
through: aRestApi withCatalogue: aCatalogue registeringOn: aTransactionList 

	restApi _ aRestApi.
	catalogue _ aCatalogue.
	transactionsIds _ aTransactionList.
	
	activeCarts _ Dictionary new.
	checkedOutCarts _ Dictionary new.
	clients _ Dictionary new.
	
	nextCartId _ 0.
	
	aRestApi clients do: [:aClientId | clients add: aClientId -> ClientInterface new].
	
	! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'MR 11/11/2021 16:27:57' prior: 50918712!
checkout: aCartId charging: aCreditCard 
	
	| cartInterface cashier totalAmount transactionId client |
	
	self assertActiveCart: aCartId.
	
	cartInterface _ activeCarts at: aCartId.
	cashier _ Cashier toCheckout: (cartInterface cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: OrderedCollection new.
	totalAmount _ cashier checkOut.
	
	client _ clients at: cartInterface clientId.
	client addPurchase: aCartId withAmount: totalAmount.

	transactionId _ (transactionsIds size + 1).
	transactionsIds add: transactionId.
	
	checkedOutCarts add: aCartId->cartInterface.
	activeCarts removeKey: aCartId.
	
	^transactionId.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:28:03'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:28:03'!
PASSED!
!TusLibrosInterface methodsFor: 'assertions' stamp: 'MR 11/11/2021 16:28:49' prior: 50918703!
assertActiveCart: aCartId
	
	| cart |
	
	cart _ activeCarts at: aCartId ifAbsent: [^self error: TusLibrosInterface invalidCartErrorMessage].
	
	cart isActiveAt: restApi currentTime.! !
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:30:39' prior: 50919409!
checkout: aCartId charging: aCreditCard 
	
	| cartInterface cashier totalAmount client |
	
	self assertActiveCart: aCartId.
	
	cartInterface _ activeCarts at: aCartId.
	cashier _ Cashier toCheckout: (cartInterface cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: OrderedCollection new.
	totalAmount _ cashier checkOut.
	
	client _ clients at: cartInterface clientId.
	client addPurchase: aCartId withAmount: totalAmount.
	
	self moveCartToCheckoutList: aCartId withInterface: cartInterface.
	
	^self addTransaction.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:30:52'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:30:52'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:30:52'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:30:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:30:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:30:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:30:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:30:53'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:30:53'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:30:53'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:30:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:30:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:30:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:30:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:30:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:30:53'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:30:53'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:30:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:30:54'!
ERROR!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'MR 11/11/2021 16:31:00'!
moveCartToCheckoutList: aSmallInteger withInterface: aCartInterface 
	self shouldBeImplemented.! !

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:31:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:31:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:31:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:31:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:31:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:31:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:31:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:31:54'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:31:54'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:31:54'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:31:54'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:31:54'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:31:54'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:31:54'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:31:54'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:31:54'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:31:54'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:31:54'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:31:56'!
ERROR!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'MR 11/11/2021 16:32:13' prior: 50919600!
moveCartToCheckoutList: aCartId withInterface: aCartInterface 
	checkedOutCarts add: aCartId -> aCartInterface.
	activeCarts removeKey: aCartId.! !

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:32:15'!
ERROR!
!TusLibrosInterface methodsFor: 'category-name' stamp: 'MR 11/11/2021 16:32:19'!
addTransaction
	self shouldBeImplemented.! !
!TusLibrosInterface methodsFor: 'category-name' stamp: 'MR 11/11/2021 16:32:25' prior: 50919689!
addTransaction

	| transactionId |
	transactionId _ transactionsIds size + 1.
	transactionsIds add: transactionId.! !
!TusLibrosInterface methodsFor: 'category-name' stamp: 'MR 11/11/2021 16:32:35' prior: 50919694!
addTransaction
	| transactionId |
	
	transactionId _ transactionsIds size + 1.
	
	transactionsIds add: transactionId.
	
	^transactionId.! !

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:32:36'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01CannotCreateCartWithInvalidUsernameOrPassword stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02NewlyCreatedCartShouldBeEmpty stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03CartsHaveUniqueIds stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04CartShouldContainAllItemsAddedToIt stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05CannotListCartUsingAnInvalidCartId stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06CannotAddToCartInactiveFor30min stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07CannotListCartInactiveFor30min stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckingOutAValidCartRegistersTransaction stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09TransactionsHaveUniqueIds stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10CheckingOutACartDeletesIt stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11CannotCheckOutInvalidCart stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12CannotCheckOutCartInactiveFor30min stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13AddToCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListCartOperationUpdatesLastModificationTime stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15ListClientPurchasesWithoutCheckoutsIsEmpty stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16ListClientPurchasesHasCorrectPurchases stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ListDifferentClientPurchasesHasAllPurchases stamp: 'MR 11/11/2021 16:32:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18CannotListClientPurchasesWithInvalidCredentials stamp: 'MR 11/11/2021 16:32:38'!
PASSED!
!TusLibrosInterface methodsFor: 'operations' stamp: 'MR 11/11/2021 16:32:41' prior: 50919509!
checkout: aCartId charging: aCreditCard 
	
	| cartInterface cashier totalAmount client |
	
	self assertActiveCart: aCartId.
	
	cartInterface _ activeCarts at: aCartId.
	cashier _ Cashier toCheckout: (cartInterface cart) charging: aCreditCard throught: restApi on: restApi today registeringOn: OrderedCollection new.
	totalAmount _ cashier checkOut.
	
	client _ clients at: cartInterface clientId.
	client addPurchase: aCartId withAmount: totalAmount.
	
	self moveCartToCheckoutList: aCartId withInterface: cartInterface.
	
	^self addTransaction.! !

----SNAPSHOT----(11 November 2021 16:33:53) CuisUniversity-4913.image priorSource: 18661997!